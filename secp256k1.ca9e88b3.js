var e,t,r,o,n,i;"function"==typeof(e=globalThis.define)&&(t=e,e=null),r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},n={},null==(i=r.parcelRequiref356)&&((i=function(e){if(e in o)return o[e].exports;if(e in n){var t=n[e];delete n[e];var r={id:e,exports:{}};return o[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){n[e]=t},r.parcelRequiref356=i),i.register("bHZR1",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.encodeToCurve=e.exports.hashToCurve=e.exports.secp256k1_hasher=e.exports.schnorr=e.exports.secp256k1=void 0;var r=i("gDMZD"),o=i("bHkZ3"),n=i("3WQ7x"),s=i("5GEtw"),a=i("4ULxn"),l=i("1qYng"),f=i("joUi2");let u={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},d=BigInt(0),c=BigInt(1),h=BigInt(2),p=(e,t)=>(e+t/h)/t;function b(e){let t=u.p,r=BigInt(3),o=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),l=BigInt(44),f=BigInt(88),d=e*e*e%t,c=d*d*e%t,p=(0,a.pow2)(c,r,t)*c%t,b=(0,a.pow2)(p,r,t)*c%t,y=(0,a.pow2)(b,h,t)*d%t,g=(0,a.pow2)(y,n,t)*y%t,m=(0,a.pow2)(g,i,t)*g%t,w=(0,a.pow2)(m,l,t)*m%t,E=(0,a.pow2)(w,f,t)*w%t,B=(0,a.pow2)(E,l,t)*m%t,v=(0,a.pow2)(B,r,t)*c%t,H=(0,a.pow2)(v,s,t)*g%t,S=(0,a.pow2)(H,o,t)*d%t,A=(0,a.pow2)(S,h,t);if(!x.eql(x.sqr(A),e))throw Error("Cannot find square root");return A}let x=(0,a.Field)(u.p,void 0,void 0,{sqrt:b});e.exports.secp256k1=(0,n.createCurve)({...u,Fp:x,lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=u.n,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),o=-c*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=BigInt("0x100000000000000000000000000000000"),s=p(r*e,t),l=p(-o*e,t),f=(0,a.mod)(e-s*r-l*n,t),d=(0,a.mod)(-s*o-l*r,t),h=f>i,b=d>i;if(h&&(f=t-f),b&&(d=t-d),f>i||d>i)throw Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:f,k2neg:b,k2:d}}}},r.sha256);let y={};function g(e,...t){let o=y[e];if(void 0===o){let t=(0,r.sha256)(Uint8Array.from(e,e=>e.charCodeAt(0)));o=(0,f.concatBytes)(t,t),y[e]=o}return(0,r.sha256)((0,f.concatBytes)(o,...t))}let m=e=>e.toBytes(!0).slice(1),w=e=>(0,f.numberToBytesBE)(e,32),E=e=>(0,a.mod)(e,u.p),B=e=>(0,a.mod)(e,u.n),v=e.exports.secp256k1.Point,H=e=>e%h===d;function S(t){let r=e.exports.secp256k1.utils.normPrivateKeyToScalar(t),o=v.fromPrivateKey(r),n=H(o.y)?r:B(-r);return{scalar:n,bytes:m(o)}}function A(e){(0,f.aInRange)("x",e,c,u.p);let t=E(e*e),r=E(t*e+BigInt(7)),o=b(r);H(o)||(o=E(-o));let n=v.fromAffine({x:e,y:o});return n.assertValidity(),n}let I=f.bytesToNumberBE;function O(...e){return B(I(g("BIP0340/challenge",...e)))}function _(e,t,r){let o=(0,f.ensureBytes)("signature",e,64),n=(0,f.ensureBytes)("message",t),i=(0,f.ensureBytes)("publicKey",r,32);try{let e=A(I(i)),t=I(o.subarray(0,32));if(!(0,f.inRange)(t,c,u.p))return!1;let r=I(o.subarray(32,64));if(!(0,f.inRange)(r,c,u.n))return!1;let s=O(w(t),m(e),n),a=v.BASE.multiplyUnsafe(r).add(e.multiplyUnsafe(B(-s))),{x:l,y:d}=a.toAffine();if(a.is0()||!H(d)||l!==t)return!1;return!0}catch(e){return!1}}e.exports.schnorr={getPublicKey:function(e){return S(e).bytes},sign:function(e,t,r=(0,o.randomBytes)(32)){let n=(0,f.ensureBytes)("message",e),{bytes:i,scalar:s}=S(t),a=(0,f.ensureBytes)("auxRand",r,32),l=w(s^I(g("BIP0340/aux",a))),u=g("BIP0340/nonce",l,i,n),c=B(I(u));if(c===d)throw Error("sign failed: k is zero");let{bytes:h,scalar:p}=S(c),b=O(h,i,n),x=new Uint8Array(64);if(x.set(h,0),x.set(w(B(p+b*s)),32),!_(x,n,i))throw Error("sign: Invalid signature produced");return x},verify:_,utils:{randomPrivateKey:e.exports.secp256k1.utils.randomPrivateKey,lift_x:A,pointToBytes:m,numberToBytesBE:f.numberToBytesBE,bytesToNumberBE:f.bytesToNumberBE,taggedHash:g,mod:a.mod}};let L=(0,s.isogenyMap)(x,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(e=>BigInt(e)))),T=(0,l.mapToCurveSimpleSWU)(x,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:x.create(BigInt("-11"))});e.exports.secp256k1_hasher=(0,s.createHasher)(e.exports.secp256k1.Point,e=>{let{x:t,y:r}=T(x.create(e[0]));return L(t,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:x.ORDER,m:1,k:128,expand:"xmd",hash:r.sha256}),e.exports.hashToCurve=e.exports.secp256k1_hasher.hashToCurve,e.exports.encodeToCurve=e.exports.secp256k1_hasher.encodeToCurve}),i.register("gDMZD",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.sha512_224=e.exports.sha512_256=e.exports.sha384=e.exports.sha512=e.exports.sha224=e.exports.sha256=e.exports.SHA512_256=e.exports.SHA512_224=e.exports.SHA384=e.exports.SHA512=e.exports.SHA224=e.exports.SHA256=void 0;var r=i("cp3fd"),o=i("i02N0"),n=i("bHkZ3");let s=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=new Uint32Array(64);class l extends r.HashMD{constructor(e=32){super(64,e,8,!1),this.A=0|r.SHA256_IV[0],this.B=0|r.SHA256_IV[1],this.C=0|r.SHA256_IV[2],this.D=0|r.SHA256_IV[3],this.E=0|r.SHA256_IV[4],this.F=0|r.SHA256_IV[5],this.G=0|r.SHA256_IV[6],this.H=0|r.SHA256_IV[7]}get(){let{A:e,B:t,C:r,D:o,E:n,F:i,G:s,H:a}=this;return[e,t,r,o,n,i,s,a]}set(e,t,r,o,n,i,s,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|o,this.E=0|n,this.F=0|i,this.G=0|s,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)a[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=a[e-15],r=a[e-2],o=(0,n.rotr)(t,7)^(0,n.rotr)(t,18)^t>>>3,i=(0,n.rotr)(r,17)^(0,n.rotr)(r,19)^r>>>10;a[e]=i+a[e-7]+o+a[e-16]|0}let{A:o,B:i,C:l,D:f,E:u,F:d,G:c,H:h}=this;for(let e=0;e<64;e++){let t=(0,n.rotr)(u,6)^(0,n.rotr)(u,11)^(0,n.rotr)(u,25),p=h+t+(0,r.Chi)(u,d,c)+s[e]+a[e]|0,b=(0,n.rotr)(o,2)^(0,n.rotr)(o,13)^(0,n.rotr)(o,22),x=b+(0,r.Maj)(o,i,l)|0;h=c,c=d,d=u,u=f+p|0,f=l,l=i,i=o,o=p+x|0}o=o+this.A|0,i=i+this.B|0,l=l+this.C|0,f=f+this.D|0,u=u+this.E|0,d=d+this.F|0,c=c+this.G|0,h=h+this.H|0,this.set(o,i,l,f,u,d,c,h)}roundClean(){(0,n.clean)(a)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,n.clean)(this.buffer)}}e.exports.SHA256=l;class f extends l{constructor(){super(28),this.A=0|r.SHA224_IV[0],this.B=0|r.SHA224_IV[1],this.C=0|r.SHA224_IV[2],this.D=0|r.SHA224_IV[3],this.E=0|r.SHA224_IV[4],this.F=0|r.SHA224_IV[5],this.G=0|r.SHA224_IV[6],this.H=0|r.SHA224_IV[7]}}e.exports.SHA224=f;let u=o.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),d=u[0],c=u[1],h=new Uint32Array(80),p=new Uint32Array(80);class b extends r.HashMD{constructor(e=64){super(128,e,16,!1),this.Ah=0|r.SHA512_IV[0],this.Al=0|r.SHA512_IV[1],this.Bh=0|r.SHA512_IV[2],this.Bl=0|r.SHA512_IV[3],this.Ch=0|r.SHA512_IV[4],this.Cl=0|r.SHA512_IV[5],this.Dh=0|r.SHA512_IV[6],this.Dl=0|r.SHA512_IV[7],this.Eh=0|r.SHA512_IV[8],this.El=0|r.SHA512_IV[9],this.Fh=0|r.SHA512_IV[10],this.Fl=0|r.SHA512_IV[11],this.Gh=0|r.SHA512_IV[12],this.Gl=0|r.SHA512_IV[13],this.Hh=0|r.SHA512_IV[14],this.Hl=0|r.SHA512_IV[15]}get(){let{Ah:e,Al:t,Bh:r,Bl:o,Ch:n,Cl:i,Dh:s,Dl:a,Eh:l,El:f,Fh:u,Fl:d,Gh:c,Gl:h,Hh:p,Hl:b}=this;return[e,t,r,o,n,i,s,a,l,f,u,d,c,h,p,b]}set(e,t,r,o,n,i,s,a,l,f,u,d,c,h,p,b){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|o,this.Ch=0|n,this.Cl=0|i,this.Dh=0|s,this.Dl=0|a,this.Eh=0|l,this.El=0|f,this.Fh=0|u,this.Fl=0|d,this.Gh=0|c,this.Gl=0|h,this.Hh=0|p,this.Hl=0|b}process(e,t){for(let r=0;r<16;r++,t+=4)h[r]=e.getUint32(t),p[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){let t=0|h[e-15],r=0|p[e-15],n=o.rotrSH(t,r,1)^o.rotrSH(t,r,8)^o.shrSH(t,r,7),i=o.rotrSL(t,r,1)^o.rotrSL(t,r,8)^o.shrSL(t,r,7),s=0|h[e-2],a=0|p[e-2],l=o.rotrSH(s,a,19)^o.rotrBH(s,a,61)^o.shrSH(s,a,6),f=o.rotrSL(s,a,19)^o.rotrBL(s,a,61)^o.shrSL(s,a,6),u=o.add4L(i,f,p[e-7],p[e-16]),d=o.add4H(u,n,l,h[e-7],h[e-16]);h[e]=0|d,p[e]=0|u}let{Ah:r,Al:n,Bh:i,Bl:s,Ch:a,Cl:l,Dh:f,Dl:u,Eh:b,El:x,Fh:y,Fl:g,Gh:m,Gl:w,Hh:E,Hl:B}=this;for(let e=0;e<80;e++){let t=o.rotrSH(b,x,14)^o.rotrSH(b,x,18)^o.rotrBH(b,x,41),v=o.rotrSL(b,x,14)^o.rotrSL(b,x,18)^o.rotrBL(b,x,41),H=b&y^~b&m,S=x&g^~x&w,A=o.add5L(B,v,S,c[e],p[e]),I=o.add5H(A,E,t,H,d[e],h[e]),O=0|A,_=o.rotrSH(r,n,28)^o.rotrBH(r,n,34)^o.rotrBH(r,n,39),L=o.rotrSL(r,n,28)^o.rotrBL(r,n,34)^o.rotrBL(r,n,39),T=r&i^r&a^i&a,R=n&s^n&l^s&l;E=0|m,B=0|w,m=0|y,w=0|g,y=0|b,g=0|x,({h:b,l:x}=o.add(0|f,0|u,0|I,0|O)),f=0|a,u=0|l,a=0|i,l=0|s,i=0|r,s=0|n;let U=o.add3L(O,L,R);r=o.add3H(U,I,_,T),n=0|U}({h:r,l:n}=o.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:s}=o.add(0|this.Bh,0|this.Bl,0|i,0|s)),({h:a,l:l}=o.add(0|this.Ch,0|this.Cl,0|a,0|l)),({h:f,l:u}=o.add(0|this.Dh,0|this.Dl,0|f,0|u)),({h:b,l:x}=o.add(0|this.Eh,0|this.El,0|b,0|x)),({h:y,l:g}=o.add(0|this.Fh,0|this.Fl,0|y,0|g)),({h:m,l:w}=o.add(0|this.Gh,0|this.Gl,0|m,0|w)),({h:E,l:B}=o.add(0|this.Hh,0|this.Hl,0|E,0|B)),this.set(r,n,i,s,a,l,f,u,b,x,y,g,m,w,E,B)}roundClean(){(0,n.clean)(h,p)}destroy(){(0,n.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}e.exports.SHA512=b;class x extends b{constructor(){super(48),this.Ah=0|r.SHA384_IV[0],this.Al=0|r.SHA384_IV[1],this.Bh=0|r.SHA384_IV[2],this.Bl=0|r.SHA384_IV[3],this.Ch=0|r.SHA384_IV[4],this.Cl=0|r.SHA384_IV[5],this.Dh=0|r.SHA384_IV[6],this.Dl=0|r.SHA384_IV[7],this.Eh=0|r.SHA384_IV[8],this.El=0|r.SHA384_IV[9],this.Fh=0|r.SHA384_IV[10],this.Fl=0|r.SHA384_IV[11],this.Gh=0|r.SHA384_IV[12],this.Gl=0|r.SHA384_IV[13],this.Hh=0|r.SHA384_IV[14],this.Hl=0|r.SHA384_IV[15]}}e.exports.SHA384=x;let y=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),g=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class m extends b{constructor(){super(28),this.Ah=0|y[0],this.Al=0|y[1],this.Bh=0|y[2],this.Bl=0|y[3],this.Ch=0|y[4],this.Cl=0|y[5],this.Dh=0|y[6],this.Dl=0|y[7],this.Eh=0|y[8],this.El=0|y[9],this.Fh=0|y[10],this.Fl=0|y[11],this.Gh=0|y[12],this.Gl=0|y[13],this.Hh=0|y[14],this.Hl=0|y[15]}}e.exports.SHA512_224=m;class w extends b{constructor(){super(32),this.Ah=0|g[0],this.Al=0|g[1],this.Bh=0|g[2],this.Bl=0|g[3],this.Ch=0|g[4],this.Cl=0|g[5],this.Dh=0|g[6],this.Dl=0|g[7],this.Eh=0|g[8],this.El=0|g[9],this.Fh=0|g[10],this.Fl=0|g[11],this.Gh=0|g[12],this.Gl=0|g[13],this.Hh=0|g[14],this.Hl=0|g[15]}}e.exports.SHA512_256=w,e.exports.sha256=(0,n.createHasher)(()=>new l),e.exports.sha224=(0,n.createHasher)(()=>new f),e.exports.sha512=(0,n.createHasher)(()=>new b),e.exports.sha384=(0,n.createHasher)(()=>new x),e.exports.sha512_256=(0,n.createHasher)(()=>new w),e.exports.sha512_224=(0,n.createHasher)(()=>new m)}),i.register("cp3fd",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SHA512_IV=e.exports.SHA384_IV=e.exports.SHA224_IV=e.exports.SHA256_IV=e.exports.HashMD=void 0,e.exports.setBigUint64=o,e.exports.Chi=function(e,t,r){return e&t^~e&r},e.exports.Maj=function(e,t,r){return e&t^e&r^t&r};var r=i("bHkZ3");function o(e,t,r,o){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,o);let n=BigInt(32),i=BigInt(4294967295),s=Number(r>>n&i),a=Number(r&i),l=o?4:0,f=o?0:4;e.setUint32(t+l,s,o),e.setUint32(t+f,a,o)}class n extends r.Hash{constructor(e,t,o,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=o,this.isLE=n,this.buffer=new Uint8Array(e),this.view=(0,r.createView)(this.buffer)}update(e){(0,r.aexists)(this),e=(0,r.toBytes)(e),(0,r.abytes)(e);let{view:t,buffer:o,blockLen:n}=this,i=e.length;for(let s=0;s<i;){let a=Math.min(n-this.pos,i-s);if(a===n){let t=(0,r.createView)(e);for(;n<=i-s;s+=n)this.process(t,s);continue}o.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,r.aexists)(this),(0,r.aoutput)(e,this),this.finished=!0;let{buffer:t,view:n,blockLen:i,isLE:s}=this,{pos:a}=this;t[a++]=128,(0,r.clean)(this.buffer.subarray(a)),this.padOffset>i-a&&(this.process(n,0),a=0);for(let e=a;e<i;e++)t[e]=0;o(n,i-8,BigInt(8*this.length),s),this.process(n,0);let l=(0,r.createView)(e),f=this.outputLen;if(f%4)throw Error("_sha2: outputLen should be aligned to 32bit");let u=f/4,d=this.get();if(u>d.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<u;e++)l.setUint32(4*e,d[e],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:o,finished:n,destroyed:i,pos:s}=this;return e.destroyed=i,e.finished=n,e.length=o,e.pos=s,o%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}e.exports.HashMD=n,e.exports.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),e.exports.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),e.exports.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),e.exports.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])}),i.register("bHkZ3",function(e,t){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.wrapXOFConstructorWithOpts=e.exports.wrapConstructorWithOpts=e.exports.wrapConstructor=e.exports.Hash=e.exports.nextTick=e.exports.swap32IfBE=e.exports.byteSwapIfBE=e.exports.swap8IfBE=e.exports.isLE=void 0,e.exports.isBytes=o,e.exports.anumber=n,e.exports.abytes=s,e.exports.ahash=function(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.createHasher");n(e.outputLen),n(e.blockLen)},e.exports.aexists=function(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")},e.exports.aoutput=function(e,t){s(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)},e.exports.u8=function(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},e.exports.u32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))},e.exports.clean=function(...e){for(let t=0;t<e.length;t++)e[t].fill(0)},e.exports.createView=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)},e.exports.rotr=function(e,t){return e<<32-t|e>>>t},e.exports.rotl=function(e,t){return e<<t|e>>>32-t>>>0},e.exports.byteSwap=a,e.exports.byteSwap32=l,e.exports.bytesToHex=function(e){if(s(e),f)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=u[e[r]];return t},e.exports.hexToBytes=function(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(f)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let o=new Uint8Array(r);for(let t=0,n=0;t<r;t++,n+=2){let r=c(e.charCodeAt(n)),i=c(e.charCodeAt(n+1));if(void 0===r||void 0===i){let t=e[n]+e[n+1];throw Error('hex string expected, got non-hex character "'+t+'" at index '+n)}o[t]=16*r+i}return o},e.exports.asyncLoop=p,e.exports.utf8ToBytes=b,e.exports.bytesToUtf8=function(e){return new TextDecoder().decode(e)},e.exports.toBytes=x,e.exports.kdfInputToBytes=function(e){return"string"==typeof e&&(e=b(e)),s(e),e},e.exports.concatBytes=function(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];s(o),t+=o.length}let r=new Uint8Array(t);for(let t=0,o=0;t<e.length;t++){let n=e[t];r.set(n,o),o+=n.length}return r},e.exports.checkOpts=function(e,t){if(void 0!==t&&"[object Object]"!==({}).toString.call(t))throw Error("options should be object or undefined");let r=Object.assign(e,t);return r},e.exports.createHasher=y,e.exports.createOptHasher=g,e.exports.createXOFer=m,e.exports.randomBytes=function(e=32){if(r.crypto&&"function"==typeof r.crypto.getRandomValues)return r.crypto.getRandomValues(new Uint8Array(e));if(r.crypto&&"function"==typeof r.crypto.randomBytes)return Uint8Array.from(r.crypto.randomBytes(e));throw Error("crypto.getRandomValues must be defined")};var r=i("aUApy");function o(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function n(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function s(e,...t){if(!o(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function a(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function l(e){for(let t=0;t<e.length;t++)e[t]=a(e[t]);return e}e.exports.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],e.exports.swap8IfBE=e.exports.isLE?e=>e:e=>a(e),e.exports.byteSwapIfBE=e.exports.swap8IfBE,e.exports.swap32IfBE=e.exports.isLE?e=>e:l;let f="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,u=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0")),d={_0:48,_9:57,A:65,F:70,a:97,f:102};function c(e){return e>=d._0&&e<=d._9?e-d._0:e>=d.A&&e<=d.F?e-(d.A-10):e>=d.a&&e<=d.f?e-(d.a-10):void 0}let h=async()=>{};async function p(t,r,o){let n=Date.now();for(let i=0;i<t;i++){o(i);let t=Date.now()-n;t>=0&&t<r||(await (0,e.exports.nextTick)(),n+=t)}}function b(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function x(e){return"string"==typeof e&&(e=b(e)),s(e),e}function y(e){let t=t=>e().update(x(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function g(e){let t=(t,r)=>e(r).update(x(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}function m(e){let t=(t,r)=>e(r).update(x(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}e.exports.nextTick=h,e.exports.Hash=class{},e.exports.wrapConstructor=y,e.exports.wrapConstructorWithOpts=g,e.exports.wrapXOFConstructorWithOpts=m}),i.register("aUApy",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.crypto=void 0,e.exports.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0}),i.register("i02N0",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.toBig=e.exports.shrSL=e.exports.shrSH=e.exports.rotrSL=e.exports.rotrSH=e.exports.rotrBL=e.exports.rotrBH=e.exports.rotr32L=e.exports.rotr32H=e.exports.rotlSL=e.exports.rotlSH=e.exports.rotlBL=e.exports.rotlBH=e.exports.add5L=e.exports.add5H=e.exports.add4L=e.exports.add4H=e.exports.add3L=e.exports.add3H=void 0,e.exports.add=m,e.exports.fromBig=n,e.exports.split=i;let r=BigInt(4294967296-1),o=BigInt(32);function n(e,t=!1){return t?{h:Number(e&r),l:Number(e>>o&r)}:{h:0|Number(e>>o&r),l:0|Number(e&r)}}function i(e,t=!1){let r=e.length,o=new Uint32Array(r),i=new Uint32Array(r);for(let s=0;s<r;s++){let{h:r,l:a}=n(e[s],t);[o[s],i[s]]=[r,a]}return[o,i]}let s=(e,t)=>BigInt(e>>>0)<<o|BigInt(t>>>0);e.exports.toBig=s;let a=(e,t,r)=>e>>>r;e.exports.shrSH=a;let l=(e,t,r)=>e<<32-r|t>>>r;e.exports.shrSL=l;let f=(e,t,r)=>e>>>r|t<<32-r;e.exports.rotrSH=f;let u=(e,t,r)=>e<<32-r|t>>>r;e.exports.rotrSL=u;let d=(e,t,r)=>e<<64-r|t>>>r-32;e.exports.rotrBH=d;let c=(e,t,r)=>e>>>r-32|t<<64-r;e.exports.rotrBL=c;let h=(e,t)=>t;e.exports.rotr32H=h;let p=(e,t)=>e;e.exports.rotr32L=p;let b=(e,t,r)=>e<<r|t>>>32-r;e.exports.rotlSH=b;let x=(e,t,r)=>t<<r|e>>>32-r;e.exports.rotlSL=x;let y=(e,t,r)=>t<<r-32|e>>>64-r;e.exports.rotlBH=y;let g=(e,t,r)=>e<<r-32|t>>>64-r;function m(e,t,r,o){let n=(t>>>0)+(o>>>0);return{h:e+r+(n/4294967296|0)|0,l:0|n}}e.exports.rotlBL=g;let w=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);e.exports.add3L=w;let E=(e,t,r,o)=>t+r+o+(e/4294967296|0)|0;e.exports.add3H=E;let B=(e,t,r,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(o>>>0);e.exports.add4L=B;let v=(e,t,r,o,n)=>t+r+o+n+(e/4294967296|0)|0;e.exports.add4H=v;let H=(e,t,r,o,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(o>>>0)+(n>>>0);e.exports.add5L=H;let S=(e,t,r,o,n,i)=>t+r+o+n+i+(e/4294967296|0)|0;e.exports.add5H=S,e.exports.default={fromBig:n,split:i,toBig:s,shrSH:a,shrSL:l,rotrSH:f,rotrSL:u,rotrBH:d,rotrBL:c,rotr32H:h,rotr32L:p,rotlSH:b,rotlSL:x,rotlBH:y,rotlBL:g,add:m,add3L:w,add3H:E,add4L:B,add4H:v,add5H:S,add5L:H}}),i.register("3WQ7x",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.getHash=function(e){return{hash:e}},e.exports.createCurve=function(e,t){let o=t=>(0,r.weierstrass)({...e,hash:t});return{...o(t),create:o}};var r=i("1qYng")}),i.register("1qYng",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.DER=e.exports.DERErr=void 0,e.exports._legacyHelperEquat=p,e.exports._legacyHelperNormPriv=b,e.exports.weierstrassN=x,e.exports.weierstrassPoints=function(e){let{CURVE:t,curveOpts:r}=m(e),n=x(t,r);return function(e,t){let{Fp:r,Fn:n}=t,i=p(r,e.a,e.b),s=b(n,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return Object.assign({},{CURVE:e,Point:t,ProjectivePoint:t,normPrivateKeyToScalar:s,weierstrassEquation:i,isWithinCurveOrder:function(e){return(0,o.inRange)(e,u,n.ORDER)}})}(e,n)},e.exports.ecdsa=g,e.exports.weierstrass=function(e){let{CURVE:t,curveOpts:r,ecdsaOpts:o}=function(e){let{CURVE:t,curveOpts:r}=m(e),o={hash:e.hash,hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:r,ecdsaOpts:o}}(e),n=x(t,r),i=g(n,o,r);return Object.assign({},i,{ProjectivePoint:i.Point,CURVE:e})},e.exports.SWUFpSqrtRatio=w,e.exports.mapToCurveSimpleSWU=function(e,t){(0,s.validateField)(e);let{A:r,B:o,Z:n}=t;if(!e.isValid(r)||!e.isValid(o)||!e.isValid(n))throw Error("mapToCurveSimpleSWU: invalid opts");let i=w(e,n);if(!e.isOdd)throw Error("Field does not have .isOdd()");return t=>{let a,l,f,u,d,c,h,p;a=e.sqr(t),a=e.mul(a,n),l=e.sqr(a),l=e.add(l,a),f=e.add(l,e.ONE),f=e.mul(f,o),u=e.cmov(n,e.neg(l),!e.eql(l,e.ZERO)),u=e.mul(u,r),l=e.sqr(f),c=e.sqr(u),d=e.mul(c,r),l=e.add(l,d),l=e.mul(l,f),c=e.mul(c,u),d=e.mul(c,o),l=e.add(l,d),h=e.mul(a,f);let{isValid:b,value:x}=i(l,c);p=e.mul(a,t),p=e.mul(p,x),h=e.cmov(h,f,b),p=e.cmov(p,x,b);let y=e.isOdd(t)===e.isOdd(p);p=e.cmov(e.neg(p),p,y);let g=(0,s.FpInvertBatch)(e,[u],!0)[0];return{x:h=e.mul(h,g),y:p}}};var r=i("b9NBV"),o=i("joUi2"),n=i("9ZBbH"),s=i("4ULxn");function a(e){void 0!==e.lowS&&(0,o.abool)("lowS",e.lowS),void 0!==e.prehash&&(0,o.abool)("prehash",e.prehash)}class l extends Error{constructor(e=""){super(e)}}e.exports.DERErr=l,e.exports.DER={Err:l,_tlv:{encode:(t,r)=>{let{Err:n}=e.exports.DER;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(1&r.length)throw new n("tlv.encode: unpadded data");let i=r.length/2,s=(0,o.numberToHexUnpadded)(i);if(s.length/2&128)throw new n("tlv.encode: long form length too big");let a=i>127?(0,o.numberToHexUnpadded)(s.length/2|128):"",l=(0,o.numberToHexUnpadded)(t);return l+a+s+r},decode(t,r){let{Err:o}=e.exports.DER,n=0;if(t<0||t>256)throw new o("tlv.encode: wrong tag");if(r.length<2||r[n++]!==t)throw new o("tlv.decode: wrong tlv");let i=r[n++],s=0;if(128&i){let e=127&i;if(!e)throw new o("tlv.decode(long): indefinite length not supported");if(e>4)throw new o("tlv.decode(long): byte length is too big");let t=r.subarray(n,n+e);if(t.length!==e)throw new o("tlv.decode: length bytes not complete");if(0===t[0])throw new o("tlv.decode(long): zero leftmost byte");for(let e of t)s=s<<8|e;if(n+=e,s<128)throw new o("tlv.decode(long): not minimal encoding")}else s=i;let a=r.subarray(n,n+s);if(a.length!==s)throw new o("tlv.decode: wrong value length");return{v:a,l:r.subarray(n+s)}}},_int:{encode(t){let{Err:r}=e.exports.DER;if(t<f)throw new r("integer: negative integers are not allowed");let n=(0,o.numberToHexUnpadded)(t);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new r("unexpected DER parsing assertion: unpadded hex");return n},decode(t){let{Err:r}=e.exports.DER;if(128&t[0])throw new r("invalid signature integer: negative");if(0===t[0]&&!(128&t[1]))throw new r("invalid signature integer: unnecessary leading zero");return(0,o.bytesToNumberBE)(t)}},toSig(t){let{Err:r,_int:n,_tlv:i}=e.exports.DER,s=(0,o.ensureBytes)("signature",t),{v:a,l:l}=i.decode(48,s);if(l.length)throw new r("invalid signature: left bytes after parsing");let{v:f,l:u}=i.decode(2,a),{v:d,l:c}=i.decode(2,u);if(c.length)throw new r("invalid signature: left bytes after parsing");return{r:n.decode(f),s:n.decode(d)}},hexFromSig(t){let{_tlv:r,_int:o}=e.exports.DER,n=r.encode(2,o.encode(t.r)),i=r.encode(2,o.encode(t.s));return r.encode(48,n+i)}};let f=BigInt(0),u=BigInt(1),d=BigInt(2),c=BigInt(3),h=BigInt(4);function p(e,t,r){return function(o){let n=e.sqr(o),i=e.mul(n,o);return e.add(e.add(i,e.mul(o,t)),r)}}function b(e,t,r){let{BYTES:n}=e;return function(i){let s;if("bigint"==typeof i)s=i;else{let r=(0,o.ensureBytes)("private key",i);if(t){if(!t.includes(2*r.length))throw Error("invalid private key");let e=new Uint8Array(n);e.set(r,e.length-r.length),r=e}try{s=e.fromBytes(r)}catch(e){throw Error(`invalid private key: expected ui8a of size ${n}, got ${typeof i}`)}}if(r&&(s=e.create(s)),!e.isValidNot0(s))throw Error("invalid private key: out of range [1..N-1]");return s}}function x(e,t={}){let{Fp:r,Fn:i}=(0,n._createCurveFields)("weierstrass",e,t),{h:s,n:a}=e;(0,o._validateObject)(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:l}=t;if(l&&(!r.is0(e.a)||"bigint"!=typeof l.beta||"function"!=typeof l.splitScalar))throw Error('invalid endo: expected "beta": bigint and "splitScalar": function');function d(){if(!r.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let x=t.toBytes||function(e,t,n){let{x:i,y:s}=t.toAffine(),a=r.toBytes(i);if((0,o.abool)("isCompressed",n),!n)return(0,o.concatBytes)(Uint8Array.of(4),a,r.toBytes(s));{d();let e=!r.isOdd(s);return(0,o.concatBytes)(y(e),a)}},g=t.fromBytes||function(e){(0,o.abytes)(e);let t=r.BYTES,n=t+1,i=2*t+1,s=e.length,a=e[0],l=e.subarray(1);if(s===n&&(2===a||3===a)){let e;let t=r.fromBytes(l);if(!r.isValid(t))throw Error("bad point: is not on curve, wrong x");let o=m(t);try{e=r.sqrt(o)}catch(t){let e=t instanceof Error?": "+t.message:"";throw Error("bad point: is not on curve, sqrt error"+e)}d();let n=r.isOdd(e);return(1&a)==1!==n&&(e=r.neg(e)),{x:t,y:e}}if(s===i&&4===a){let e=r.fromBytes(l.subarray(0*t,1*t)),o=r.fromBytes(l.subarray(1*t,2*t));if(!w(e,o))throw Error("bad point: is not on curve");return{x:e,y:o}}throw Error(`bad point: got length ${s}, expected compressed=${n} or uncompressed=${i}`)},m=p(r,e.a,e.b);function w(e,t){let o=r.sqr(t),n=m(e);return r.eql(o,n)}if(!w(e.Gx,e.Gy))throw Error("bad curve params: generator point");let E=r.mul(r.pow(e.a,c),h),B=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(E,B)))throw Error("bad curve params: a or b");function v(e,t,o=!1){if(!r.isValid(t)||o&&r.is0(t))throw Error(`bad point coordinate ${e}`);return t}function H(e){if(!(e instanceof O))throw Error("ProjectivePoint expected")}let S=(0,o.memoized)((e,t)=>{let{px:o,py:n,pz:i}=e;if(r.eql(i,r.ONE))return{x:o,y:n};let s=e.is0();null==t&&(t=s?r.ONE:r.inv(i));let a=r.mul(o,t),l=r.mul(n,t),f=r.mul(i,t);if(s)return{x:r.ZERO,y:r.ZERO};if(!r.eql(f,r.ONE))throw Error("invZ was invalid");return{x:a,y:l}}),A=(0,o.memoized)(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw Error("bad point: ZERO")}let{x:o,y:n}=e.toAffine();if(!r.isValid(o)||!r.isValid(n))throw Error("bad point: x or y not field elements");if(!w(o,n))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function I(e,t,o,i,s){return o=new O(r.mul(o.px,e),o.py,o.pz),t=(0,n.negateCt)(i,t),o=(0,n.negateCt)(s,o),t.add(o)}class O{constructor(e,t,r){this.px=v("x",e),this.py=v("y",t,!0),this.pz=v("z",r),Object.freeze(this)}static fromAffine(e){let{x:t,y:o}=e||{};if(!e||!r.isValid(t)||!r.isValid(o))throw Error("invalid affine point");if(e instanceof O)throw Error("projective point not allowed");return r.is0(t)&&r.is0(o)?O.ZERO:new O(t,o,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){return(0,n.normalizeZ)(O,"pz",e)}static fromBytes(e){return(0,o.abytes)(e),O.fromHex(e)}static fromHex(e){let t=O.fromAffine(g((0,o.ensureBytes)("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){let r=b(i,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return O.BASE.multiply(r(e))}static msm(e,t){return(0,n.pippenger)(O,i,e,t)}precompute(e=8,t=!0){return L.setWindowSize(this,e),t||this.multiply(c),this}_setWindowSize(e){this.precompute(e)}assertValidity(){A(this)}hasEvenY(){let{y:e}=this.toAffine();if(!r.isOdd)throw Error("Field doesn't support isOdd");return!r.isOdd(e)}equals(e){H(e);let{px:t,py:o,pz:n}=this,{px:i,py:s,pz:a}=e,l=r.eql(r.mul(t,a),r.mul(i,n)),f=r.eql(r.mul(o,a),r.mul(s,n));return l&&f}negate(){return new O(this.px,r.neg(this.py),this.pz)}double(){let{a:t,b:o}=e,n=r.mul(o,c),{px:i,py:s,pz:a}=this,l=r.ZERO,f=r.ZERO,u=r.ZERO,d=r.mul(i,i),h=r.mul(s,s),p=r.mul(a,a),b=r.mul(i,s);return b=r.add(b,b),u=r.mul(i,a),u=r.add(u,u),l=r.mul(t,u),f=r.mul(n,p),f=r.add(l,f),l=r.sub(h,f),f=r.add(h,f),f=r.mul(l,f),l=r.mul(b,l),u=r.mul(n,u),p=r.mul(t,p),b=r.sub(d,p),b=r.mul(t,b),b=r.add(b,u),u=r.add(d,d),d=r.add(u,d),d=r.add(d,p),d=r.mul(d,b),f=r.add(f,d),p=r.mul(s,a),p=r.add(p,p),d=r.mul(p,b),l=r.sub(l,d),u=r.mul(p,h),u=r.add(u,u),new O(l,f,u=r.add(u,u))}add(t){H(t);let{px:o,py:n,pz:i}=this,{px:s,py:a,pz:l}=t,f=r.ZERO,u=r.ZERO,d=r.ZERO,h=e.a,p=r.mul(e.b,c),b=r.mul(o,s),x=r.mul(n,a),y=r.mul(i,l),g=r.add(o,n),m=r.add(s,a);g=r.mul(g,m),m=r.add(b,x),g=r.sub(g,m),m=r.add(o,i);let w=r.add(s,l);return m=r.mul(m,w),w=r.add(b,y),m=r.sub(m,w),w=r.add(n,i),f=r.add(a,l),w=r.mul(w,f),f=r.add(x,y),w=r.sub(w,f),d=r.mul(h,m),f=r.mul(p,y),d=r.add(f,d),f=r.sub(x,d),d=r.add(x,d),u=r.mul(f,d),x=r.add(b,b),x=r.add(x,b),y=r.mul(h,y),m=r.mul(p,m),x=r.add(x,y),y=r.sub(b,y),y=r.mul(h,y),m=r.add(m,y),b=r.mul(x,m),u=r.add(u,b),b=r.mul(w,m),f=r.mul(g,f),f=r.sub(f,b),b=r.mul(g,x),d=r.mul(w,d),new O(f,u,d=r.add(d,b))}subtract(e){return this.add(e.negate())}is0(){return this.equals(O.ZERO)}multiply(e){let r,o;let{endo:n}=t;if(!i.isValidNot0(e))throw Error("invalid scalar: out of range");let s=e=>L.wNAFCached(this,e,O.normalizeZ);if(n){let{k1neg:t,k1:i,k2neg:a,k2:l}=n.splitScalar(e),{p:f,f:u}=s(i),{p:d,f:c}=s(l);o=u.add(c),r=I(n.beta,f,d,t,a)}else{let{p:t,f:n}=s(e);r=t,o=n}return O.normalizeZ([r,o])[0]}multiplyUnsafe(e){let{endo:r}=t;if(!i.isValid(e))throw Error("invalid scalar: out of range");if(e===f||this.is0())return O.ZERO;if(e===u)return this;if(L.hasPrecomputes(this))return this.multiply(e);if(!r)return L.wNAFCachedUnsafe(this,e);{let{k1neg:t,k1:o,k2neg:i,k2:s}=r.splitScalar(e),{p1:a,p2:l}=(0,n.mulEndoUnsafe)(O,this,o,s);return I(r.beta,a,l,t,i)}}multiplyAndAddUnsafe(e,t,r){let o=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return o.is0()?void 0:o}toAffine(e){return S(this,e)}isTorsionFree(){let{isTorsionFree:e}=t;return s===u||(e?e(O,this):L.wNAFCachedUnsafe(this,a).is0())}clearCofactor(){let{clearCofactor:e}=t;return s===u?this:e?e(O,this):this.multiplyUnsafe(s)}toBytes(e=!0){return(0,o.abool)("isCompressed",e),this.assertValidity(),x(O,this,e)}toRawBytes(e=!0){return this.toBytes(e)}toHex(e=!0){return(0,o.bytesToHex)(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}O.BASE=new O(e.Gx,e.Gy,r.ONE),O.ZERO=new O(r.ZERO,r.ONE,r.ZERO),O.Fp=r,O.Fn=i;let _=i.BITS,L=(0,n.wNAF)(O,t.endo?Math.ceil(_/2):_);return O}function y(e){return Uint8Array.of(e?2:3)}function g(t,n,i={}){(0,o._validateObject)(n,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let l=n.randomBytes||o.randomBytes,c=n.hmac||((e,...t)=>(0,r.hmac)(n.hash,e,(0,o.concatBytes)(...t))),{Fp:h,Fn:p}=t,{ORDER:x,BITS:g}=p;function m(e){let t=x>>u;return e>t}function w(e,t){if(!p.isValidNot0(t))throw Error(`invalid signature ${e}: out of range 1..CURVE.n`)}class E{constructor(e,t,r){w("r",e),w("s",t),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){let t=p.BYTES,r=(0,o.ensureBytes)("compactSignature",e,2*t);return new E(p.fromBytes(r.subarray(0,t)),p.fromBytes(r.subarray(t,2*t)))}static fromDER(t){let{r:r,s:n}=e.exports.DER.toSig((0,o.ensureBytes)("DER",t));return new E(r,n)}assertValidity(){}addRecoveryBit(e){return new E(this.r,this.s,e)}recoverPublicKey(e){let r=h.ORDER,{r:n,s:i,recovery:s}=this;if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");let a=x*d<r;if(a&&s>1)throw Error("recovery id is ambiguous for h>1 curve");let l=2===s||3===s?n+x:n;if(!h.isValid(l))throw Error("recovery id 2 or 3 invalid");let f=h.toBytes(l),u=t.fromHex((0,o.concatBytes)(y((1&s)==0),f)),c=p.inv(l),b=S((0,o.ensureBytes)("msgHash",e)),g=p.create(-b*c),m=p.create(i*c),w=t.BASE.multiplyUnsafe(g).add(u.multiplyUnsafe(m));if(w.is0())throw Error("point at infinify");return w.assertValidity(),w}hasHighS(){return m(this.s)}normalizeS(){return this.hasHighS()?new E(this.r,p.neg(this.s),this.recovery):this}toBytes(t){if("compact"===t)return(0,o.concatBytes)(p.toBytes(this.r),p.toBytes(this.s));if("der"===t)return(0,o.hexToBytes)(e.exports.DER.hexFromSig(this));throw Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,o.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,o.bytesToHex)(this.toBytes("compact"))}}let B=b(p,i.allowedPrivateKeyLengths,i.wrapPrivateKey);function v(e){if("bigint"==typeof e)return!1;if(e instanceof t)return!0;let r=(0,o.ensureBytes)("key",e),n=r.length,s=h.BYTES,a=s+1;if(!i.allowedPrivateKeyLengths&&p.BYTES!==a)return n===a||n===2*s+1}let H=n.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=(0,o.bytesToNumberBE)(e),r=8*e.length-g;return r>0?t>>BigInt(r):t},S=n.bits2int_modN||function(e){return p.create(H(e))},A=(0,o.bitMask)(g);function I(e){return(0,o.aInRange)("num < 2^"+g,e,f,A),p.toBytes(e)}let O={lowS:n.lowS,prehash:!1},_={lowS:n.lowS,prehash:!1};return t.BASE.precompute(8),Object.freeze({getPublicKey:function(e,r=!0){return t.fromPrivateKey(e).toBytes(r)},getSharedSecret:function(e,r,o=!0){if(!0===v(e))throw Error("first arg must be private key");if(!1===v(r))throw Error("second arg must be public key");let n=t.fromHex(r);return n.multiply(B(e)).toBytes(o)},sign:function(e,r,i=O){let{seed:s,k2sig:d}=function(e,r,i=O){if(["recovered","canonical"].some(e=>e in i))throw Error("sign() legacy options not supported");let{hash:s}=n,{lowS:d,prehash:c,extraEntropy:b}=i;null==d&&(d=!0),e=(0,o.ensureBytes)("msgHash",e),a(i),c&&(e=(0,o.ensureBytes)("prehashed msgHash",s(e)));let x=S(e),y=B(r),g=[I(y),I(x)];if(null!=b&&!1!==b){let e=!0===b?l(h.BYTES):b;g.push((0,o.ensureBytes)("extraEntropy",e))}let w=(0,o.concatBytes)(...g);return{seed:w,k2sig:function(e){let r=H(e);if(!p.isValidNot0(r))return;let o=p.inv(r),n=t.BASE.multiply(r).toAffine(),i=p.create(n.x);if(i===f)return;let s=p.create(o*p.create(x+i*y));if(s===f)return;let a=(n.x===i?0:2)|Number(n.y&u),l=s;return d&&m(s)&&(l=m(s)?p.neg(s):s,a^=1),new E(i,l,a)}}}(e,r,i),b=(0,o.createHmacDrbg)(n.hash.outputLen,p.BYTES,c);return b(s,d)},verify:function(r,i,s,l=_){let f,u;i=(0,o.ensureBytes)("msgHash",i),s=(0,o.ensureBytes)("publicKey",s),a(l);let{lowS:d,prehash:c,format:h}=l;if("strict"in l)throw Error("options.strict was renamed to lowS");if(void 0!==h&&!["compact","der","js"].includes(h))throw Error('format must be "compact", "der" or "js"');let b="string"==typeof r||(0,o.isBytes)(r),x=!b&&!h&&"object"==typeof r&&null!==r&&"bigint"==typeof r.r&&"bigint"==typeof r.s;if(!b&&!x)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(x){if(void 0===h||"js"===h)u=new E(r.r,r.s);else throw Error("invalid format")}if(b){try{"compact"!==h&&(u=E.fromDER(r))}catch(t){if(!(t instanceof e.exports.DER.Err))throw t}u||"der"===h||(u=E.fromCompact(r))}f=t.fromHex(s)}catch(e){return!1}if(!u||d&&u.hasHighS())return!1;c&&(i=n.hash(i));let{r:y,s:g}=u,m=S(i),w=p.inv(g),B=p.create(m*w),v=p.create(y*w),H=t.BASE.multiplyUnsafe(B).add(f.multiplyUnsafe(v));if(H.is0())return!1;let A=p.create(H.x);return A===y},utils:{isValidPrivateKey(e){try{return B(e),!0}catch(e){return!1}},normPrivateKeyToScalar:B,randomPrivateKey:()=>(0,s.mapHashToField)(l((0,s.getMinHashLength)(x)),x),precompute:(e=8,r=t.BASE)=>r.precompute(e,!1)},Point:t,Signature:E})}function m(e){let t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,o=(0,s.Field)(t.n,e.nBitLength),n={Fp:r,Fn:o,allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:n}}function w(e,t){let r=e.ORDER,o=f;for(let e=r-u;e%d===f;e/=d)o+=u;let n=o,i=d<<n-u-u,s=i*d,a=(r-u)/s,l=(a-u)/d,p=s-u,b=e.pow(t,a),x=e.pow(t,(a+u)/d),y=(t,r)=>{let o=b,s=e.pow(r,p),a=e.sqr(s);a=e.mul(a,r);let f=e.mul(t,a);f=e.pow(f,l),f=e.mul(f,s),s=e.mul(f,r),a=e.mul(f,t);let c=e.mul(a,s);f=e.pow(c,i);let h=e.eql(f,e.ONE);s=e.mul(a,x),f=e.mul(c,o),a=e.cmov(s,a,h),c=e.cmov(f,c,h);for(let t=n;t>u;t--){let r=t-d;r=d<<r-u;let n=e.pow(c,r),i=e.eql(n,e.ONE);s=e.mul(a,o),o=e.mul(o,o),n=e.mul(c,o),a=e.cmov(s,a,i),c=e.cmov(n,c,i)}return{isValid:h,value:a}};if(e.ORDER%h===c){let r=(e.ORDER-c)/h,o=e.sqrt(e.neg(t));y=(t,n)=>{let i=e.sqr(n),s=e.mul(t,n);i=e.mul(i,s);let a=e.pow(i,r);a=e.mul(a,s);let l=e.mul(a,o),f=e.mul(e.sqr(a),n),u=e.eql(f,t),d=e.cmov(l,a,u);return{isValid:u,value:d}}}return y}}),i.register("b9NBV",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.hmac=e.exports.HMAC=void 0;var r=i("bHkZ3");class o extends r.Hash{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,(0,r.ahash)(e);let o=(0,r.toBytes)(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,i=new Uint8Array(n);i.set(o.length>n?e.create().update(o).digest():o);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),(0,r.clean)(i)}update(e){return(0,r.aexists)(this),this.iHash.update(e),this}digestInto(e){(0,r.aexists)(this),(0,r.abytes)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:o,destroyed:n,blockLen:i,outputLen:s}=this;return e.finished=o,e.destroyed=n,e.blockLen=i,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}e.exports.HMAC=o,e.exports.hmac=(e,t,r)=>new o(e,t).update(r).digest(),e.exports.hmac.create=(e,t)=>new o(e,t)}),i.register("joUi2",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.notImplemented=e.exports.bitMask=e.exports.utf8ToBytes=e.exports.randomBytes=e.exports.isBytes=e.exports.hexToBytes=e.exports.concatBytes=e.exports.bytesToUtf8=e.exports.bytesToHex=e.exports.anumber=e.exports.abytes=void 0,e.exports.abool=function(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)},e.exports.numberToHexUnpadded=s,e.exports.hexToNumber=a,e.exports.bytesToNumberBE=function(e){return a((0,r.bytesToHex)(e))},e.exports.bytesToNumberLE=function(e){return(0,r.abytes)(e),a((0,r.bytesToHex)(Uint8Array.from(e).reverse()))},e.exports.numberToBytesBE=l,e.exports.numberToBytesLE=function(e,t){return l(e,t).reverse()},e.exports.numberToVarBytesBE=function(e){return(0,r.hexToBytes)(s(e))},e.exports.ensureBytes=function(e,t,o){let n;if("string"==typeof t)try{n=(0,r.hexToBytes)(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if((0,r.isBytes)(t))n=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let i=n.length;if("number"==typeof o&&i!==o)throw Error(e+" of length "+o+" expected, got "+i);return n},e.exports.equalBytes=function(e,t){if(e.length!==t.length)return!1;let r=0;for(let o=0;o<e.length;o++)r|=e[o]^t[o];return 0===r},e.exports.inRange=u,e.exports.aInRange=function(e,t,r,o){if(!u(t,r,o))throw Error("expected valid "+e+": "+r+" <= n < "+o+", got "+t)},e.exports.bitLen=function(e){let t;for(t=0;e>o;e>>=n,t+=1);return t},e.exports.bitGet=function(e,t){return e>>BigInt(t)&n},e.exports.bitSet=function(e,t,r){return e|(r?n:o)<<BigInt(t)},e.exports.createHmacDrbg=function(e,t,o){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof o)throw Error("hmacFn must be a function");let n=e=>new Uint8Array(e),i=e=>Uint8Array.of(e),s=n(e),a=n(e),l=0,f=()=>{s.fill(1),a.fill(0),l=0},u=(...e)=>o(a,s,...e),d=(e=n(0))=>{a=u(i(0),e),s=u(),0!==e.length&&(a=u(i(1),e),s=u())},c=()=>{if(l++>=1e3)throw Error("drbg: tried 1000 values");let e=0,o=[];for(;e<t;){s=u();let t=s.slice();o.push(t),e+=s.length}return(0,r.concatBytes)(...o)};return(e,t)=>{let r;for(f(),d(e);!(r=t(c()));)d();return f(),r}},e.exports.validateObject=function(e,t,r={}){let o=(t,r,o)=>{let n=d[r];if("function"!=typeof n)throw Error("invalid validator function");let i=e[t];if((!o||void 0!==i)&&!n(i,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+i)};for(let[e,r]of Object.entries(t))o(e,r,!1);for(let[e,t]of Object.entries(r))o(e,t,!0);return e},e.exports.isHash=function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)},e.exports._validateObject=function(e,t,r={}){if(!e||"object"!=typeof e)throw Error("expected valid options object");function o(t,r,o){let n=e[t];if(o&&void 0===n)return;let i=typeof n;if(i!==r||null===n)throw Error(`param "${t}" is invalid: expected ${r}, got ${i}`)}Object.entries(t).forEach(([e,t])=>o(e,t,!1)),Object.entries(r).forEach(([e,t])=>o(e,t,!0))},e.exports.memoized=function(e){let t=new WeakMap;return(r,...o)=>{let n=t.get(r);if(void 0!==n)return n;let i=e(r,...o);return t.set(r,i),i}};var r=(i("bHkZ3"),i("bHkZ3"));Object.defineProperty(e.exports,"abytes",{enumerable:!0,get:function(){return r.abytes}}),Object.defineProperty(e.exports,"anumber",{enumerable:!0,get:function(){return r.anumber}}),Object.defineProperty(e.exports,"bytesToHex",{enumerable:!0,get:function(){return r.bytesToHex}}),Object.defineProperty(e.exports,"bytesToUtf8",{enumerable:!0,get:function(){return r.bytesToUtf8}}),Object.defineProperty(e.exports,"concatBytes",{enumerable:!0,get:function(){return r.concatBytes}}),Object.defineProperty(e.exports,"hexToBytes",{enumerable:!0,get:function(){return r.hexToBytes}}),Object.defineProperty(e.exports,"isBytes",{enumerable:!0,get:function(){return r.isBytes}}),Object.defineProperty(e.exports,"randomBytes",{enumerable:!0,get:function(){return r.randomBytes}}),Object.defineProperty(e.exports,"utf8ToBytes",{enumerable:!0,get:function(){return r.utf8ToBytes}});let o=BigInt(0),n=BigInt(1);function s(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function a(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?o:BigInt("0x"+e)}function l(e,t){return(0,r.hexToBytes)(e.toString(16).padStart(2*t,"0"))}let f=e=>"bigint"==typeof e&&o<=e;function u(e,t,r){return f(e)&&f(t)&&f(r)&&t<=e&&e<r}e.exports.bitMask=e=>(n<<BigInt(e))-n;let d={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||(0,r.isBytes)(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};e.exports.notImplemented=()=>{throw Error("not implemented")}}),i.register("9ZBbH",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.negateCt=a,e.exports.normalizeZ=function(e,t,r){let n=(0,o.FpInvertBatch)(e.Fp,r.map("pz"===t?e=>e.pz:e=>e.ez)),i=r.map((e,t)=>e.toAffine(n[t]));return i.map(e.fromAffine)},e.exports.wNAF=function(e,t){return{constTimeNegate:a,hasPrecomputes:e=>1!==b(e),unsafeLadder(t,r,o=e.ZERO){let i=t;for(;r>n;)r&s&&(o=o.add(i)),i=i.double(),r>>=s;return o},precomputeWindow(e,r){let{windows:o,windowSize:n}=f(r,t),i=[],s=e,a=s;for(let e=0;e<o;e++){a=s,i.push(a);for(let e=1;e<n;e++)a=a.add(s),i.push(a);s=a.double()}return i},wNAF(r,o,n){let i=e.ZERO,s=e.BASE,l=f(r,t);for(let e=0;e<l.windows;e++){let{nextN:t,offset:r,isZero:f,isNeg:d,isNegF:c,offsetF:h}=u(n,e,l);n=t,f?s=s.add(a(c,o[h])):i=i.add(a(d,o[r]))}return x(n),{p:i,f:s}},wNAFUnsafe(r,o,i,s=e.ZERO){let a=f(r,t);for(let e=0;e<a.windows&&i!==n;e++){let{nextN:t,offset:r,isZero:n,isNeg:l}=u(i,e,a);if(i=t,!n){let e=o[r];s=s.add(l?e.negate():e)}}return x(i),s},getPrecomputes(e,t,r){let o=h.get(t);return o||(o=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(o=r(o)),h.set(t,o))),o},wNAFCached(e,t,r){let o=b(e);return this.wNAF(o,this.getPrecomputes(o,e,r),t)},wNAFCachedUnsafe(e,t,r,o){let n=b(e);return 1===n?this.unsafeLadder(e,t,o):this.wNAFUnsafe(n,this.getPrecomputes(n,e,r),t,o)},setWindowSize(e,r){l(r,t),p.set(e,r),h.delete(e)}}},e.exports.mulEndoUnsafe=function(e,t,r,o){let i=t,a=e.ZERO,l=e.ZERO;for(;r>n||o>n;)r&s&&(a=a.add(i)),o&s&&(l=l.add(i)),i=i.double(),r>>=s,o>>=s;return{p1:a,p2:l}},e.exports.pippenger=function(e,t,o,n){d(o,e),c(n,t);let i=o.length,s=n.length;if(i!==s)throw Error("arrays of points and scalars must have equal length");let a=e.ZERO,l=(0,r.bitLen)(BigInt(i)),f=1;l>12?f=l-3:l>4?f=l-2:l>0&&(f=2);let u=(0,r.bitMask)(f),h=Array(Number(u)+1).fill(a),p=Math.floor((t.BITS-1)/f)*f,b=a;for(let e=p;e>=0;e-=f){h.fill(a);for(let t=0;t<s;t++){let r=n[t],i=Number(r>>BigInt(e)&u);h[i]=h[i].add(o[t])}let t=a;for(let e=h.length-1,r=a;e>0;e--)r=r.add(h[e]),t=t.add(r);if(b=b.add(t),0!==e)for(let e=0;e<f;e++)b=b.double()}return b},e.exports.precomputeMSMUnsafe=function(e,t,o,n){l(n,t.BITS),d(o,e);let i=e.ZERO,s=2**n-1,a=Math.ceil(t.BITS/n),f=(0,r.bitMask)(n),u=o.map(e=>{let t=[];for(let r=0,o=e;r<s;r++)t.push(o),o=o.add(e);return t});return e=>{if(c(e,t),e.length>o.length)throw Error("array of scalars must be smaller than array of points");let r=i;for(let t=0;t<a;t++){if(r!==i)for(let e=0;e<n;e++)r=r.double();let o=BigInt(a*n-(t+1)*n);for(let t=0;t<e.length;t++){let n=e[t],i=Number(n>>o&f);i&&(r=r.add(u[t][i-1]))}}return r}},e.exports.validateBasic=function(e){return(0,o.validateField)(e.Fp),(0,r.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,o.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})},e.exports._createCurveFields=function(e,t,r={}){if(!t||"object"!=typeof t)throw Error(`expected valid ${e} CURVE object`);for(let e of["p","n","h"]){let r=t[e];if(!("bigint"==typeof r&&r>n))throw Error(`CURVE.${e} must be positive bigint`)}let o=y(t.p,r.Fp),i=y(t.n,r.Fn);for(let r of["Gx","Gy","a","weierstrass"===e?"b":"d"])if(!o.isValid(t[r]))throw Error(`CURVE.${r} must be valid field element of CURVE.Fp`);return{Fp:o,Fn:i}};var r=i("joUi2"),o=i("4ULxn");let n=BigInt(0),s=BigInt(1);function a(e,t){let r=t.negate();return e?r:t}function l(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function f(e,t){l(e,t);let o=Math.ceil(t/e)+1,n=2**(e-1),i=2**e,s=(0,r.bitMask)(e),a=BigInt(e);return{windows:o,windowSize:n,mask:s,maxNumber:i,shiftBy:a}}function u(e,t,r){let{windowSize:o,mask:n,maxNumber:i,shiftBy:a}=r,l=Number(e&n),f=e>>a;l>o&&(l-=i,f+=s);let u=t*o,d=u+Math.abs(l)-1,c=0===l,h=l<0;return{nextN:f,offset:d,isZero:c,isNeg:h,isNegF:t%2!=0,offsetF:u}}function d(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})}function c(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}let h=new WeakMap,p=new WeakMap;function b(e){return p.get(e)||1}function x(e){if(e!==n)throw Error("invalid wNAF")}function y(e,t){if(!t)return(0,o.Field)(e);if(t.ORDER!==e)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,o.validateField)(t),t}}),i.register("4ULxn",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.isNegativeLE=void 0,e.exports.mod=d,e.exports.pow=function(e,t,r){return g(B(r),e,t)},e.exports.pow2=function(e,t,r){let n=e;for(;t-- >o;)n*=n,n%=r;return n},e.exports.invert=c,e.exports.tonelliShanks=b,e.exports.FpSqrt=x,e.exports.validateField=function(e){let t=y.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"});return(0,r._validateObject)(e,t),e},e.exports.FpPow=g,e.exports.FpInvertBatch=m,e.exports.FpDiv=function(e,t,r){return e.mul(t,"bigint"==typeof r?c(r,e.ORDER):e.inv(r))},e.exports.FpLegendre=w,e.exports.FpIsSquare=function(e,t){let r=w(e,t);return 1===r},e.exports.nLength=E,e.exports.Field=B,e.exports.FpSqrtOdd=function(e,t){if(!e.isOdd)throw Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)},e.exports.FpSqrtEven=function(e,t){if(!e.isOdd)throw Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r},e.exports.hashToPrivateScalar=function(e,t,o=!1){e=(0,r.ensureBytes)("privateHash",e);let i=e.length,s=E(t).nByteLength+8;if(s<24||i<s||i>1024)throw Error("hashToPrivateScalar: expected "+s+"-1024 bytes of input, got "+i);let a=o?(0,r.bytesToNumberLE)(e):(0,r.bytesToNumberBE)(e);return d(a,t-n)+n},e.exports.getFieldBytesLength=v,e.exports.getMinHashLength=H,e.exports.mapHashToField=function(e,t,o=!1){let i=e.length,s=v(t),a=H(t);if(i<16||i<a||i>1024)throw Error("expected "+a+"-1024 bytes of input, got "+i);let l=o?(0,r.bytesToNumberLE)(e):(0,r.bytesToNumberBE)(e),f=d(l,t-n)+n;return o?(0,r.numberToBytesLE)(f,s):(0,r.numberToBytesBE)(f,s)};var r=i("joUi2");let o=BigInt(0),n=BigInt(1),s=BigInt(2),a=BigInt(3),l=BigInt(4),f=BigInt(5),u=BigInt(8);function d(e,t){let r=e%t;return r>=o?r:t+r}function c(e,t){if(e===o)throw Error("invert: expected non-zero number");if(t<=o)throw Error("invert: expected positive modulus, got "+t);let r=d(e,t),i=t,s=o,a=n,l=n,f=o;for(;r!==o;){let e=i/r,t=i%r,o=s-l*e,n=a-f*e;i=r,r=t,s=l,a=f,l=o,f=n}let u=i;if(u!==n)throw Error("invert: does not exist");return d(s,t)}function h(e,t){let r=(e.ORDER+n)/l,o=e.pow(t,r);if(!e.eql(e.sqr(o),t))throw Error("Cannot find square root");return o}function p(e,t){let r=(e.ORDER-f)/u,o=e.mul(t,s),n=e.pow(o,r),i=e.mul(t,n),a=e.mul(e.mul(i,s),n),l=e.mul(i,e.sub(a,e.ONE));if(!e.eql(e.sqr(l),t))throw Error("Cannot find square root");return l}function b(e){if(e<BigInt(3))throw Error("sqrt is not defined for small field");let t=e-n,r=0;for(;t%s===o;)t/=s,r++;let i=s,a=B(e);for(;1===w(a,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return h;let l=a.pow(i,t),f=(t+n)/s;return function(e,o){if(e.is0(o))return o;if(1!==w(e,o))throw Error("Cannot find square root");let i=r,s=e.mul(e.ONE,l),a=e.pow(o,t),u=e.pow(o,f);for(;!e.eql(a,e.ONE);){if(e.is0(a))return e.ZERO;let t=1,r=e.sqr(a);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===i)throw Error("Cannot find square root");let o=n<<BigInt(i-t-1),l=e.pow(s,o);i=t,s=e.sqr(l),a=e.mul(a,s),u=e.mul(u,l)}return u}}function x(e){return e%l===a?h:e%u===f?p:b(e)}e.exports.isNegativeLE=(e,t)=>(d(e,t)&n)===n;let y=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function g(e,t,r){if(r<o)throw Error("invalid exponent, negatives unsupported");if(r===o)return e.ONE;if(r===n)return t;let i=e.ONE,s=t;for(;r>o;)r&n&&(i=e.mul(i,s)),s=e.sqr(s),r>>=n;return i}function m(e,t,r=!1){let o=Array(t.length).fill(r?e.ZERO:void 0),n=t.reduce((t,r,n)=>e.is0(r)?t:(o[n]=t,e.mul(t,r)),e.ONE),i=e.inv(n);return t.reduceRight((t,r,n)=>e.is0(r)?t:(o[n]=e.mul(t,o[n]),e.mul(t,r)),i),o}function w(e,t){let r=(e.ORDER-n)/s,o=e.pow(t,r),i=e.eql(o,e.ONE),a=e.eql(o,e.ZERO),l=e.eql(o,e.neg(e.ONE));if(!i&&!a&&!l)throw Error("invalid Legendre symbol result");return i?1:a?0:-1}function E(e,t){void 0!==t&&(0,r.anumber)(t);let o=void 0!==t?t:e.toString(2).length;return{nBitLength:o,nByteLength:Math.ceil(o/8)}}function B(e,t,i=!1,s={}){let a,l,f;if(e<=o)throw Error("invalid field: expected ORDER > 0, got "+e);if("object"==typeof t&&null!=t){if(s.sqrt||i)throw Error("cannot specify opts in two arguments");t.BITS&&(l=t.BITS),t.sqrt&&(f=t.sqrt),"boolean"==typeof t.isLE&&(i=t.isLE)}else"number"==typeof t&&(l=t),s.sqrt&&(f=s.sqrt);let{nBitLength:u,nByteLength:h}=E(e,l);if(h>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let p=Object.freeze({ORDER:e,isLE:i,BITS:u,BYTES:h,MASK:(0,r.bitMask)(u),ZERO:o,ONE:n,create:t=>d(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return o<=t&&t<e},is0:e=>e===o,isValidNot0:e=>!p.is0(e)&&p.isValid(e),isOdd:e=>(e&n)===n,neg:t=>d(-t,e),eql:(e,t)=>e===t,sqr:t=>d(t*t,e),add:(t,r)=>d(t+r,e),sub:(t,r)=>d(t-r,e),mul:(t,r)=>d(t*r,e),pow:(e,t)=>g(p,e,t),div:(t,r)=>d(t*c(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>c(t,e),sqrt:f||(t=>(a||(a=x(e)),a(p,t))),toBytes:e=>i?(0,r.numberToBytesLE)(e,h):(0,r.numberToBytesBE)(e,h),fromBytes:e=>{if(e.length!==h)throw Error("Field.fromBytes: expected "+h+" bytes, got "+e.length);return i?(0,r.bytesToNumberLE)(e):(0,r.bytesToNumberBE)(e)},invertBatch:e=>m(p,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(p)}function v(e){if("bigint"!=typeof e)throw Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function H(e){let t=v(e);return t+Math.ceil(t/2)}}),i.register("5GEtw",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.expand_message_xmd=l,e.exports.expand_message_xof=f,e.exports.hash_to_field=u,e.exports.isogenyMap=function(e,t){let r=t.map(e=>Array.from(e).reverse());return(t,n)=>{let[i,s,a,l]=r.map(r=>r.reduce((r,o)=>e.add(e.mul(r,t),o))),[f,u]=(0,o.FpInvertBatch)(e,[s,l],!0);return t=e.mul(i,f),n=e.mul(n,e.mul(a,u)),{x:t,y:n}}},e.exports.createHasher=function(e,t,r){if("function"!=typeof t)throw Error("mapToCurve() must be defined");function o(r){return e.fromAffine(t(r))}function n(t){let r=t.clearCofactor();return r.equals(e.ZERO)?e.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(e,t){let i=r.DST?r.DST:{},s=Object.assign({},r,i,t),a=u(e,2,s),l=o(a[0]),f=o(a[1]);return n(l.add(f))},encodeToCurve(e,t){let i=r.encodeDST?r.encodeDST:{},s=Object.assign({},r,i,t),a=u(e,1,s);return n(o(a[0]))},mapToCurve(e){if(!Array.isArray(e))throw Error("expected array of bigints");for(let t of e)if("bigint"!=typeof t)throw Error("expected array of bigints");return n(o(e))}}};var r=i("joUi2"),o=i("4ULxn");let n=r.bytesToNumberBE;function s(e,t){if(a(e),a(t),e<0||e>=1<<8*t)throw Error("invalid I2OSP input: "+e);let r=Array.from({length:t}).fill(0);for(let o=t-1;o>=0;o--)r[o]=255&e,e>>>=8;return new Uint8Array(r)}function a(e){if(!Number.isSafeInteger(e))throw Error("number expected")}function l(e,t,o,n){(0,r.abytes)(e),(0,r.abytes)(t),a(o),t.length>255&&(t=n((0,r.concatBytes)((0,r.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:i,blockLen:l}=n,f=Math.ceil(o/i);if(o>65535||f>255)throw Error("expand_message_xmd: invalid lenInBytes");let u=(0,r.concatBytes)(t,s(t.length,1)),d=s(0,l),c=s(o,2),h=Array(f),p=n((0,r.concatBytes)(d,e,c,s(0,1),u));h[0]=n((0,r.concatBytes)(p,s(1,1),u));for(let e=1;e<=f;e++){let t=[function(e,t){let r=new Uint8Array(e.length);for(let o=0;o<e.length;o++)r[o]=e[o]^t[o];return r}(p,h[e-1]),s(e+1,1),u];h[e]=n((0,r.concatBytes)(...t))}let b=(0,r.concatBytes)(...h);return b.slice(0,o)}function f(e,t,o,n,i){if((0,r.abytes)(e),(0,r.abytes)(t),a(o),t.length>255&&(t=i.create({dkLen:Math.ceil(2*n/8)}).update((0,r.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()),o>65535||t.length>255)throw Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:o}).update(e).update(s(o,2)).update(t).update(s(t.length,1)).digest()}function u(e,t,i){let s;(0,r._validateObject)(i,{p:"bigint",m:"number",k:"number",hash:"function"});let{p:u,k:d,m:c,hash:h,expand:p,DST:b}=i;if(!(0,r.isBytes)(b)&&"string"!=typeof b)throw Error("DST must be string or uint8array");if(!(0,r.isHash)(i.hash))throw Error("expected valid hash");(0,r.abytes)(e),a(t);let x="string"==typeof b?(0,r.utf8ToBytes)(b):b,y=u.toString(2).length,g=Math.ceil((y+d)/8),m=t*c*g;if("xmd"===p)s=l(e,x,m,h);else if("xof"===p)s=f(e,x,m,d,h);else if("_internal_pass"===p)s=e;else throw Error('expand must be "xmd" or "xof"');let w=Array(t);for(let e=0;e<t;e++){let t=Array(c);for(let r=0;r<c;r++){let i=g*(r+e*c),a=s.subarray(i,i+g);t[r]=(0,o.mod)(n(a),u)}w[e]=t}return w}}),i("bHZR1"),globalThis.define=t;