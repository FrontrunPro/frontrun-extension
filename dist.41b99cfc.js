var t,e;"function"==typeof(t=globalThis.define)&&(e=t,t=null),(()=>{function t(t,e,r,o){Object.defineProperty(t,e,{get:r,set:o,enumerable:!0,configurable:!0})}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},o={},n=e.parcelRequiref356;null==n&&((n=function(t){if(t in r)return r[t].exports;if(t in o){var e=o[t];delete o[t];var n={id:t,exports:{}};return r[t]=n,e.call(n.exports,n,n.exports),n.exports}var s=Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(t,e){o[t]=e},e.parcelRequiref356=n),n.register("8BaBP",function(e,r){t(e.exports,"compressRawPublicKey",()=>n("4p8Gk").compressRawPublicKey),t(e.exports,"generateP256KeyPair",()=>n("4p8Gk").generateP256KeyPair),t(e.exports,"getPublicKey",()=>n("4p8Gk").getPublicKey),t(e.exports,"toDerSignature",()=>n("4p8Gk").toDerSignature),t(e.exports,"decryptCredentialBundle",()=>n("ldEGA").decryptCredentialBundle),t(e.exports,"decryptExportBundle",()=>n("ldEGA").decryptExportBundle),t(e.exports,"encryptPrivateKeyToBundle",()=>n("ldEGA").encryptPrivateKeyToBundle),n("4p8Gk"),n("ldEGA")}),n.register("4p8Gk",function(e,r){t(e.exports,"getPublicKey",()=>d),t(e.exports,"hpkeEncrypt",()=>c),t(e.exports,"generateP256KeyPair",()=>y),t(e.exports,"compressRawPublicKey",()=>b),t(e.exports,"formatHpkeBuf",()=>p),t(e.exports,"uncompressRawPublicKey",()=>w),t(e.exports,"hpkeDecrypt",()=>x),t(e.exports,"fromDerSignature",()=>_),t(e.exports,"toDerSignature",()=>I);var o=n("8Nvbl"),s=n("keT8z"),i=n("8gFe1"),a=n("aHqEL"),l=n("51uCW"),u=n("eNzuk"),f=n("4lfnD"),h=n("2yHRv");let d=(t,e=!0)=>(0,o.p256).getPublicKey(t,e),c=({plainTextBuf:t,targetKeyBuf:e})=>{try{let r=y(),o=(0,u.uint8ArrayFromHexString)(r.privateKey),n=(0,u.uint8ArrayFromHexString)(r.publicKeyUncompressed),s=g(n,e),i=A(e,(0,u.uint8ArrayToHexString)(o)),a=H(n,(0,u.uint8ArrayToHexString)(e)),l=E(h.LABEL_EAE_PRK,i,h.SUITE_ID_1),f=m(h.LABEL_SHARED_SECRET,a,h.SUITE_ID_1,32),d=B(new Uint8Array([]),l,f,32);l=E(h.LABEL_SECRET,new Uint8Array([]),h.SUITE_ID_2),f=h.AES_KEY_INFO;let c=B(d,l,f,32);f=h.IV_INFO;let p=B(d,l,f,12),x=S(t,c,p,s),w=b(n),v=new Uint8Array(w.length+x.length);return v.set(w,0),v.set(x,w.length),v}catch(t){throw Error(`Unable to perform hpkeEncrypt: ${t}`)}},p=t=>{let e=t.slice(0,33),r=t.slice(33),o=(0,u.uint8ArrayToHexString)(w(e)),n=(0,u.uint8ArrayToHexString)(r);return JSON.stringify({encappedPublic:o,ciphertext:n})},x=({ciphertextBuf:t,encappedKeyBuf:e,receiverPriv:r})=>{try{let o,n;let s=d((0,u.uint8ArrayFromHexString)(r),!1),i=g(e,s),a=A(e,r),l=H(e,(0,u.uint8ArrayToHexString)(s));o=E(h.LABEL_EAE_PRK,a,h.SUITE_ID_1),n=m(h.LABEL_SHARED_SECRET,l,h.SUITE_ID_1,32);let f=B(new Uint8Array([]),o,n,32);o=E(h.LABEL_SECRET,new Uint8Array([]),h.SUITE_ID_2),n=h.AES_KEY_INFO;let c=B(f,o,n,32);n=h.IV_INFO;let p=B(f,o,n,12),x=v(t,c,p,i);return x}catch(t){throw Error(`Unable to perform hpkeDecrypt: ${t} `)}},y=()=>{let t=(0,l.randomBytes)(32),e=d(t,!0),r=(0,u.uint8ArrayToHexString)(w(e));return{privateKey:(0,u.uint8ArrayToHexString)(t),publicKey:(0,u.uint8ArrayToHexString)(e),publicKeyUncompressed:r}},g=(t,e)=>new Uint8Array([...Array.from(t),...Array.from(e)]),b=t=>{let e=t.byteLength;var r=t.slice(0,1+e>>>1);return r[0]=2|1&t[e-1],r},w=t=>{let e=3===t[0],r=BigInt("0x"+(0,u.uint8ArrayToHexString)(t.subarray(1))),o=BigInt("115792089210356248762697446949407573530086143415290314195533631308867097853951"),n=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b "),s=o-BigInt(3),i=(0,f.modSqrt)(((r*r+s)*r+n)%o,o);if(e!==(0,f.testBit)(i,0)&&(i=(o-i)%o),r<BigInt(0)||r>=o)throw Error("x is out of range");if(i<BigInt(0)||i>=o)throw Error("y is out of range");var a="04"+L(r,64)+L(i,64);return(0,u.uint8ArrayFromHexString)(a)},E=(t,e,r)=>{let o=h.HPKE_VERSION.length+r.length+t.length+e.length,n=new Uint8Array(o),s=0;return n.set(h.HPKE_VERSION,s),s+=h.HPKE_VERSION.length,n.set(r,s),s+=r.length,n.set(t,s),s+=t.length,n.set(e,s),n},m=(t,e,r,o)=>{let n=new Uint8Array(9+r.byteLength+t.byteLength+e.byteLength);return n.set(new Uint8Array([0,o]),0),n.set(h.HPKE_VERSION,2),n.set(r,9),n.set(t,9+r.byteLength),n.set(e,9+r.byteLength+t.byteLength),n},B=(t,e,r,o)=>{let n=s.extract(i.sha256,e,t),a=s.expand(i.sha256,n,r,o);return new Uint8Array(a)},A=(t,e)=>{let r=(0,o.p256).getSharedSecret((0,u.uint8ArrayFromHexString)(e),t);return r.slice(1)},S=(t,e,r,o)=>{let n=(0,a.gcm)(e,r,o),s=n.encrypt(t);return s},v=(t,e,r,o)=>{let n=(0,a.gcm)(e,r,o),s=n.decrypt(t);return s},H=(t,e)=>{let r=new Uint8Array(t),o=(0,u.uint8ArrayFromHexString)(e),n=new Uint8Array(r.length+o.length);return n.set(r),n.set(o,r.length),n},L=(t,e)=>{let r=t.toString(16);if(r.length>e)throw Error(`number cannot fit in a hex string of ${e} characters`);return r.padStart(e,"0")},_=t=>{let e=(0,u.uint8ArrayFromHexString)(t),r=2;if(2!==e[2])throw Error("failed to convert DER-encoded signature: invalid tag for r");r++;let o=e[r];r++;let n=e.slice(r,r+o);if(2!==e[r+=o])throw Error("failed to convert DER-encoded signature: invalid tag for s");r++;let s=e[r];r++;let i=e.slice(r,r+s),a=(0,u.normalizePadding)(n,32),l=(0,u.normalizePadding)(i,32);return new Uint8Array([...a,...l])},I=t=>{let e=(0,u.uint8ArrayFromHexString)(t),r=e.slice(0,32),o=e.slice(32,64),n=t=>{if(void 0===t||0===t.length||void 0===t[0])throw Error("Invalid integer: input is undefined or empty.");let e=128&t[0],r=e?new Uint8Array([0,...t]):t;return new Uint8Array([2,r.length,...r])},s=n(r),i=n(o),a=new Uint8Array([48,s.length+i.length,...s,...i]);return(0,u.uint8ArrayToHexString)(a)}}),n.register("8Nvbl",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.encodeToCurve=t.exports.hashToCurve=t.exports.secp256r1=t.exports.p256=void 0;var r=n("bmgGW"),o=n("8gFe1"),s=n("iWmSL"),i=n("74XDJ"),a=n("3SsMY");let l=(0,s.Field)(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),u=l.create(BigInt("-3")),f=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b");t.exports.p256=(0,r.createCurve)({a:u,b:f,Fp:l,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},o.sha256),t.exports.secp256r1=t.exports.p256;let h=(0,i.mapToCurveSimpleSWU)(l,{A:u,B:f,Z:l.create(BigInt("-10"))}),d=(0,a.createHasher)(t.exports.secp256r1.ProjectivePoint,t=>h(t[0]),{DST:"P256_XMD:SHA-256_SSWU_RO_",encodeDST:"P256_XMD:SHA-256_SSWU_NU_",p:l.ORDER,m:1,k:128,expand:"xmd",hash:o.sha256});t.exports.hashToCurve=d.hashToCurve,t.exports.encodeToCurve=d.encodeToCurve}),n.register("bmgGW",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.createCurve=t.exports.getHash=void 0;var r=n("6LbNt"),o=n("51uCW"),s=n("74XDJ");function i(t){return{hash:t,hmac:(e,...n)=>(0,r.hmac)(t,e,(0,o.concatBytes)(...n)),randomBytes:o.randomBytes}}t.exports.getHash=i,t.exports.createCurve=function(t,e){let r=e=>(0,s.weierstrass)({...t,...i(e)});return Object.freeze({...r(e),create:r})}}),n.register("6LbNt",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.hmac=t.exports.HMAC=void 0;var r=n("7dWcX"),o=n("51uCW");class s extends o.Hash{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,(0,r.hash)(t);let n=(0,o.toBytes)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?t.create().update(n).digest():n);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),i.fill(0)}update(t){return(0,r.exists)(this),this.iHash.update(t),this}digestInto(t){(0,r.exists)(this),(0,r.bytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:r,finished:o,destroyed:n,blockLen:s,outputLen:i}=this;return t.finished=o,t.destroyed=n,t.blockLen=s,t.outputLen=i,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}t.exports.HMAC=s,t.exports.hmac=(t,e,r)=>new s(t,e).update(r).digest(),t.exports.hmac.create=(t,e)=>new s(t,e)}),n.register("7dWcX",function(t,e){function r(t){if(!Number.isSafeInteger(t)||t<0)throw Error(`positive integer expected, not ${t}`)}function o(t){if("boolean"!=typeof t)throw Error(`boolean expected, not ${t}`)}function n(t){return t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name}function s(t,...e){if(!n(t))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function i(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.wrapConstructor");r(t.outputLen),r(t.blockLen)}function a(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function l(t,e){s(t);let r=e.outputLen;if(t.length<r)throw Error(`digestInto() expects output buffer of length at least ${r}`)}Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.output=t.exports.exists=t.exports.hash=t.exports.bytes=t.exports.bool=t.exports.number=t.exports.isBytes=void 0,t.exports.number=r,t.exports.bool=o,t.exports.isBytes=n,t.exports.bytes=s,t.exports.hash=i,t.exports.exists=a,t.exports.output=l,t.exports.default={number:r,bool:o,bytes:s,hash:i,exists:a,output:l}}),n.register("51uCW",function(t,e){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.randomBytes=t.exports.wrapXOFConstructorWithOpts=t.exports.wrapConstructorWithOpts=t.exports.wrapConstructor=t.exports.checkOpts=t.exports.Hash=t.exports.concatBytes=t.exports.toBytes=t.exports.utf8ToBytes=t.exports.asyncLoop=t.exports.nextTick=t.exports.hexToBytes=t.exports.bytesToHex=t.exports.byteSwap32=t.exports.byteSwapIfBE=t.exports.byteSwap=t.exports.isLE=t.exports.rotl=t.exports.rotr=t.exports.createView=t.exports.u32=t.exports.u8=t.exports.isBytes=void 0;var r=n("ekpaU"),o=n("7dWcX");t.exports.isBytes=function(t){return t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name},t.exports.u8=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength),t.exports.u32=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),t.exports.createView=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),t.exports.rotr=(t,e)=>t<<32-e|t>>>e,t.exports.rotl=(t,e)=>t<<e|t>>>32-e>>>0,t.exports.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],t.exports.byteSwap=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255,t.exports.byteSwapIfBE=t.exports.isLE?t=>t:e=>(0,t.exports.byteSwap)(e),t.exports.byteSwap32=function(e){for(let r=0;r<e.length;r++)e[r]=(0,t.exports.byteSwap)(e[r])};let s=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));t.exports.bytesToHex=function(t){(0,o.bytes)(t);let e="";for(let r=0;r<t.length;r++)e+=s[t[r]];return e};let i={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function a(t){return t>=i._0&&t<=i._9?t-i._0:t>=i._A&&t<=i._F?t-(i._A-10):t>=i._a&&t<=i._f?t-(i._a-10):void 0}t.exports.hexToBytes=function(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw Error("padded hex string expected, got unpadded hex of length "+e);let o=new Uint8Array(r);for(let e=0,n=0;e<r;e++,n+=2){let r=a(t.charCodeAt(n)),s=a(t.charCodeAt(n+1));if(void 0===r||void 0===s){let e=t[n]+t[n+1];throw Error('hex string expected, got non-hex character "'+e+'" at index '+n)}o[e]=16*r+s}return o};let l=async()=>{};async function u(e,r,o){let n=Date.now();for(let s=0;s<e;s++){o(s);let e=Date.now()-n;e>=0&&e<r||(await (0,t.exports.nextTick)(),n+=e)}}function f(t){if("string"!=typeof t)throw Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function h(t){return"string"==typeof t&&(t=f(t)),(0,o.bytes)(t),t}t.exports.nextTick=l,t.exports.asyncLoop=u,t.exports.utf8ToBytes=f,t.exports.toBytes=h,t.exports.concatBytes=function(...t){let e=0;for(let r=0;r<t.length;r++){let n=t[r];(0,o.bytes)(n),e+=n.length}let r=new Uint8Array(e);for(let e=0,o=0;e<t.length;e++){let n=t[e];r.set(n,o),o+=n.length}return r},t.exports.Hash=class{clone(){return this._cloneInto()}};let d={}.toString;t.exports.checkOpts=function(t,e){if(void 0!==e&&"[object Object]"!==d.call(e))throw Error("Options should be object or undefined");let r=Object.assign(t,e);return r},t.exports.wrapConstructor=function(t){let e=e=>t().update(h(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e},t.exports.wrapConstructorWithOpts=function(t){let e=(e,r)=>t(r).update(h(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e},t.exports.wrapXOFConstructorWithOpts=function(t){let e=(e,r)=>t(r).update(h(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e},t.exports.randomBytes=function(t=32){if(r.crypto&&"function"==typeof r.crypto.getRandomValues)return r.crypto.getRandomValues(new Uint8Array(t));throw Error("crypto.getRandomValues must be defined")}}),n.register("ekpaU",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.crypto=void 0,t.exports.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0}),n.register("74XDJ",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.mapToCurveSimpleSWU=t.exports.SWUFpSqrtRatio=t.exports.weierstrass=t.exports.weierstrassPoints=t.exports.DER=void 0;var r=n("iWmSL"),o=(n("iejs3"),n("iejs3")),s=n("5R9hw");let{bytesToNumberBE:i,hexToBytes:a}=o;t.exports.DER={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:r}=t.exports.DER;if(e.length<2||2!==e[0])throw new r("Invalid signature integer tag");let o=e[1],n=e.subarray(2,o+2);if(!o||n.length!==o)throw new r("Invalid signature integer: wrong length");if(128&n[0])throw new r("Invalid signature integer: negative");if(0===n[0]&&!(128&n[1]))throw new r("Invalid signature integer: unnecessary leading zero");return{d:i(n),l:e.subarray(o+2)}},toSig(e){let{Err:r}=t.exports.DER,n="string"==typeof e?a(e):e;o.abytes(n);let s=n.length;if(s<2||48!=n[0])throw new r("Invalid signature tag");if(n[1]!==s-2)throw new r("Invalid signature: incorrect length");let{d:i,l:l}=t.exports.DER._parseInt(n.subarray(2)),{d:u,l:f}=t.exports.DER._parseInt(l);if(f.length)throw new r("Invalid signature: left bytes after parsing");return{r:i,s:u}},hexFromSig(t){let e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,r=t=>{let e=t.toString(16);return 1&e.length?`0${e}`:e},o=e(r(t.s)),n=e(r(t.r)),s=o.length/2,i=n.length/2,a=r(s),l=r(i);return`30${r(i+s+4)}02${l}${n}02${a}${o}`}};let l=BigInt(0),u=BigInt(1),f=BigInt(2),h=BigInt(3),d=BigInt(4);function c(t){let e=function(t){let e=(0,s.validateBasic)(t);o.validateObject(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:n}=e,i=e.toBytes||((t,e,r)=>{let s=e.toAffine();return o.concatBytes(Uint8Array.from([4]),n.toBytes(s.x),n.toBytes(s.y))}),a=e.fromBytes||(t=>{let e=t.subarray(1),r=n.fromBytes(e.subarray(0,n.BYTES)),o=n.fromBytes(e.subarray(n.BYTES,2*n.BYTES));return{x:r,y:o}});function f(t){let{a:r,b:o}=e,s=n.sqr(t),i=n.mul(s,t);return n.add(n.add(i,n.mul(t,r)),o)}if(!n.eql(n.sqr(e.Gy),f(e.Gx)))throw Error("bad generator point: equation left != right");function d(t){return"bigint"==typeof t&&l<t&&t<e.n}function c(t){if(!d(t))throw Error("Expected valid bigint: 0 < bigint < curve.n")}function p(t){let n;let{allowedPrivateKeyLengths:s,nByteLength:i,wrapPrivateKey:a,n:l}=e;if(s&&"bigint"!=typeof t){if(o.isBytes(t)&&(t=o.bytesToHex(t)),"string"!=typeof t||!s.includes(t.length))throw Error("Invalid key");t=t.padStart(2*i,"0")}try{n="bigint"==typeof t?t:o.bytesToNumberBE((0,o.ensureBytes)("private key",t,i))}catch(e){throw Error(`private key must be ${i} bytes, hex or bigint, not ${typeof t}`)}return a&&(n=r.mod(n,l)),c(n),n}let x=new Map;function y(t){if(!(t instanceof g))throw Error("ProjectivePoint expected")}class g{constructor(t,e,r){if(this.px=t,this.py=e,this.pz=r,null==t||!n.isValid(t))throw Error("x required");if(null==e||!n.isValid(e))throw Error("y required");if(null==r||!n.isValid(r))throw Error("z required")}static fromAffine(t){let{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw Error("invalid affine point");if(t instanceof g)throw Error("projective point not allowed");let o=t=>n.eql(t,n.ZERO);return o(e)&&o(r)?g.ZERO:new g(e,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){let e=n.invertBatch(t.map(t=>t.pz));return t.map((t,r)=>t.toAffine(e[r])).map(g.fromAffine)}static fromHex(t){let e=g.fromAffine(a((0,o.ensureBytes)("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return g.BASE.multiply(p(t))}_setWindowSize(t){this._WINDOW_SIZE=t,x.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw Error("bad point: ZERO")}let{x:t,y:r}=this.toAffine();if(!n.isValid(t)||!n.isValid(r))throw Error("bad point: x or y not FE");let o=n.sqr(r),s=f(t);if(!n.eql(o,s))throw Error("bad point: equation left != right");if(!this.isTorsionFree())throw Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:t}=this.toAffine();if(n.isOdd)return!n.isOdd(t);throw Error("Field doesn't support isOdd")}equals(t){y(t);let{px:e,py:r,pz:o}=this,{px:s,py:i,pz:a}=t,l=n.eql(n.mul(e,a),n.mul(s,o)),u=n.eql(n.mul(r,a),n.mul(i,o));return l&&u}negate(){return new g(this.px,n.neg(this.py),this.pz)}double(){let{a:t,b:r}=e,o=n.mul(r,h),{px:s,py:i,pz:a}=this,l=n.ZERO,u=n.ZERO,f=n.ZERO,d=n.mul(s,s),c=n.mul(i,i),p=n.mul(a,a),x=n.mul(s,i);return x=n.add(x,x),f=n.mul(s,a),f=n.add(f,f),l=n.mul(t,f),u=n.mul(o,p),u=n.add(l,u),l=n.sub(c,u),u=n.add(c,u),u=n.mul(l,u),l=n.mul(x,l),f=n.mul(o,f),p=n.mul(t,p),x=n.sub(d,p),x=n.mul(t,x),x=n.add(x,f),f=n.add(d,d),d=n.add(f,d),d=n.add(d,p),d=n.mul(d,x),u=n.add(u,d),p=n.mul(i,a),p=n.add(p,p),d=n.mul(p,x),l=n.sub(l,d),f=n.mul(p,c),f=n.add(f,f),new g(l,u,f=n.add(f,f))}add(t){y(t);let{px:r,py:o,pz:s}=this,{px:i,py:a,pz:l}=t,u=n.ZERO,f=n.ZERO,d=n.ZERO,c=e.a,p=n.mul(e.b,h),x=n.mul(r,i),b=n.mul(o,a),w=n.mul(s,l),E=n.add(r,o),m=n.add(i,a);E=n.mul(E,m),m=n.add(x,b),E=n.sub(E,m),m=n.add(r,s);let B=n.add(i,l);return m=n.mul(m,B),B=n.add(x,w),m=n.sub(m,B),B=n.add(o,s),u=n.add(a,l),B=n.mul(B,u),u=n.add(b,w),B=n.sub(B,u),d=n.mul(c,m),u=n.mul(p,w),d=n.add(u,d),u=n.sub(b,d),d=n.add(b,d),f=n.mul(u,d),b=n.add(x,x),b=n.add(b,x),w=n.mul(c,w),m=n.mul(p,m),b=n.add(b,w),w=n.sub(x,w),w=n.mul(c,w),m=n.add(m,w),x=n.mul(b,m),f=n.add(f,x),x=n.mul(B,m),u=n.mul(E,u),u=n.sub(u,x),x=n.mul(E,b),d=n.mul(B,d),new g(u,f,d=n.add(d,x))}subtract(t){return this.add(t.negate())}is0(){return this.equals(g.ZERO)}wNAF(t){return w.wNAFCached(this,x,t,t=>{let e=n.invertBatch(t.map(t=>t.pz));return t.map((t,r)=>t.toAffine(e[r])).map(g.fromAffine)})}multiplyUnsafe(t){let r=g.ZERO;if(t===l)return r;if(c(t),t===u)return this;let{endo:o}=e;if(!o)return w.unsafeLadder(this,t);let{k1neg:s,k1:i,k2neg:a,k2:f}=o.splitScalar(t),h=r,d=r,p=this;for(;i>l||f>l;)i&u&&(h=h.add(p)),f&u&&(d=d.add(p)),p=p.double(),i>>=u,f>>=u;return s&&(h=h.negate()),a&&(d=d.negate()),d=new g(n.mul(d.px,o.beta),d.py,d.pz),h.add(d)}multiply(t){let r,o;c(t);let{endo:s}=e;if(s){let{k1neg:e,k1:i,k2neg:a,k2:l}=s.splitScalar(t),{p:u,f:f}=this.wNAF(i),{p:h,f:d}=this.wNAF(l);u=w.constTimeNegate(e,u),h=w.constTimeNegate(a,h),h=new g(n.mul(h.px,s.beta),h.py,h.pz),r=u.add(h),o=f.add(d)}else{let{p:e,f:n}=this.wNAF(t);r=e,o=n}return g.normalizeZ([r,o])[0]}multiplyAndAddUnsafe(t,e,r){let o=g.BASE,n=(t,e)=>e!==l&&e!==u&&t.equals(o)?t.multiply(e):t.multiplyUnsafe(e),s=n(this,e).add(n(t,r));return s.is0()?void 0:s}toAffine(t){let{px:e,py:r,pz:o}=this,s=this.is0();null==t&&(t=s?n.ONE:n.inv(o));let i=n.mul(e,t),a=n.mul(r,t),l=n.mul(o,t);if(s)return{x:n.ZERO,y:n.ZERO};if(!n.eql(l,n.ONE))throw Error("invZ was invalid");return{x:i,y:a}}isTorsionFree(){let{h:t,isTorsionFree:r}=e;if(t===u)return!0;if(r)return r(g,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:t,clearCofactor:r}=e;return t===u?this:r?r(g,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),i(g,this,t)}toHex(t=!0){return o.bytesToHex(this.toRawBytes(t))}}g.BASE=new g(e.Gx,e.Gy,n.ONE),g.ZERO=new g(n.ZERO,n.ONE,n.ZERO);let b=e.nBitLength,w=(0,s.wNAF)(g,e.endo?Math.ceil(b/2):b);return{CURVE:e,ProjectivePoint:g,normPrivateKeyToScalar:p,weierstrassEquation:f,isWithinCurveOrder:d}}function p(t,e){let r=t.ORDER,o=l;for(let t=r-u;t%f===l;t/=f)o+=u;let n=o,s=f<<n-u-u,i=s*f,a=(r-u)/i,c=(a-u)/f,p=i-u,x=t.pow(e,a),y=t.pow(e,(a+u)/f),g=(e,r)=>{let o=x,i=t.pow(r,p),a=t.sqr(i);a=t.mul(a,r);let l=t.mul(e,a);l=t.pow(l,c),l=t.mul(l,i),i=t.mul(l,r),a=t.mul(l,e);let h=t.mul(a,i);l=t.pow(h,s);let d=t.eql(l,t.ONE);i=t.mul(a,y),l=t.mul(h,o),a=t.cmov(i,a,d),h=t.cmov(l,h,d);for(let e=n;e>u;e--){let r=e-f;r=f<<r-u;let n=t.pow(h,r),s=t.eql(n,t.ONE);i=t.mul(a,o),o=t.mul(o,o),n=t.mul(h,o),a=t.cmov(i,a,s),h=t.cmov(n,h,s)}return{isValid:d,value:a}};if(t.ORDER%d===h){let r=(t.ORDER-h)/d,o=t.sqrt(t.neg(e));g=(e,n)=>{let s=t.sqr(n),i=t.mul(e,n);s=t.mul(s,i);let a=t.pow(s,r);a=t.mul(a,i);let l=t.mul(a,o),u=t.mul(t.sqr(a),n),f=t.eql(u,e),h=t.cmov(l,a,f);return{isValid:f,value:h}}}return g}t.exports.weierstrassPoints=c,t.exports.weierstrass=function(e){let n=function(t){let e=(0,s.validateBasic)(t);return o.validateObject(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(e),{Fp:i,n:a}=n,f=i.BYTES+1,h=2*i.BYTES+1;function d(t){return r.mod(t,a)}function p(t){return r.invert(t,a)}let{ProjectivePoint:x,normPrivateKeyToScalar:y,weierstrassEquation:g,isWithinCurveOrder:b}=c({...n,toBytes(t,e,r){let n=e.toAffine(),s=i.toBytes(n.x),a=o.concatBytes;return r?a(Uint8Array.from([e.hasEvenY()?2:3]),s):a(Uint8Array.from([4]),s,i.toBytes(n.y))},fromBytes(t){let e=t.length,r=t[0],n=t.subarray(1);if(e===f&&(2===r||3===r)){let t;let e=o.bytesToNumberBE(n);if(!(l<e&&e<i.ORDER))throw Error("Point is not on curve");let s=g(e);try{t=i.sqrt(s)}catch(e){let t=e instanceof Error?": "+e.message:"";throw Error("Point is not on curve"+t)}let a=(t&u)===u;return(1&r)==1!==a&&(t=i.neg(t)),{x:e,y:t}}if(e===h&&4===r){let t=i.fromBytes(n.subarray(0,i.BYTES)),e=i.fromBytes(n.subarray(i.BYTES,2*i.BYTES));return{x:t,y:e}}throw Error(`Point of length ${e} was invalid. Expected ${f} compressed bytes or ${h} uncompressed bytes`)}}),w=t=>o.bytesToHex(o.numberToBytesBE(t,n.nByteLength));function E(t){let e=a>>u;return t>e}let m=(t,e,r)=>o.bytesToNumberBE(t.slice(e,r));class B{constructor(t,e,r){this.r=t,this.s=e,this.recovery=r,this.assertValidity()}static fromCompact(t){let e=n.nByteLength;return new B(m(t=(0,o.ensureBytes)("compactSignature",t,2*e),0,e),m(t,e,2*e))}static fromDER(e){let{r:r,s:n}=t.exports.DER.toSig((0,o.ensureBytes)("DER",e));return new B(r,n)}assertValidity(){if(!b(this.r))throw Error("r must be 0 < r < CURVE.n");if(!b(this.s))throw Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new B(this.r,this.s,t)}recoverPublicKey(t){let{r:e,s:r,recovery:s}=this,a=v((0,o.ensureBytes)("msgHash",t));if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");let l=2===s||3===s?e+n.n:e;if(l>=i.ORDER)throw Error("recovery id 2 or 3 invalid");let u=(1&s)==0?"02":"03",f=x.fromHex(u+w(l)),h=p(l),c=d(-a*h),y=d(r*h),g=x.BASE.multiplyAndAddUnsafe(f,c,y);if(!g)throw Error("point at infinify");return g.assertValidity(),g}hasHighS(){return E(this.s)}normalizeS(){return this.hasHighS()?new B(this.r,d(-this.s),this.recovery):this}toDERRawBytes(){return o.hexToBytes(this.toDERHex())}toDERHex(){return t.exports.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return o.hexToBytes(this.toCompactHex())}toCompactHex(){return w(this.r)+w(this.s)}}function A(t){let e=o.isBytes(t),r="string"==typeof t,n=(e||r)&&t.length;return e?n===f||n===h:r?n===2*f||n===2*h:t instanceof x}let S=n.bits2int||function(t){let e=o.bytesToNumberBE(t),r=8*t.length-n.nBitLength;return r>0?e>>BigInt(r):e},v=n.bits2int_modN||function(t){return d(S(t))},H=o.bitMask(n.nBitLength);function L(t){if("bigint"!=typeof t)throw Error("bigint expected");if(!(l<=t&&t<H))throw Error(`bigint expected < 2^${n.nBitLength}`);return o.numberToBytesBE(t,n.nByteLength)}let _={lowS:n.lowS,prehash:!1},I={lowS:n.lowS,prehash:!1};return x.BASE._setWindowSize(8),{CURVE:n,getPublicKey:function(t,e=!0){return x.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,r=!0){if(A(t))throw Error("first arg must be private key");if(!A(e))throw Error("second arg must be public key");let o=x.fromHex(e);return o.multiply(y(t)).toRawBytes(r)},sign:function(t,e,r=_){let{seed:s,k2sig:a}=function(t,e,r=_){if(["recovered","canonical"].some(t=>t in r))throw Error("sign() legacy options not supported");let{hash:s,randomBytes:a}=n,{lowS:f,prehash:h,extraEntropy:c}=r;null==f&&(f=!0),t=(0,o.ensureBytes)("msgHash",t),h&&(t=(0,o.ensureBytes)("prehashed msgHash",s(t)));let g=v(t),w=y(e),m=[L(w),L(g)];if(null!=c&&!1!==c){let t=!0===c?a(i.BYTES):c;m.push((0,o.ensureBytes)("extraEntropy",t))}let A=o.concatBytes(...m);return{seed:A,k2sig:function(t){let e=S(t);if(!b(e))return;let r=p(e),o=x.BASE.multiply(e).toAffine(),n=d(o.x);if(n===l)return;let s=d(r*d(g+n*w));if(s===l)return;let i=(o.x===n?0:2)|Number(o.y&u),a=s;return f&&E(s)&&(a=E(s)?d(-s):s,i^=1),new B(n,a,i)}}}(t,e,r),f=o.createHmacDrbg(n.hash.outputLen,n.nByteLength,n.hmac);return f(s,a)},verify:function(e,r,s,i=I){let a,l;if(r=(0,o.ensureBytes)("msgHash",r),s=(0,o.ensureBytes)("publicKey",s),"strict"in i)throw Error("options.strict was renamed to lowS");let{lowS:u,prehash:f}=i;try{if("string"==typeof e||o.isBytes(e))try{l=B.fromDER(e)}catch(r){if(!(r instanceof t.exports.DER.Err))throw r;l=B.fromCompact(e)}else if("object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s){let{r:t,s:r}=e;l=new B(t,r)}else throw Error("PARSE");a=x.fromHex(s)}catch(t){if("PARSE"===t.message)throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&l.hasHighS())return!1;f&&(r=n.hash(r));let{r:h,s:c}=l,y=v(r),g=p(c),b=d(y*g),w=d(h*g),E=x.BASE.multiplyAndAddUnsafe(a,b,w)?.toAffine();if(!E)return!1;let m=d(E.x);return m===h},ProjectivePoint:x,Signature:B,utils:{isValidPrivateKey(t){try{return y(t),!0}catch(t){return!1}},normPrivateKeyToScalar:y,randomPrivateKey:()=>{let t=r.getMinHashLength(n.n);return r.mapHashToField(n.randomBytes(t),n.n)},precompute:(t=8,e=x.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}},t.exports.SWUFpSqrtRatio=p,t.exports.mapToCurveSimpleSWU=function(t,e){if(r.validateField(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let o=p(t,e.Z);if(!t.isOdd)throw Error("Fp.isOdd is not implemented!");return r=>{let n,s,i,a,l,u,f,h;n=t.sqr(r),n=t.mul(n,e.Z),s=t.sqr(n),s=t.add(s,n),i=t.add(s,t.ONE),i=t.mul(i,e.B),a=t.cmov(e.Z,t.neg(s),!t.eql(s,t.ZERO)),a=t.mul(a,e.A),s=t.sqr(i),u=t.sqr(a),l=t.mul(u,e.A),s=t.add(s,l),s=t.mul(s,i),u=t.mul(u,a),l=t.mul(u,e.B),s=t.add(s,l),f=t.mul(n,i);let{isValid:d,value:c}=o(s,u);h=t.mul(n,r),h=t.mul(h,c),f=t.cmov(f,i,d),h=t.cmov(h,c,d);let p=t.isOdd(r)===t.isOdd(h);return h=t.cmov(t.neg(h),h,p),{x:f=t.div(f,a),y:h}}}}),n.register("iWmSL",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.mapHashToField=t.exports.getMinHashLength=t.exports.getFieldBytesLength=t.exports.hashToPrivateScalar=t.exports.FpSqrtEven=t.exports.FpSqrtOdd=t.exports.Field=t.exports.nLength=t.exports.FpIsSquare=t.exports.FpDiv=t.exports.FpInvertBatch=t.exports.FpPow=t.exports.validateField=t.exports.isNegativeLE=t.exports.FpSqrt=t.exports.tonelliShanks=t.exports.invert=t.exports.pow2=t.exports.pow=t.exports.mod=void 0;var r=n("iejs3");let o=BigInt(0),s=BigInt(1),i=BigInt(2),a=BigInt(3),l=BigInt(4),u=BigInt(5),f=BigInt(8);function h(t,e){let r=t%e;return r>=o?r:e+r}function d(t,e,r){if(r<=o||e<o)throw Error("Expected power/modulo > 0");if(r===s)return o;let n=s;for(;e>o;)e&s&&(n=n*t%r),t=t*t%r,e>>=s;return n}function c(t,e){if(t===o||e<=o)throw Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=h(t,e),n=e,i=o,a=s,l=s,u=o;for(;r!==o;){let t=n/r,e=n%r,o=i-l*t,s=a-u*t;n=r,r=e,i=l,a=u,l=o,u=s}let f=n;if(f!==s)throw Error("invert: does not exist");return h(i,e)}function p(t){let e,r,n;let a=(t-s)/i;for(e=t-s,r=0;e%i===o;e/=i,r++);for(n=i;n<t&&d(n,a,t)!==t-s;n++);if(1===r){let e=(t+s)/l;return function(t,r){let o=t.pow(r,e);if(!t.eql(t.sqr(o),r))throw Error("Cannot find square root");return o}}let u=(e+s)/i;return function(t,o){if(t.pow(o,a)===t.neg(t.ONE))throw Error("Cannot find square root");let i=r,l=t.pow(t.mul(t.ONE,n),e),f=t.pow(o,u),h=t.pow(o,e);for(;!t.eql(h,t.ONE);){if(t.eql(h,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(h);e<i&&!t.eql(r,t.ONE);e++)r=t.sqr(r);let r=t.pow(l,s<<BigInt(i-e-1));l=t.sqr(r),f=t.mul(f,r),h=t.mul(h,l),i=e}return f}}function x(t){if(t%l===a){let e=(t+s)/l;return function(t,r){let o=t.pow(r,e);if(!t.eql(t.sqr(o),r))throw Error("Cannot find square root");return o}}if(t%f===u){let e=(t-u)/f;return function(t,r){let o=t.mul(r,i),n=t.pow(o,e),s=t.mul(r,n),a=t.mul(t.mul(s,i),n),l=t.mul(s,t.sub(a,t.ONE));if(!t.eql(t.sqr(l),r))throw Error("Cannot find square root");return l}}return p(t)}BigInt(9),BigInt(16),t.exports.mod=h,t.exports.pow=d,t.exports.pow2=function(t,e,r){let n=t;for(;e-- >o;)n*=n,n%=r;return n},t.exports.invert=c,t.exports.tonelliShanks=p,t.exports.FpSqrt=x,t.exports.isNegativeLE=(t,e)=>(h(t,e)&s)===s;let y=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function g(t,e,r){if(r<o)throw Error("Expected power > 0");if(r===o)return t.ONE;if(r===s)return e;let n=t.ONE,i=e;for(;r>o;)r&s&&(n=t.mul(n,i)),i=t.sqr(i),r>>=s;return n}function b(t,e){let r=Array(e.length),o=e.reduce((e,o,n)=>t.is0(o)?e:(r[n]=e,t.mul(e,o)),t.ONE),n=t.inv(o);return e.reduceRight((e,o,n)=>t.is0(o)?e:(r[n]=t.mul(e,r[n]),t.mul(e,o)),n),r}function w(t,e){let r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function E(t){if("bigint"!=typeof t)throw Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function m(t){let e=E(t);return e+Math.ceil(e/2)}t.exports.validateField=function(t){let e=y.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return(0,r.validateObject)(t,e)},t.exports.FpPow=g,t.exports.FpInvertBatch=b,t.exports.FpDiv=function(t,e,r){return t.mul(e,"bigint"==typeof r?c(r,t.ORDER):t.inv(r))},t.exports.FpIsSquare=function(t){let e=(t.ORDER-s)/i;return r=>{let o=t.pow(r,e);return t.eql(o,t.ZERO)||t.eql(o,t.ONE)}},t.exports.nLength=w,t.exports.Field=function(t,e,n=!1,i={}){if(t<=o)throw Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:a,nByteLength:l}=w(t,e);if(l>2048)throw Error("Field lengths over 2048 bytes are not supported");let u=x(t),f=Object.freeze({ORDER:t,BITS:a,BYTES:l,MASK:(0,r.bitMask)(a),ZERO:o,ONE:s,create:e=>h(e,t),isValid:e=>{if("bigint"!=typeof e)throw Error(`Invalid field element: expected bigint, got ${typeof e}`);return o<=e&&e<t},is0:t=>t===o,isOdd:t=>(t&s)===s,neg:e=>h(-e,t),eql:(t,e)=>t===e,sqr:e=>h(e*e,t),add:(e,r)=>h(e+r,t),sub:(e,r)=>h(e-r,t),mul:(e,r)=>h(e*r,t),pow:(t,e)=>g(f,t,e),div:(e,r)=>h(e*c(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>c(e,t),sqrt:i.sqrt||(t=>u(f,t)),invertBatch:t=>b(f,t),cmov:(t,e,r)=>r?e:t,toBytes:t=>n?(0,r.numberToBytesLE)(t,l):(0,r.numberToBytesBE)(t,l),fromBytes:t=>{if(t.length!==l)throw Error(`Fp.fromBytes: expected ${l}, got ${t.length}`);return n?(0,r.bytesToNumberLE)(t):(0,r.bytesToNumberBE)(t)}});return Object.freeze(f)},t.exports.FpSqrtOdd=function(t,e){if(!t.isOdd)throw Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?r:t.neg(r)},t.exports.FpSqrtEven=function(t,e){if(!t.isOdd)throw Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r},t.exports.hashToPrivateScalar=function(t,e,o=!1){t=(0,r.ensureBytes)("privateHash",t);let n=t.length,i=w(e).nByteLength+8;if(i<24||n<i||n>1024)throw Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let a=o?(0,r.bytesToNumberLE)(t):(0,r.bytesToNumberBE)(t);return h(a,e-s)+s},t.exports.getFieldBytesLength=E,t.exports.getMinHashLength=m,t.exports.mapHashToField=function(t,e,o=!1){let n=t.length,i=E(e),a=m(e);if(n<16||n<a||n>1024)throw Error(`expected ${a}-1024 bytes of input, got ${n}`);let l=o?(0,r.bytesToNumberBE)(t):(0,r.bytesToNumberLE)(t),u=h(l,e-s)+s;return o?(0,r.numberToBytesLE)(u,i):(0,r.numberToBytesBE)(u,i)}}),n.register("iejs3",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.validateObject=t.exports.createHmacDrbg=t.exports.bitMask=t.exports.bitSet=t.exports.bitGet=t.exports.bitLen=t.exports.utf8ToBytes=t.exports.equalBytes=t.exports.concatBytes=t.exports.ensureBytes=t.exports.numberToVarBytesBE=t.exports.numberToBytesLE=t.exports.numberToBytesBE=t.exports.bytesToNumberLE=t.exports.bytesToNumberBE=t.exports.hexToBytes=t.exports.hexToNumber=t.exports.numberToHexUnpadded=t.exports.bytesToHex=t.exports.abytes=t.exports.isBytes=void 0;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let r=BigInt(0),o=BigInt(1),n=BigInt(2);function s(t){return t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name}function i(t){if(!s(t))throw Error("Uint8Array expected")}t.exports.isBytes=s,t.exports.abytes=i;let a=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function l(t){i(t);let e="";for(let r=0;r<t.length;r++)e+=a[t[r]];return e}function u(t){let e=t.toString(16);return 1&e.length?`0${e}`:e}function f(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}t.exports.bytesToHex=l,t.exports.numberToHexUnpadded=u,t.exports.hexToNumber=f;let h={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function d(t){return t>=h._0&&t<=h._9?t-h._0:t>=h._A&&t<=h._F?t-(h._A-10):t>=h._a&&t<=h._f?t-(h._a-10):void 0}function c(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw Error("padded hex string expected, got unpadded hex of length "+e);let o=new Uint8Array(r);for(let e=0,n=0;e<r;e++,n+=2){let r=d(t.charCodeAt(n)),s=d(t.charCodeAt(n+1));if(void 0===r||void 0===s){let e=t[n]+t[n+1];throw Error('hex string expected, got non-hex character "'+e+'" at index '+n)}o[e]=16*r+s}return o}function p(t,e){return c(t.toString(16).padStart(2*e,"0"))}function x(...t){let e=0;for(let r=0;r<t.length;r++){let o=t[r];i(o),e+=o.length}let r=new Uint8Array(e);for(let e=0,o=0;e<t.length;e++){let n=t[e];r.set(n,o),o+=n.length}return r}t.exports.hexToBytes=c,t.exports.bytesToNumberBE=function(t){return f(l(t))},t.exports.bytesToNumberLE=function(t){return i(t),f(l(Uint8Array.from(t).reverse()))},t.exports.numberToBytesBE=p,t.exports.numberToBytesLE=function(t,e){return p(t,e).reverse()},t.exports.numberToVarBytesBE=function(t){return c(u(t))},t.exports.ensureBytes=function(t,e,r){let o;if("string"==typeof e)try{o=c(e)}catch(r){throw Error(`${t} must be valid hex string, got "${e}". Cause: ${r}`)}else if(s(e))o=Uint8Array.from(e);else throw Error(`${t} must be hex string or Uint8Array`);let n=o.length;if("number"==typeof r&&n!==r)throw Error(`${t} expected ${r} bytes, got ${n}`);return o},t.exports.concatBytes=x,t.exports.equalBytes=function(t,e){if(t.length!==e.length)return!1;let r=0;for(let o=0;o<t.length;o++)r|=t[o]^e[o];return 0===r},t.exports.utf8ToBytes=function(t){if("string"!=typeof t)throw Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))},t.exports.bitLen=function(t){let e;for(e=0;t>r;t>>=o,e+=1);return e},t.exports.bitGet=function(t,e){return t>>BigInt(e)&o},t.exports.bitSet=function(t,e,n){return t|(n?o:r)<<BigInt(e)},t.exports.bitMask=t=>(n<<BigInt(t-1))-o;let y=t=>new Uint8Array(t),g=t=>Uint8Array.from(t);t.exports.createHmacDrbg=function(t,e,r){if("number"!=typeof t||t<2)throw Error("hashLen must be a number");if("number"!=typeof e||e<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let o=y(t),n=y(t),s=0,i=()=>{o.fill(1),n.fill(0),s=0},a=(...t)=>r(n,o,...t),l=(t=y())=>{n=a(g([0]),t),o=a(),0!==t.length&&(n=a(g([1]),t),o=a())},u=()=>{if(s++>=1e3)throw Error("drbg: tried 1000 values");let t=0,r=[];for(;t<e;){o=a();let e=o.slice();r.push(e),t+=o.length}return x(...r)};return(t,e)=>{let r;for(i(),l(t);!(r=e(u()));)l();return i(),r}};let b={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||s(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};t.exports.validateObject=function(t,e,r={}){let o=(e,r,o)=>{let n=b[r];if("function"!=typeof n)throw Error(`Invalid validator "${r}", expected function`);let s=t[e];if((!o||void 0!==s)&&!n(s,t))throw Error(`Invalid param ${String(e)}=${s} (${typeof s}), expected ${r}`)};for(let[t,r]of Object.entries(e))o(t,r,!1);for(let[t,e]of Object.entries(r))o(t,e,!0);return t}}),n.register("5R9hw",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.validateBasic=t.exports.wNAF=void 0;var r=n("iWmSL"),o=n("iejs3");let s=BigInt(0),i=BigInt(1);t.exports.wNAF=function(t,e){let r=(t,e)=>{let r=e.negate();return t?r:e},o=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:r,unsafeLadder(e,r){let o=t.ZERO,n=e;for(;r>s;)r&i&&(o=o.add(n)),n=n.double(),r>>=i;return o},precomputeWindow(t,e){let{windows:r,windowSize:n}=o(e),s=[],i=t,a=i;for(let t=0;t<r;t++){a=i,s.push(a);for(let t=1;t<n;t++)a=a.add(i),s.push(a);i=a.double()}return s},wNAF(e,n,s){let{windows:a,windowSize:l}=o(e),u=t.ZERO,f=t.BASE,h=BigInt(2**e-1),d=2**e,c=BigInt(e);for(let t=0;t<a;t++){let e=t*l,o=Number(s&h);s>>=c,o>l&&(o-=d,s+=i);let a=e+Math.abs(o)-1,p=t%2!=0,x=o<0;0===o?f=f.add(r(p,n[e])):u=u.add(r(x,n[a]))}return{p:u,f:f}},wNAFCached(t,e,r,o){let n=t._WINDOW_SIZE||1,s=e.get(t);return s||(s=this.precomputeWindow(t,n),1!==n&&e.set(t,o(s))),this.wNAF(n,s,r)}}},t.exports.validateBasic=function(t){return(0,r.validateField)(t.Fp),(0,o.validateObject)(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,r.nLength)(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}}),n.register("8gFe1",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.sha224=t.exports.sha256=void 0;var r=n("ia9rZ"),o=n("51uCW");let s=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),i=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),a=new Uint32Array(64);class l extends r.HashMD{constructor(){super(64,32,8,!1),this.A=0|i[0],this.B=0|i[1],this.C=0|i[2],this.D=0|i[3],this.E=0|i[4],this.F=0|i[5],this.G=0|i[6],this.H=0|i[7]}get(){let{A:t,B:e,C:r,D:o,E:n,F:s,G:i,H:a}=this;return[t,e,r,o,n,s,i,a]}set(t,e,r,o,n,s,i,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|o,this.E=0|n,this.F=0|s,this.G=0|i,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)a[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){let e=a[t-15],r=a[t-2],n=(0,o.rotr)(e,7)^(0,o.rotr)(e,18)^e>>>3,s=(0,o.rotr)(r,17)^(0,o.rotr)(r,19)^r>>>10;a[t]=s+a[t-7]+n+a[t-16]|0}let{A:n,B:i,C:l,D:u,E:f,F:h,G:d,H:c}=this;for(let t=0;t<64;t++){let e=(0,o.rotr)(f,6)^(0,o.rotr)(f,11)^(0,o.rotr)(f,25),p=c+e+(0,r.Chi)(f,h,d)+s[t]+a[t]|0,x=(0,o.rotr)(n,2)^(0,o.rotr)(n,13)^(0,o.rotr)(n,22),y=x+(0,r.Maj)(n,i,l)|0;c=d,d=h,h=f,f=u+p|0,u=l,l=i,i=n,n=p+y|0}n=n+this.A|0,i=i+this.B|0,l=l+this.C|0,u=u+this.D|0,f=f+this.E|0,h=h+this.F|0,d=d+this.G|0,c=c+this.H|0,this.set(n,i,l,u,f,h,d,c)}roundClean(){a.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class u extends l{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}t.exports.sha256=(0,o.wrapConstructor)(()=>new l),t.exports.sha224=(0,o.wrapConstructor)(()=>new u)}),n.register("ia9rZ",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.HashMD=t.exports.Maj=t.exports.Chi=void 0;var r=n("7dWcX"),o=n("51uCW");t.exports.Chi=(t,e,r)=>t&e^~t&r,t.exports.Maj=(t,e,r)=>t&e^t&r^e&r;class s extends o.Hash{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,o.createView)(this.buffer)}update(t){(0,r.exists)(this);let{view:e,buffer:n,blockLen:s}=this;t=(0,o.toBytes)(t);let i=t.length;for(let r=0;r<i;){let a=Math.min(s-this.pos,i-r);if(a===s){let e=(0,o.createView)(t);for(;s<=i-r;r+=s)this.process(e,r);continue}n.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,r.exists)(this),(0,r.output)(t,this),this.finished=!0;let{buffer:e,view:n,blockLen:s,isLE:i}=this,{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>s-a&&(this.process(n,0),a=0);for(let t=a;t<s;t++)e[t]=0;(function(t,e,r,o){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,o);let n=BigInt(32),s=BigInt(4294967295),i=Number(r>>n&s),a=Number(r&s),l=o?4:0,u=o?0:4;t.setUint32(e+l,i,o),t.setUint32(e+u,a,o)})(n,s-8,BigInt(8*this.length),i),this.process(n,0);let l=(0,o.createView)(t),u=this.outputLen;if(u%4)throw Error("_sha2: outputLen should be aligned to 32bit");let f=u/4,h=this.get();if(f>h.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<f;t++)l.setUint32(4*t,h[t],i)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:r,length:o,finished:n,destroyed:s,pos:i}=this;return t.length=o,t.pos=i,t.finished=n,t.destroyed=s,o%e&&t.buffer.set(r),t}}t.exports.HashMD=s}),n.register("3SsMY",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.createHasher=t.exports.isogenyMap=t.exports.hash_to_field=t.exports.expand_message_xof=t.exports.expand_message_xmd=void 0;var r=n("iWmSL"),o=n("iejs3");let s=o.bytesToNumberBE;function i(t,e){if(t<0||t>=1<<8*e)throw Error(`bad I2OSP call: value=${t} length=${e}`);let r=Array.from({length:e}).fill(0);for(let o=e-1;o>=0;o--)r[o]=255&t,t>>>=8;return new Uint8Array(r)}function a(t){if(!Number.isSafeInteger(t))throw Error("number expected")}function l(t,e,r,n){(0,o.abytes)(t),(0,o.abytes)(e),a(r),e.length>255&&(e=n((0,o.concatBytes)((0,o.utf8ToBytes)("H2C-OVERSIZE-DST-"),e)));let{outputLen:s,blockLen:l}=n,u=Math.ceil(r/s);if(u>255)throw Error("Invalid xmd length");let f=(0,o.concatBytes)(e,i(e.length,1)),h=i(0,l),d=i(r,2),c=Array(u),p=n((0,o.concatBytes)(h,t,d,i(0,1),f));c[0]=n((0,o.concatBytes)(p,i(1,1),f));for(let t=1;t<=u;t++){let e=[function(t,e){let r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t[o]^e[o];return r}(p,c[t-1]),i(t+1,1),f];c[t]=n((0,o.concatBytes)(...e))}let x=(0,o.concatBytes)(...c);return x.slice(0,r)}function u(t,e,r,n,s){if((0,o.abytes)(t),(0,o.abytes)(e),a(r),e.length>255&&(e=s.create({dkLen:Math.ceil(2*n/8)}).update((0,o.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(e).digest()),r>65535||e.length>255)throw Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:r}).update(t).update(i(r,2)).update(e).update(i(e.length,1)).digest()}function f(t,e,n){let i;(0,o.validateObject)(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:f,k:h,m:d,hash:c,expand:p,DST:x}=n;(0,o.abytes)(t),a(e);let y="string"==typeof x?(0,o.utf8ToBytes)(x):x,g=f.toString(2).length,b=Math.ceil((g+h)/8),w=e*d*b;if("xmd"===p)i=l(t,y,w,c);else if("xof"===p)i=u(t,y,w,h,c);else if("_internal_pass"===p)i=t;else throw Error('expand must be "xmd" or "xof"');let E=Array(e);for(let t=0;t<e;t++){let e=Array(d);for(let o=0;o<d;o++){let n=b*(o+t*d),a=i.subarray(n,n+b);e[o]=(0,r.mod)(s(a),f)}E[t]=e}return E}t.exports.expand_message_xmd=l,t.exports.expand_message_xof=u,t.exports.hash_to_field=f,t.exports.isogenyMap=function(t,e){let r=e.map(t=>Array.from(t).reverse());return(e,o)=>{let[n,s,i,a]=r.map(r=>r.reduce((r,o)=>t.add(t.mul(r,e),o)));return e=t.div(n,s),o=t.mul(o,t.div(i,a)),{x:e,y:o}}},t.exports.createHasher=function(t,e,r){if("function"!=typeof e)throw Error("mapToCurve() must be defined");return{hashToCurve(o,n){let s=f(o,2,{...r,DST:r.DST,...n}),i=t.fromAffine(e(s[0])),a=t.fromAffine(e(s[1])),l=i.add(a).clearCofactor();return l.assertValidity(),l},encodeToCurve(o,n){let s=f(o,1,{...r,DST:r.encodeDST,...n}),i=t.fromAffine(e(s[0])).clearCofactor();return i.assertValidity(),i}}}}),n.register("keT8z",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.hkdf=t.exports.expand=t.exports.extract=void 0;var r=n("7dWcX"),o=n("51uCW"),s=n("6LbNt");function i(t,e,n){return(0,r.hash)(t),void 0===n&&(n=new Uint8Array(t.outputLen)),(0,s.hmac)(t,(0,o.toBytes)(n),(0,o.toBytes)(e))}t.exports.extract=i;let a=new Uint8Array([0]),l=new Uint8Array;function u(t,e,o,n=32){if((0,r.hash)(t),(0,r.number)(n),n>255*t.outputLen)throw Error("Length should be <= 255*HashLen");let i=Math.ceil(n/t.outputLen);void 0===o&&(o=l);let u=new Uint8Array(i*t.outputLen),f=s.hmac.create(t,e),h=f._cloneInto(),d=new Uint8Array(f.outputLen);for(let e=0;e<i;e++)a[0]=e+1,h.update(0===e?l:d).update(o).update(a).digestInto(d),u.set(d,t.outputLen*e),f._cloneInto(h);return f.destroy(),h.destroy(),d.fill(0),a.fill(0),u.slice(0,n)}t.exports.expand=u,t.exports.hkdf=(t,e,r,o,n)=>u(t,i(t,e,r),o,n)}),n.register("aHqEL",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.unsafe=t.exports.siv=t.exports.gcm=t.exports.cfb=t.exports.cbc=t.exports.ecb=t.exports.ctr=t.exports.expandKeyDecLE=t.exports.expandKeyLE=void 0;var r=n("4D84u"),o=n("8tFdG"),s=n("a2EdZ");let i=new Uint8Array(16);function a(t){return t<<1^283&-(t>>7)}function l(t,e){let r=0;for(;e>0;e>>=1)r^=t&-(1&e),t=a(t);return r}let u=(()=>{let t=new Uint8Array(256);for(let e=0,r=1;e<256;e++,r^=a(r))t[e]=r;let e=new Uint8Array(256);e[0]=99;for(let r=0;r<255;r++){let o=t[255-r];o|=o<<8,e[t[r]]=(o^o>>4^o>>5^o>>6^o>>7^99)&255}return e})(),f=u.map((t,e)=>u.indexOf(e)),h=t=>t<<24|t>>>8,d=t=>t<<8|t>>>24;function c(t,e){if(256!==t.length)throw Error("Wrong sbox length");let r=new Uint32Array(256).map((r,o)=>e(t[o])),o=r.map(d),n=o.map(d),s=n.map(d),i=new Uint32Array(65536),a=new Uint32Array(65536),l=new Uint16Array(65536);for(let e=0;e<256;e++)for(let u=0;u<256;u++){let f=256*e+u;i[f]=r[e]^o[u],a[f]=n[e]^s[u],l[f]=t[e]<<8|t[u]}return{sbox:t,sbox2:l,T0:r,T1:o,T2:n,T3:s,T01:i,T23:a}}let p=c(u,t=>l(t,3)<<24|t<<16|t<<8|l(t,2)),x=c(f,t=>l(t,11)<<24|l(t,13)<<16|l(t,9)<<8|l(t,14)),y=(()=>{let t=new Uint8Array(16);for(let e=0,r=1;e<16;e++,r=a(r))t[e]=r;return t})();function g(t){(0,s.bytes)(t);let e=t.length;if(![16,24,32].includes(e))throw Error(`aes: wrong key size: should be 16, 24 or 32, got: ${e}`);let{sbox2:o}=p,n=(0,r.u32)(t),i=n.length,a=t=>E(o,t,t,t,t),l=new Uint32Array(e+28);l.set(n);for(let t=i;t<l.length;t++){let e=l[t-1];t%i==0?e=a(h(e))^y[t/i-1]:i>6&&t%i==4&&(e=a(e)),l[t]=l[t-i]^e}return l}function b(t){let e=g(t),r=e.slice(),o=e.length,{sbox2:n}=p,{T0:s,T1:i,T2:a,T3:l}=x;for(let t=0;t<o;t+=4)for(let n=0;n<4;n++)r[t+n]=e[o-t-4+n];e.fill(0);for(let t=4;t<o-4;t++){let e=r[t],o=E(n,e,e,e,e);r[t]=s[255&o]^i[o>>>8&255]^a[o>>>16&255]^l[o>>>24]}return r}function w(t,e,r,o,n,s){return t[r<<8&65280|o>>>8&255]^e[n>>>8&65280|s>>>24&255]}function E(t,e,r,o,n){return t[255&e|65280&r]|t[o>>>16&255|n>>>16&65280]<<16}function m(t,e,r,o,n){let{sbox2:s,T01:i,T23:a}=p,l=0;e^=t[l++],r^=t[l++],o^=t[l++],n^=t[l++];let u=t.length/4-2;for(let s=0;s<u;s++){let s=t[l++]^w(i,a,e,r,o,n),u=t[l++]^w(i,a,r,o,n,e),f=t[l++]^w(i,a,o,n,e,r),h=t[l++]^w(i,a,n,e,r,o);e=s,r=u,o=f,n=h}let f=t[l++]^E(s,e,r,o,n),h=t[l++]^E(s,r,o,n,e),d=t[l++]^E(s,o,n,e,r),c=t[l++]^E(s,n,e,r,o);return{s0:f,s1:h,s2:d,s3:c}}function B(t,e,r,o,n){let{sbox2:s,T01:i,T23:a}=x,l=0;e^=t[l++],r^=t[l++],o^=t[l++],n^=t[l++];let u=t.length/4-2;for(let s=0;s<u;s++){let s=t[l++]^w(i,a,e,n,o,r),u=t[l++]^w(i,a,r,e,n,o),f=t[l++]^w(i,a,o,r,e,n),h=t[l++]^w(i,a,n,o,r,e);e=s,r=u,o=f,n=h}let f=t[l++]^E(s,e,n,o,r),h=t[l++]^E(s,r,e,n,o),d=t[l++]^E(s,o,r,e,n),c=t[l++]^E(s,n,o,r,e);return{s0:f,s1:h,s2:d,s3:c}}function A(t,e){if(!e)return new Uint8Array(t);if((0,s.bytes)(e),e.length<t)throw Error(`aes: wrong destination length, expected at least ${t}, got: ${e.length}`);return e}function S(t,e,o,n){(0,s.bytes)(e,16),(0,s.bytes)(o);let i=o.length;n=A(i,n);let a=(0,r.u32)(e),{s0:l,s1:u,s2:f,s3:h}=m(t,a[0],a[1],a[2],a[3]),d=(0,r.u32)(o),c=(0,r.u32)(n);for(let r=0;r+4<=d.length;r+=4){c[r+0]=d[r+0]^l,c[r+1]=d[r+1]^u,c[r+2]=d[r+2]^f,c[r+3]=d[r+3]^h;let o=1;for(let t=e.length-1;t>=0;t--)o=o+(255&e[t])|0,e[t]=255&o,o>>>=8;({s0:l,s1:u,s2:f,s3:h}=m(t,a[0],a[1],a[2],a[3]))}let p=16*Math.floor(d.length/4);if(p<i){let t=new Uint32Array([l,u,f,h]),e=(0,r.u8)(t);for(let t=p,r=0;t<i;t++,r++)n[t]=o[t]^e[r]}return n}function v(t,e,o,n,i){(0,s.bytes)(o,16),(0,s.bytes)(n),i=A(n.length,i);let a=(0,r.u32)(o),l=(0,r.createView)(o),u=(0,r.u32)(n),f=(0,r.u32)(i),h=e?0:12,d=n.length,c=l.getUint32(h,e),{s0:p,s1:x,s2:y,s3:g}=m(t,a[0],a[1],a[2],a[3]);for(let r=0;r+4<=u.length;r+=4)f[r+0]=u[r+0]^p,f[r+1]=u[r+1]^x,f[r+2]=u[r+2]^y,f[r+3]=u[r+3]^g,c=c+1>>>0,l.setUint32(h,c,e),{s0:p,s1:x,s2:y,s3:g}=m(t,a[0],a[1],a[2],a[3]);let b=16*Math.floor(u.length/4);if(b<d){let t=new Uint32Array([p,x,y,g]),e=(0,r.u8)(t);for(let t=b,r=0;t<d;t++,r++)i[t]=n[t]^e[r]}return i}function H(t){if((0,s.bytes)(t),t.length%16!=0)throw Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")}function L(t,e,o){let n=t.length,s=n%16;if(!e&&0!==s)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");let i=(0,r.u32)(t);if(e){let t=16-s;t||(t=16),n+=t}let a=A(n,o),l=(0,r.u32)(a);return{b:i,o:l,out:a}}function _(t,e){if(!e)return t;let r=t.length;if(!r)throw Error("aes/pcks5: empty ciphertext not allowed");let o=t[r-1];if(o<=0||o>16)throw Error(`aes/pcks5: wrong padding byte: ${o}`);let n=t.subarray(0,-o);for(let e=0;e<o;e++)if(t[r-e-1]!==o)throw Error("aes/pcks5: wrong padding");return n}function I(t){let e=new Uint8Array(16),o=(0,r.u32)(e);e.set(t);let n=16-t.length;for(let t=16-n;t<16;t++)e[t]=n;return o}function U(t,e,o,n,s){let i=t.create(o,n.length+(s?.length||0));s&&i.update(s),i.update(n);let a=new Uint8Array(16),l=(0,r.createView)(a);return s&&(0,r.setBigUint64)(l,0,BigInt(8*s.length),e),(0,r.setBigUint64)(l,8,BigInt(8*n.length),e),i.update(a),i.digest()}t.exports.expandKeyLE=g,t.exports.expandKeyDecLE=b,t.exports.ctr=(0,r.wrapCipher)({blockSize:16,nonceLength:16},function(t,e){function r(r,o){let n=g(t),s=e.slice(),i=S(n,s,r,o);return n.fill(0),s.fill(0),i}return(0,s.bytes)(t),(0,s.bytes)(e,16),{encrypt:(t,e)=>r(t,e),decrypt:(t,e)=>r(t,e)}}),t.exports.ecb=(0,r.wrapCipher)({blockSize:16},function(t,e={}){(0,s.bytes)(t);let o=!e.disablePadding;return{encrypt:(e,r)=>{(0,s.bytes)(e);let{b:n,o:i,out:a}=L(e,o,r),l=g(t),u=0;for(;u+4<=n.length;){let{s0:t,s1:e,s2:r,s3:o}=m(l,n[u+0],n[u+1],n[u+2],n[u+3]);i[u++]=t,i[u++]=e,i[u++]=r,i[u++]=o}if(o){let t=I(e.subarray(4*u)),{s0:r,s1:o,s2:n,s3:s}=m(l,t[0],t[1],t[2],t[3]);i[u++]=r,i[u++]=o,i[u++]=n,i[u++]=s}return l.fill(0),a},decrypt:(e,n)=>{H(e);let s=b(t),i=A(e.length,n),a=(0,r.u32)(e),l=(0,r.u32)(i);for(let t=0;t+4<=a.length;){let{s0:e,s1:r,s2:o,s3:n}=B(s,a[t+0],a[t+1],a[t+2],a[t+3]);l[t++]=e,l[t++]=r,l[t++]=o,l[t++]=n}return s.fill(0),_(i,o)}}}),t.exports.cbc=(0,r.wrapCipher)({blockSize:16,nonceLength:16},function(t,e,o={}){(0,s.bytes)(t),(0,s.bytes)(e,16);let n=!o.disablePadding;return{encrypt:(o,s)=>{let i=g(t),{b:a,o:l,out:u}=L(o,n,s),f=(0,r.u32)(e),h=f[0],d=f[1],c=f[2],p=f[3],x=0;for(;x+4<=a.length;)h^=a[x+0],d^=a[x+1],c^=a[x+2],p^=a[x+3],({s0:h,s1:d,s2:c,s3:p}=m(i,h,d,c,p)),l[x++]=h,l[x++]=d,l[x++]=c,l[x++]=p;if(n){let t=I(o.subarray(4*x));h^=t[0],d^=t[1],c^=t[2],p^=t[3],({s0:h,s1:d,s2:c,s3:p}=m(i,h,d,c,p)),l[x++]=h,l[x++]=d,l[x++]=c,l[x++]=p}return i.fill(0),u},decrypt:(o,s)=>{H(o);let i=b(t),a=(0,r.u32)(e),l=A(o.length,s),u=(0,r.u32)(o),f=(0,r.u32)(l),h=a[0],d=a[1],c=a[2],p=a[3];for(let t=0;t+4<=u.length;){let e=h,r=d,o=c,n=p;h=u[t+0],d=u[t+1],c=u[t+2],p=u[t+3];let{s0:s,s1:a,s2:l,s3:x}=B(i,h,d,c,p);f[t++]=s^e,f[t++]=a^r,f[t++]=l^o,f[t++]=x^n}return i.fill(0),_(l,n)}}}),t.exports.cfb=(0,r.wrapCipher)({blockSize:16,nonceLength:16},function(t,e){function o(o,n,s){let i=g(t),a=o.length;s=A(a,s);let l=(0,r.u32)(o),u=(0,r.u32)(s),f=n?u:l,h=(0,r.u32)(e),d=h[0],c=h[1],p=h[2],x=h[3];for(let t=0;t+4<=l.length;){let{s0:e,s1:r,s2:o,s3:n}=m(i,d,c,p,x);u[t+0]=l[t+0]^e,u[t+1]=l[t+1]^r,u[t+2]=l[t+2]^o,u[t+3]=l[t+3]^n,d=f[t++],c=f[t++],p=f[t++],x=f[t++]}let y=16*Math.floor(l.length/4);if(y<a){({s0:d,s1:c,s2:p,s3:x}=m(i,d,c,p,x));let t=(0,r.u8)(new Uint32Array([d,c,p,x]));for(let e=y,r=0;e<a;e++,r++)s[e]=o[e]^t[r];t.fill(0)}return i.fill(0),s}return(0,s.bytes)(t),(0,s.bytes)(e,16),{encrypt:(t,e)=>o(t,!0,e),decrypt:(t,e)=>o(t,!1,e)}}),t.exports.gcm=(0,r.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16},function(t,e,n){if((0,s.bytes)(e),0===e.length)throw Error("aes/gcm: empty nonce");function a(t,e,r){let s=U(o.ghash,!1,t,r,n);for(let t=0;t<e.length;t++)s[t]^=e[t];return s}function l(){let n=g(t),s=i.slice(),a=i.slice();if(v(n,!1,a,a,s),12===e.length)a.set(e);else{let t=i.slice(),n=(0,r.createView)(t);(0,r.setBigUint64)(n,8,BigInt(8*e.length),!1),o.ghash.create(s).update(e).update(t).digestInto(a)}let l=v(n,!1,a,i);return{xk:n,authKey:s,counter:a,tagMask:l}}return{encrypt:t=>{(0,s.bytes)(t);let{xk:e,authKey:r,counter:o,tagMask:n}=l(),i=new Uint8Array(t.length+16);v(e,!1,o,t,i);let u=a(r,n,i.subarray(0,i.length-16));return i.set(u,t.length),e.fill(0),i},decrypt:t=>{if((0,s.bytes)(t),t.length<16)throw Error("aes/gcm: ciphertext less than tagLen (16)");let{xk:e,authKey:o,counter:n,tagMask:i}=l(),u=t.subarray(0,-16),f=t.subarray(-16),h=a(o,i,u);if(!(0,r.equalBytes)(h,f))throw Error("aes/gcm: invalid ghash tag");let d=v(e,!1,n,u);return o.fill(0),i.fill(0),e.fill(0),d}}});let T=(t,e,r)=>o=>{if(!Number.isSafeInteger(o)||e>o||o>r)throw Error(`${t}: invalid value=${o}, must be [${e}..${r}]`)};function O(t){return null!=t&&"object"==typeof t&&(t instanceof Uint32Array||"Uint32Array"===t.constructor.name)}t.exports.siv=(0,r.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16},function(t,e,n){let i=T("AAD",0,68719476736),a=T("plaintext",0,68719476736),l=T("nonce",12,12),u=T("ciphertext",16,68719476736+16);function f(){let o=t.length;if(16!==o&&24!==o&&32!==o)throw Error(`key length must be 16, 24 or 32 bytes, got: ${o} bytes`);let n=g(t),s=new Uint8Array(o),i=new Uint8Array(16),a=(0,r.u32)(e),l=0,u=a[0],f=a[1],h=a[2],d=0;for(let t of[i,s].map(r.u32)){let e=(0,r.u32)(t);for(let t=0;t<e.length;t+=2){let{s0:r,s1:o}=m(n,l,u,f,h);e[t+0]=r,e[t+1]=o,l=++d}}return n.fill(0),{authKey:i,encKey:g(s)}}function h(t,s,i){let a=U(o.polyval,!0,s,i,n);for(let t=0;t<12;t++)a[t]^=e[t];a[15]&=127;let l=(0,r.u32)(a),u=l[0],f=l[1],h=l[2],d=l[3];return{s0:u,s1:f,s2:h,s3:d}=m(t,u,f,h,d),l[0]=u,l[1]=f,l[2]=h,l[3]=d,a}function d(t,e,r){let o=e.slice();return o[15]|=128,v(t,!0,o,r)}return(0,s.bytes)(e),l(e.length),n&&((0,s.bytes)(n),i(n.length)),{encrypt:t=>{(0,s.bytes)(t),a(t.length);let{encKey:e,authKey:r}=f(),o=h(e,r,t),n=new Uint8Array(t.length+16);return n.set(o,t.length),n.set(d(e,o,t)),e.fill(0),r.fill(0),n},decrypt:t=>{(0,s.bytes)(t),u(t.length);let e=t.subarray(-16),{encKey:o,authKey:n}=f(),i=d(o,e,t.subarray(0,-16)),a=h(o,n,i);if(o.fill(0),n.fill(0),!(0,r.equalBytes)(e,a))throw Error("invalid polyval tag");return i}}}),t.exports.unsafe={expandKeyLE:g,expandKeyDecLE:b,encrypt:m,decrypt:B,encryptBlock:function(t,e){if((0,s.bytes)(e,16),!O(t))throw Error("_encryptBlock accepts result of expandKeyLE");let o=(0,r.u32)(e),{s0:n,s1:i,s2:a,s3:l}=m(t,o[0],o[1],o[2],o[3]);return o[0]=n,o[1]=i,o[2]=a,o[3]=l,e},decryptBlock:function(t,e){if((0,s.bytes)(e,16),!O(t))throw Error("_decryptBlock accepts result of expandKeyLE");let o=(0,r.u32)(e),{s0:n,s1:i,s2:a,s3:l}=B(t,o[0],o[1],o[2],o[3]);return o[0]=n,o[1]=i,o[2]=a,o[3]=l,e},ctrCounter:S,ctr32:v}}),n.register("4D84u",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.u64Lengths=t.exports.setBigUint64=t.exports.wrapCipher=t.exports.Hash=t.exports.equalBytes=t.exports.checkOpts=t.exports.concatBytes=t.exports.toBytes=t.exports.bytesToUtf8=t.exports.utf8ToBytes=t.exports.asyncLoop=t.exports.nextTick=t.exports.numberToBytesBE=t.exports.bytesToNumberBE=t.exports.hexToNumber=t.exports.hexToBytes=t.exports.bytesToHex=t.exports.isLE=t.exports.createView=t.exports.u32=t.exports.u16=t.exports.u8=void 0;var r=n("a2EdZ");if(t.exports.u8=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength),t.exports.u16=t=>new Uint16Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/2)),t.exports.u32=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),t.exports.createView=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),t.exports.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!t.exports.isLE)throw Error("Non little-endian hardware is not supported");let o=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function s(t){(0,r.bytes)(t);let e="";for(let r=0;r<t.length;r++)e+=o[t[r]];return e}t.exports.bytesToHex=s;let i={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function a(t){return t>=i._0&&t<=i._9?t-i._0:t>=i._A&&t<=i._F?t-(i._A-10):t>=i._a&&t<=i._f?t-(i._a-10):void 0}function l(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw Error("padded hex string expected, got unpadded hex of length "+e);let o=new Uint8Array(r);for(let e=0,n=0;e<r;e++,n+=2){let r=a(t.charCodeAt(n)),s=a(t.charCodeAt(n+1));if(void 0===r||void 0===s){let e=t[n]+t[n+1];throw Error('hex string expected, got non-hex character "'+e+'" at index '+n)}o[e]=16*r+s}return o}function u(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}t.exports.hexToBytes=l,t.exports.hexToNumber=u,t.exports.bytesToNumberBE=function(t){return u(s(t))},t.exports.numberToBytesBE=function(t,e){return l(t.toString(16).padStart(2*e,"0"))};let f=async()=>{};async function h(e,r,o){let n=Date.now();for(let s=0;s<e;s++){o(s);let e=Date.now()-n;e>=0&&e<r||(await (0,t.exports.nextTick)(),n+=e)}}function d(t){if("string"!=typeof t)throw Error(`string expected, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function c(t,e,r,o){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,o);let n=BigInt(32),s=BigInt(4294967295),i=Number(r>>n&s),a=Number(r&s),l=o?4:0,u=o?0:4;t.setUint32(e+l,i,o),t.setUint32(e+u,a,o)}t.exports.nextTick=f,t.exports.asyncLoop=h,t.exports.utf8ToBytes=d,t.exports.bytesToUtf8=function(t){return new TextDecoder().decode(t)},t.exports.toBytes=function(t){if("string"==typeof t)t=d(t);else if((0,r.isBytes)(t))t=t.slice();else throw Error(`Uint8Array expected, got ${typeof t}`);return t},t.exports.concatBytes=function(...t){let e=0;for(let o=0;o<t.length;o++){let n=t[o];(0,r.bytes)(n),e+=n.length}let o=new Uint8Array(e);for(let e=0,r=0;e<t.length;e++){let n=t[e];o.set(n,r),r+=n.length}return o},t.exports.checkOpts=function(t,e){if(null==e||"object"!=typeof e)throw Error("options must be defined");let r=Object.assign(t,e);return r},t.exports.equalBytes=function(t,e){if(t.length!==e.length)return!1;let r=0;for(let o=0;o<t.length;o++)r|=t[o]^e[o];return 0===r},t.exports.Hash=class{},t.exports.wrapCipher=(t,e)=>(Object.assign(e,t),e),t.exports.setBigUint64=c,t.exports.u64Lengths=function(e,r){let o=new Uint8Array(16),n=(0,t.exports.createView)(o);return c(n,0,BigInt(r?r.length:0),!0),c(n,8,BigInt(e.length),!0),o}}),n.register("a2EdZ",function(t,e){function r(t){if(!Number.isSafeInteger(t)||t<0)throw Error(`positive integer expected, not ${t}`)}function o(t){if("boolean"!=typeof t)throw Error(`boolean expected, not ${t}`)}function n(t){return t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name}function s(t,...e){if(!n(t))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function i(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("hash must be wrapped by utils.wrapConstructor");r(t.outputLen),r(t.blockLen)}function a(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function l(t,e){s(t);let r=e.outputLen;if(t.length<r)throw Error(`digestInto() expects output buffer of length at least ${r}`)}Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.output=t.exports.exists=t.exports.hash=t.exports.bytes=t.exports.bool=t.exports.number=t.exports.isBytes=void 0,t.exports.number=r,t.exports.bool=o,t.exports.isBytes=n,t.exports.bytes=s,t.exports.hash=i,t.exports.exists=a,t.exports.output=l,t.exports.default={number:r,bool:o,bytes:s,hash:i,exists:a,output:l}}),n.register("8tFdG",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.polyval=t.exports.ghash=t.exports._toGHASHKey=void 0;var r=n("4D84u"),o=n("a2EdZ");let s=new Uint8Array(16),i=(0,r.u32)(s),a=(t,e,r,o)=>({s3:r<<31|o>>>1,s2:e<<31|r>>>1,s1:t<<31|e>>>1,s0:t>>>1^-520093696&-(1&(1&o))}),l=t=>(t>>>0&255)<<24|(t>>>8&255)<<16|(t>>>16&255)<<8|t>>>24&255|0;function u(t){t.reverse();let e=1&t[15],r=0;for(let e=0;e<t.length;e++){let o=t[e];t[e]=o>>>1|r,r=(1&o)<<7}return t[0]^=225&-e,t}t.exports._toGHASHKey=u;let f=t=>t>65536?8:t>1024?4:2;class h{constructor(t,e){this.blockLen=16,this.outputLen=16,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,t=(0,r.toBytes)(t),(0,o.bytes)(t,16);let n=(0,r.createView)(t),s=n.getUint32(0,!1),i=n.getUint32(4,!1),u=n.getUint32(8,!1),h=n.getUint32(12,!1),d=[];for(let t=0;t<128;t++)d.push({s0:l(s),s1:l(i),s2:l(u),s3:l(h)}),{s0:s,s1:i,s2:u,s3:h}=a(s,i,u,h);let c=f(e||1024);if(![1,2,4,8].includes(c))throw Error(`ghash: wrong window size=${c}, should be 2, 4 or 8`);this.W=c;let p=128/c,x=this.windowSize=2**c,y=[];for(let t=0;t<p;t++)for(let e=0;e<x;e++){let r=0,o=0,n=0,s=0;for(let i=0;i<c;i++){let a=e>>>c-i-1&1;if(!a)continue;let{s0:l,s1:u,s2:f,s3:h}=d[c*t+i];r^=l,o^=u,n^=f,s^=h}y.push({s0:r,s1:o,s2:n,s3:s})}this.t=y}_updateBlock(t,e,r,o){t^=this.s0,e^=this.s1,r^=this.s2,o^=this.s3;let{W:n,t:s,windowSize:i}=this,a=0,l=0,u=0,f=0,h=(1<<n)-1,d=0;for(let c of[t,e,r,o])for(let t=0;t<4;t++){let e=c>>>8*t&255;for(let t=8/n-1;t>=0;t--){let r=e>>>n*t&h,{s0:o,s1:c,s2:p,s3:x}=s[d*i+r];a^=o,l^=c,u^=p,f^=x,d+=1}}this.s0=a,this.s1=l,this.s2=u,this.s3=f}update(t){t=(0,r.toBytes)(t),(0,o.exists)(this);let e=(0,r.u32)(t),n=Math.floor(t.length/16),a=t.length%16;for(let t=0;t<n;t++)this._updateBlock(e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]);return a&&(s.set(t.subarray(16*n)),this._updateBlock(i[0],i[1],i[2],i[3]),i.fill(0)),this}destroy(){let{t:t}=this;for(let e of t)e.s0=0,e.s1=0,e.s2=0,e.s3=0}digestInto(t){(0,o.exists)(this),(0,o.output)(t,this),this.finished=!0;let{s0:e,s1:n,s2:s,s3:i}=this,a=(0,r.u32)(t);return a[0]=e,a[1]=n,a[2]=s,a[3]=i,t}digest(){let t=new Uint8Array(16);return this.digestInto(t),this.destroy(),t}}class d extends h{constructor(t,e){t=(0,r.toBytes)(t);let o=u(t.slice());super(o,e),o.fill(0)}update(t){t=(0,r.toBytes)(t),(0,o.exists)(this);let e=(0,r.u32)(t),n=t.length%16,a=Math.floor(t.length/16);for(let t=0;t<a;t++)this._updateBlock(l(e[4*t+3]),l(e[4*t+2]),l(e[4*t+1]),l(e[4*t+0]));return n&&(s.set(t.subarray(16*a)),this._updateBlock(l(i[3]),l(i[2]),l(i[1]),l(i[0])),i.fill(0)),this}digestInto(t){(0,o.exists)(this),(0,o.output)(t,this),this.finished=!0;let{s0:e,s1:n,s2:s,s3:i}=this,a=(0,r.u32)(t);return a[0]=e,a[1]=n,a[2]=s,a[3]=i,t.reverse()}}function c(t){let e=(e,o)=>t(o,e.length).update((0,r.toBytes)(e)).digest(),o=t(new Uint8Array(16),0);return e.outputLen=o.outputLen,e.blockLen=o.blockLen,e.create=(e,r)=>t(e,r),e}t.exports.ghash=c((t,e)=>new h(t,e)),t.exports.polyval=c((t,e)=>new d(t,e))}),n.register("eNzuk",function(e,r){function o(t){let e=function(t){let e;if(0==arguments.length)throw TypeError("1 argument required, but only 0 present.");for(e=0,t=`${t}`;e<t.length;e++)if(t.charCodeAt(e)>255)throw Error(`InvalidCharacterError: found code point greater than 255:${t.charCodeAt(e)} at position ${e}`);let r="";for(e=0;e<t.length;e+=3){let o=[void 0,void 0,void 0,void 0];o[0]=t.charCodeAt(e)>>2,o[1]=(3&t.charCodeAt(e))<<4,t.length>e+1&&(o[1]|=t.charCodeAt(e+1)>>4,o[2]=(15&t.charCodeAt(e+1))<<2),t.length>e+2&&(o[2]|=t.charCodeAt(e+2)>>6,o[3]=63&t.charCodeAt(e+2));for(let t=0;t<o.length;t++)void 0===o[t]?r+="=":r+=function(t){if(t>=0&&t<64)return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t]}(o[t])}return r}(t);return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function n(t){return t.reduce((t,e)=>t+e.toString(16).padStart(2,"0"),"")}t(e.exports,"stringToBase64urlString",()=>o),t(e.exports,"uint8ArrayFromHexString",()=>s),t(e.exports,"uint8ArrayToHexString",()=>n),t(e.exports,"hexToAscii",()=>i),t(e.exports,"normalizePadding",()=>a);let s=(t,e)=>{if(!t||t.length%2!=0||!/^[0-9A-Fa-f]+$/.test(t))throw Error(`cannot create uint8array from invalid hex string: "${t}"`);let r=new Uint8Array(t.match(/../g).map(t=>parseInt(t,16)));if(!e)return r;if(t.length/2>e)throw Error("hex value cannot fit in a buffer of "+e+" byte(s)");let o=new Uint8Array(e);return o.set(r,e-r.length),o};function i(t){let e="";for(let r=0;r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e}let a=(t,e)=>{let r=e-t.length;if(r>0){let e=new Uint8Array(r).fill(0);return new Uint8Array([...e,...t])}if(r<0){let o=-1*r,n=0;for(let e=0;e<o&&e<t.length;e++)0===t[e]&&n++;if(n!==o)throw Error(`invalid number of starting zeroes. Expected number of zeroes: ${o}. Found: ${n}.`);return t.slice(o,o+e)}return t}}),n.register("4lfnD",function(e,r){t(e.exports,"modSqrt",()=>o),t(e.exports,"testBit",()=>n);let o=(t,e)=>{if(e<=BigInt(0))throw Error("p must be positive");let r=t%e;if(n(e,0)&&n(e,1)){let t=e+BigInt(1)>>BigInt(2),o=s(r,t,e);if(o*o%e!==r)throw Error("could not find a modular square root");return o}throw Error("unsupported modulus value")},n=(t,e)=>{let r=BigInt(1)<<BigInt(e);return(t&r)!==BigInt(0)},s=(t,e,r)=>{if(e===BigInt(0))return BigInt(1);let o=t%r,n=e.toString(2);for(let e=1;e<n.length;++e)o=o*o%r,"1"===n[e]&&(o=o*t%r);return o}}),n.register("2yHRv",function(e,r){t(e.exports,"SUITE_ID_1",()=>o),t(e.exports,"SUITE_ID_2",()=>n),t(e.exports,"HPKE_VERSION",()=>s),t(e.exports,"LABEL_SECRET",()=>i),t(e.exports,"LABEL_EAE_PRK",()=>a),t(e.exports,"LABEL_SHARED_SECRET",()=>l),t(e.exports,"AES_KEY_INFO",()=>u),t(e.exports,"IV_INFO",()=>f),t(e.exports,"PRODUCTION_SIGNER_PUBLIC_KEY",()=>h),t(e.exports,"PRODUCTION_NOTARIZER_PUBLIC_KEY",()=>d);let o=new Uint8Array([75,69,77,0,16]),n=new Uint8Array([72,80,75,69,0,16,0,1,0,2]),s=new Uint8Array([72,80,75,69,45,118,49]),i=new Uint8Array([115,101,99,114,101,116]),a=new Uint8Array([101,97,101,95,112,114,107]),l=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]),u=new Uint8Array([0,32,72,80,75,69,45,118,49,72,80,75,69,0,16,0,1,0,2,107,101,121,0,143,195,174,184,50,73,10,75,90,179,228,32,35,40,125,178,154,31,75,199,194,34,192,223,34,135,39,183,10,64,33,18,47,63,4,233,32,108,209,36,19,80,53,41,180,122,198,166,48,185,46,196,207,125,35,69,8,208,175,151,113,201,158,80]),f=new Uint8Array([0,12,72,80,75,69,45,118,49,72,80,75,69,0,16,0,1,0,2,98,97,115,101,95,110,111,110,99,101,0,143,195,174,184,50,73,10,75,90,179,228,32,35,40,125,178,154,31,75,199,194,34,192,223,34,135,39,183,10,64,33,18,47,63,4,233,32,108,209,36,19,80,53,41,180,122,198,166,48,185,46,196,207,125,35,69,8,208,175,151,113,201,158,80]),h="04cf288fe433cc4e1aa0ce1632feac4ea26bf2f5a09dcfe5a42c398e06898710330f0572882f4dbdf0f5304b8fc8703acd69adca9a4bbf7f5d00d20a5e364b2569",d="04d498aa87ac3bf982ac2b5dd9604d0074905cfbda5d62727c5a237b895e6749205e9f7cd566909c4387f6ca25c308445c60884b788560b785f4a96ac33702a469"}),n.register("ldEGA",function(e,r){t(e.exports,"decryptCredentialBundle",()=>d),t(e.exports,"decryptExportBundle",()=>c),t(e.exports,"encryptPrivateKeyToBundle",()=>g);var o=n("5C9lc"),s=n("dIUwn"),i=n("eNzuk"),a=n("2yHRv"),l=n("4p8Gk"),u=n("8Nvbl"),f=n("8LaMc"),h=n("8gFe1");let d=(t,e)=>{try{let r=(o&&o.__esModule?o.default:o).decode(t);if(r.byteLength<=33)throw Error(`Bundle size ${r.byteLength} is too low. Expecting a compressed public key (33 bytes) and an encrypted credential.`);let n=r.slice(0,33),s=r.slice(33),a=(0,l.uncompressRawPublicKey)(n),u=(0,l.hpkeDecrypt)({ciphertextBuf:s,encappedKeyBuf:a,receiverPriv:e});return(0,i.uint8ArrayToHexString)(u)}catch(t){throw Error(`"Error decrypting bundle:", ${t}`)}},c=async({exportBundle:t,embeddedKey:e,organizationId:r,dangerouslyOverrideSignerPublicKey:o,keyFormat:n,returnMnemonic:a})=>{try{let u=JSON.parse(t),h=await p(u.enclaveQuorumPublic,u.dataSignature,u.data,o);if(!h)throw Error(`failed to verify enclave signature: ${u}`);let d=JSON.parse(new TextDecoder().decode((0,i.uint8ArrayFromHexString)(u.data)));if(!d.organizationId||d.organizationId!==r)throw Error(`organization id does not match expected value. Expected: ${r}. Found: ${d.organizationId}.`);if(!d.encappedPublic)throw Error('missing "encappedPublic" in bundle signed data');let c=(0,i.uint8ArrayFromHexString)(d.encappedPublic),x=(0,i.uint8ArrayFromHexString)(d.ciphertext),y=(0,l.hpkeDecrypt)({ciphertextBuf:x,encappedKeyBuf:c,receiverPriv:e});if("SOLANA"===n&&!a){if(32!==y.length)throw Error(`invalid private key length. Expected 32 bytes. Got ${y.length}.`);let t=(0,f.ed25519).getPublicKey(y);if(32!==t.length)throw Error(`invalid public key length. Expected 32 bytes. Got ${t.length}.`);let e=new Uint8Array(64);return e.set(y,0),e.set(t,32),(0,s.default).encode(e)}let g=(0,i.uint8ArrayToHexString)(y);return a?(0,i.hexToAscii)(g):g}catch(t){throw Error(`Error decrypting bundle: ${t}`)}},p=async(t,e,r,o)=>{let n=o||a.PRODUCTION_SIGNER_PUBLIC_KEY;if(t!=n)throw Error(`expected signer key ${o??a.PRODUCTION_SIGNER_PUBLIC_KEY} does not match signer key from bundle: ${t}`);let s=new Uint8Array((0,i.uint8ArrayFromHexString)(t)),f=x(s);if(!f)throw Error("failed to load quorum key");let d=(0,l.fromDerSignature)(e),c=(0,i.uint8ArrayFromHexString)(r),p=(0,h.sha256)(c);return(0,u.p256).verify(d,p,f.toHex())},x=t=>(0,u.p256).ProjectivePoint.fromHex((0,i.uint8ArrayToHexString)(t)),y=(t,e)=>{switch(e){case"SOLANA":let r=(0,s.default).decode(t);if(64!==r.length)throw Error(`invalid key length. Expected 64 bytes. Got ${r.length}.`);return r.subarray(0,32);case"HEXADECIMAL":if(t.startsWith("0x"))return(0,i.uint8ArrayFromHexString)(t.slice(2));return(0,i.uint8ArrayFromHexString)(t);default:if(console.warn(`invalid key format: ${e}. Defaulting to HEXADECIMAL.`),t.startsWith("0x"))return(0,i.uint8ArrayFromHexString)(t.slice(2));return(0,i.uint8ArrayFromHexString)(t)}},g=async({privateKey:t,keyFormat:e,importBundle:r,userId:o,organizationId:n,dangerouslyOverrideSignerPublicKey:s})=>{let a=JSON.parse(r),u=y(t,e),f=await p(a.enclaveQuorumPublic,a.dataSignature,a.data,s);if(!f)throw Error(`failed to verify enclave signature: ${r}`);let h=JSON.parse(new TextDecoder().decode((0,i.uint8ArrayFromHexString)(a.data)));if(!h.organizationId||h.organizationId!==n)throw Error(`organization id does not match expected value. Expected: ${n}. Found: ${h.organizationId}.`);if(!h.userId||h.userId!==o)throw Error(`user id does not match expected value. Expected: ${o}. Found: ${h.userId}.`);if(!h.targetPublic)throw Error('missing "targetPublic" in bundle signed data');let d=(0,i.uint8ArrayFromHexString)(h.targetPublic),c=(0,l.hpkeEncrypt)({plainTextBuf:u,targetKeyBuf:d});return(0,l.formatHpkeBuf)(c)}}),n.register("5C9lc",function(t,e){var r=n("39BN0").sha256,o=n("dwcuq");t.exports=o(function(t){return r(r(t))})}),n.register("39BN0",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.sha224=t.exports.SHA224=t.exports.sha256=t.exports.SHA256=void 0;var r=n("gDMZD");t.exports.SHA256=r.SHA256,t.exports.sha256=r.sha256,t.exports.SHA224=r.SHA224,t.exports.sha224=r.sha224}),n.register("gDMZD",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.sha512_224=t.exports.sha512_256=t.exports.sha384=t.exports.sha512=t.exports.sha224=t.exports.sha256=t.exports.SHA512_256=t.exports.SHA512_224=t.exports.SHA384=t.exports.SHA512=t.exports.SHA224=t.exports.SHA256=void 0;var r=n("cp3fd"),o=n("i02N0"),s=n("bHkZ3");let i=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=new Uint32Array(64);class l extends r.HashMD{constructor(t=32){super(64,t,8,!1),this.A=0|r.SHA256_IV[0],this.B=0|r.SHA256_IV[1],this.C=0|r.SHA256_IV[2],this.D=0|r.SHA256_IV[3],this.E=0|r.SHA256_IV[4],this.F=0|r.SHA256_IV[5],this.G=0|r.SHA256_IV[6],this.H=0|r.SHA256_IV[7]}get(){let{A:t,B:e,C:r,D:o,E:n,F:s,G:i,H:a}=this;return[t,e,r,o,n,s,i,a]}set(t,e,r,o,n,s,i,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|o,this.E=0|n,this.F=0|s,this.G=0|i,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)a[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){let e=a[t-15],r=a[t-2],o=(0,s.rotr)(e,7)^(0,s.rotr)(e,18)^e>>>3,n=(0,s.rotr)(r,17)^(0,s.rotr)(r,19)^r>>>10;a[t]=n+a[t-7]+o+a[t-16]|0}let{A:o,B:n,C:l,D:u,E:f,F:h,G:d,H:c}=this;for(let t=0;t<64;t++){let e=(0,s.rotr)(f,6)^(0,s.rotr)(f,11)^(0,s.rotr)(f,25),p=c+e+(0,r.Chi)(f,h,d)+i[t]+a[t]|0,x=(0,s.rotr)(o,2)^(0,s.rotr)(o,13)^(0,s.rotr)(o,22),y=x+(0,r.Maj)(o,n,l)|0;c=d,d=h,h=f,f=u+p|0,u=l,l=n,n=o,o=p+y|0}o=o+this.A|0,n=n+this.B|0,l=l+this.C|0,u=u+this.D|0,f=f+this.E|0,h=h+this.F|0,d=d+this.G|0,c=c+this.H|0,this.set(o,n,l,u,f,h,d,c)}roundClean(){(0,s.clean)(a)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,s.clean)(this.buffer)}}t.exports.SHA256=l;class u extends l{constructor(){super(28),this.A=0|r.SHA224_IV[0],this.B=0|r.SHA224_IV[1],this.C=0|r.SHA224_IV[2],this.D=0|r.SHA224_IV[3],this.E=0|r.SHA224_IV[4],this.F=0|r.SHA224_IV[5],this.G=0|r.SHA224_IV[6],this.H=0|r.SHA224_IV[7]}}t.exports.SHA224=u;let f=o.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),h=f[0],d=f[1],c=new Uint32Array(80),p=new Uint32Array(80);class x extends r.HashMD{constructor(t=64){super(128,t,16,!1),this.Ah=0|r.SHA512_IV[0],this.Al=0|r.SHA512_IV[1],this.Bh=0|r.SHA512_IV[2],this.Bl=0|r.SHA512_IV[3],this.Ch=0|r.SHA512_IV[4],this.Cl=0|r.SHA512_IV[5],this.Dh=0|r.SHA512_IV[6],this.Dl=0|r.SHA512_IV[7],this.Eh=0|r.SHA512_IV[8],this.El=0|r.SHA512_IV[9],this.Fh=0|r.SHA512_IV[10],this.Fl=0|r.SHA512_IV[11],this.Gh=0|r.SHA512_IV[12],this.Gl=0|r.SHA512_IV[13],this.Hh=0|r.SHA512_IV[14],this.Hl=0|r.SHA512_IV[15]}get(){let{Ah:t,Al:e,Bh:r,Bl:o,Ch:n,Cl:s,Dh:i,Dl:a,Eh:l,El:u,Fh:f,Fl:h,Gh:d,Gl:c,Hh:p,Hl:x}=this;return[t,e,r,o,n,s,i,a,l,u,f,h,d,c,p,x]}set(t,e,r,o,n,s,i,a,l,u,f,h,d,c,p,x){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|o,this.Ch=0|n,this.Cl=0|s,this.Dh=0|i,this.Dl=0|a,this.Eh=0|l,this.El=0|u,this.Fh=0|f,this.Fl=0|h,this.Gh=0|d,this.Gl=0|c,this.Hh=0|p,this.Hl=0|x}process(t,e){for(let r=0;r<16;r++,e+=4)c[r]=t.getUint32(e),p[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){let e=0|c[t-15],r=0|p[t-15],n=o.rotrSH(e,r,1)^o.rotrSH(e,r,8)^o.shrSH(e,r,7),s=o.rotrSL(e,r,1)^o.rotrSL(e,r,8)^o.shrSL(e,r,7),i=0|c[t-2],a=0|p[t-2],l=o.rotrSH(i,a,19)^o.rotrBH(i,a,61)^o.shrSH(i,a,6),u=o.rotrSL(i,a,19)^o.rotrBL(i,a,61)^o.shrSL(i,a,6),f=o.add4L(s,u,p[t-7],p[t-16]),h=o.add4H(f,n,l,c[t-7],c[t-16]);c[t]=0|h,p[t]=0|f}let{Ah:r,Al:n,Bh:s,Bl:i,Ch:a,Cl:l,Dh:u,Dl:f,Eh:x,El:y,Fh:g,Fl:b,Gh:w,Gl:E,Hh:m,Hl:B}=this;for(let t=0;t<80;t++){let e=o.rotrSH(x,y,14)^o.rotrSH(x,y,18)^o.rotrBH(x,y,41),A=o.rotrSL(x,y,14)^o.rotrSL(x,y,18)^o.rotrBL(x,y,41),S=x&g^~x&w,v=y&b^~y&E,H=o.add5L(B,A,v,d[t],p[t]),L=o.add5H(H,m,e,S,h[t],c[t]),_=0|H,I=o.rotrSH(r,n,28)^o.rotrBH(r,n,34)^o.rotrBH(r,n,39),U=o.rotrSL(r,n,28)^o.rotrBL(r,n,34)^o.rotrBL(r,n,39),T=r&s^r&a^s&a,O=n&i^n&l^i&l;m=0|w,B=0|E,w=0|g,E=0|b,g=0|x,b=0|y,({h:x,l:y}=o.add(0|u,0|f,0|L,0|_)),u=0|a,f=0|l,a=0|s,l=0|i,s=0|r,i=0|n;let C=o.add3L(_,U,O);r=o.add3H(C,L,I,T),n=0|C}({h:r,l:n}=o.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:s,l:i}=o.add(0|this.Bh,0|this.Bl,0|s,0|i)),({h:a,l:l}=o.add(0|this.Ch,0|this.Cl,0|a,0|l)),({h:u,l:f}=o.add(0|this.Dh,0|this.Dl,0|u,0|f)),({h:x,l:y}=o.add(0|this.Eh,0|this.El,0|x,0|y)),({h:g,l:b}=o.add(0|this.Fh,0|this.Fl,0|g,0|b)),({h:w,l:E}=o.add(0|this.Gh,0|this.Gl,0|w,0|E)),({h:m,l:B}=o.add(0|this.Hh,0|this.Hl,0|m,0|B)),this.set(r,n,s,i,a,l,u,f,x,y,g,b,w,E,m,B)}roundClean(){(0,s.clean)(c,p)}destroy(){(0,s.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}t.exports.SHA512=x;class y extends x{constructor(){super(48),this.Ah=0|r.SHA384_IV[0],this.Al=0|r.SHA384_IV[1],this.Bh=0|r.SHA384_IV[2],this.Bl=0|r.SHA384_IV[3],this.Ch=0|r.SHA384_IV[4],this.Cl=0|r.SHA384_IV[5],this.Dh=0|r.SHA384_IV[6],this.Dl=0|r.SHA384_IV[7],this.Eh=0|r.SHA384_IV[8],this.El=0|r.SHA384_IV[9],this.Fh=0|r.SHA384_IV[10],this.Fl=0|r.SHA384_IV[11],this.Gh=0|r.SHA384_IV[12],this.Gl=0|r.SHA384_IV[13],this.Hh=0|r.SHA384_IV[14],this.Hl=0|r.SHA384_IV[15]}}t.exports.SHA384=y;let g=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),b=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class w extends x{constructor(){super(28),this.Ah=0|g[0],this.Al=0|g[1],this.Bh=0|g[2],this.Bl=0|g[3],this.Ch=0|g[4],this.Cl=0|g[5],this.Dh=0|g[6],this.Dl=0|g[7],this.Eh=0|g[8],this.El=0|g[9],this.Fh=0|g[10],this.Fl=0|g[11],this.Gh=0|g[12],this.Gl=0|g[13],this.Hh=0|g[14],this.Hl=0|g[15]}}t.exports.SHA512_224=w;class E extends x{constructor(){super(32),this.Ah=0|b[0],this.Al=0|b[1],this.Bh=0|b[2],this.Bl=0|b[3],this.Ch=0|b[4],this.Cl=0|b[5],this.Dh=0|b[6],this.Dl=0|b[7],this.Eh=0|b[8],this.El=0|b[9],this.Fh=0|b[10],this.Fl=0|b[11],this.Gh=0|b[12],this.Gl=0|b[13],this.Hh=0|b[14],this.Hl=0|b[15]}}t.exports.SHA512_256=E,t.exports.sha256=(0,s.createHasher)(()=>new l),t.exports.sha224=(0,s.createHasher)(()=>new u),t.exports.sha512=(0,s.createHasher)(()=>new x),t.exports.sha384=(0,s.createHasher)(()=>new y),t.exports.sha512_256=(0,s.createHasher)(()=>new E),t.exports.sha512_224=(0,s.createHasher)(()=>new w)}),n.register("cp3fd",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.SHA512_IV=t.exports.SHA384_IV=t.exports.SHA224_IV=t.exports.SHA256_IV=t.exports.HashMD=void 0,t.exports.setBigUint64=o,t.exports.Chi=function(t,e,r){return t&e^~t&r},t.exports.Maj=function(t,e,r){return t&e^t&r^e&r};var r=n("bHkZ3");function o(t,e,r,o){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,o);let n=BigInt(32),s=BigInt(4294967295),i=Number(r>>n&s),a=Number(r&s),l=o?4:0,u=o?0:4;t.setUint32(e+l,i,o),t.setUint32(e+u,a,o)}class s extends r.Hash{constructor(t,e,o,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=o,this.isLE=n,this.buffer=new Uint8Array(t),this.view=(0,r.createView)(this.buffer)}update(t){(0,r.aexists)(this),t=(0,r.toBytes)(t),(0,r.abytes)(t);let{view:e,buffer:o,blockLen:n}=this,s=t.length;for(let i=0;i<s;){let a=Math.min(n-this.pos,s-i);if(a===n){let e=(0,r.createView)(t);for(;n<=s-i;i+=n)this.process(e,i);continue}o.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===n&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,r.aexists)(this),(0,r.aoutput)(t,this),this.finished=!0;let{buffer:e,view:n,blockLen:s,isLE:i}=this,{pos:a}=this;e[a++]=128,(0,r.clean)(this.buffer.subarray(a)),this.padOffset>s-a&&(this.process(n,0),a=0);for(let t=a;t<s;t++)e[t]=0;o(n,s-8,BigInt(8*this.length),i),this.process(n,0);let l=(0,r.createView)(t),u=this.outputLen;if(u%4)throw Error("_sha2: outputLen should be aligned to 32bit");let f=u/4,h=this.get();if(f>h.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<f;t++)l.setUint32(4*t,h[t],i)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:r,length:o,finished:n,destroyed:s,pos:i}=this;return t.destroyed=s,t.finished=n,t.length=o,t.pos=i,o%e&&t.buffer.set(r),t}clone(){return this._cloneInto()}}t.exports.HashMD=s,t.exports.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),t.exports.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),t.exports.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),t.exports.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])}),n.register("bHkZ3",function(t,e){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.wrapXOFConstructorWithOpts=t.exports.wrapConstructorWithOpts=t.exports.wrapConstructor=t.exports.Hash=t.exports.nextTick=t.exports.swap32IfBE=t.exports.byteSwapIfBE=t.exports.swap8IfBE=t.exports.isLE=void 0,t.exports.isBytes=o,t.exports.anumber=s,t.exports.abytes=i,t.exports.ahash=function(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.createHasher");s(t.outputLen),s(t.blockLen)},t.exports.aexists=function(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")},t.exports.aoutput=function(t,e){i(t);let r=e.outputLen;if(t.length<r)throw Error("digestInto() expects output buffer of length at least "+r)},t.exports.u8=function(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},t.exports.u32=function(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))},t.exports.clean=function(...t){for(let e=0;e<t.length;e++)t[e].fill(0)},t.exports.createView=function(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)},t.exports.rotr=function(t,e){return t<<32-e|t>>>e},t.exports.rotl=function(t,e){return t<<e|t>>>32-e>>>0},t.exports.byteSwap=a,t.exports.byteSwap32=l,t.exports.bytesToHex=function(t){if(i(t),u)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=f[t[r]];return e},t.exports.hexToBytes=function(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);if(u)return Uint8Array.fromHex(t);let e=t.length,r=e/2;if(e%2)throw Error("hex string expected, got unpadded hex of length "+e);let o=new Uint8Array(r);for(let e=0,n=0;e<r;e++,n+=2){let r=d(t.charCodeAt(n)),s=d(t.charCodeAt(n+1));if(void 0===r||void 0===s){let e=t[n]+t[n+1];throw Error('hex string expected, got non-hex character "'+e+'" at index '+n)}o[e]=16*r+s}return o},t.exports.asyncLoop=p,t.exports.utf8ToBytes=x,t.exports.bytesToUtf8=function(t){return new TextDecoder().decode(t)},t.exports.toBytes=y,t.exports.kdfInputToBytes=function(t){return"string"==typeof t&&(t=x(t)),i(t),t},t.exports.concatBytes=function(...t){let e=0;for(let r=0;r<t.length;r++){let o=t[r];i(o),e+=o.length}let r=new Uint8Array(e);for(let e=0,o=0;e<t.length;e++){let n=t[e];r.set(n,o),o+=n.length}return r},t.exports.checkOpts=function(t,e){if(void 0!==e&&"[object Object]"!==({}).toString.call(e))throw Error("options should be object or undefined");let r=Object.assign(t,e);return r},t.exports.createHasher=g,t.exports.createOptHasher=b,t.exports.createXOFer=w,t.exports.randomBytes=function(t=32){if(r.crypto&&"function"==typeof r.crypto.getRandomValues)return r.crypto.getRandomValues(new Uint8Array(t));if(r.crypto&&"function"==typeof r.crypto.randomBytes)return Uint8Array.from(r.crypto.randomBytes(t));throw Error("crypto.getRandomValues must be defined")};var r=n("aUApy");function o(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function s(t){if(!Number.isSafeInteger(t)||t<0)throw Error("positive integer expected, got "+t)}function i(t,...e){if(!o(t))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error("Uint8Array expected of length "+e+", got length="+t.length)}function a(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function l(t){for(let e=0;e<t.length;e++)t[e]=a(t[e]);return t}t.exports.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],t.exports.swap8IfBE=t.exports.isLE?t=>t:t=>a(t),t.exports.byteSwapIfBE=t.exports.swap8IfBE,t.exports.swap32IfBE=t.exports.isLE?t=>t:l;let u="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,f=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0")),h={_0:48,_9:57,A:65,F:70,a:97,f:102};function d(t){return t>=h._0&&t<=h._9?t-h._0:t>=h.A&&t<=h.F?t-(h.A-10):t>=h.a&&t<=h.f?t-(h.a-10):void 0}let c=async()=>{};async function p(e,r,o){let n=Date.now();for(let s=0;s<e;s++){o(s);let e=Date.now()-n;e>=0&&e<r||(await (0,t.exports.nextTick)(),n+=e)}}function x(t){if("string"!=typeof t)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function y(t){return"string"==typeof t&&(t=x(t)),i(t),t}function g(t){let e=e=>t().update(y(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function b(t){let e=(e,r)=>t(r).update(y(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e}function w(t){let e=(e,r)=>t(r).update(y(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e}t.exports.nextTick=c,t.exports.Hash=class{},t.exports.wrapConstructor=g,t.exports.wrapConstructorWithOpts=b,t.exports.wrapXOFConstructorWithOpts=w}),n.register("aUApy",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.crypto=void 0,t.exports.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0}),n.register("i02N0",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.toBig=t.exports.shrSL=t.exports.shrSH=t.exports.rotrSL=t.exports.rotrSH=t.exports.rotrBL=t.exports.rotrBH=t.exports.rotr32L=t.exports.rotr32H=t.exports.rotlSL=t.exports.rotlSH=t.exports.rotlBL=t.exports.rotlBH=t.exports.add5L=t.exports.add5H=t.exports.add4L=t.exports.add4H=t.exports.add3L=t.exports.add3H=void 0,t.exports.add=w,t.exports.fromBig=n,t.exports.split=s;let r=BigInt(4294967296-1),o=BigInt(32);function n(t,e=!1){return e?{h:Number(t&r),l:Number(t>>o&r)}:{h:0|Number(t>>o&r),l:0|Number(t&r)}}function s(t,e=!1){let r=t.length,o=new Uint32Array(r),s=new Uint32Array(r);for(let i=0;i<r;i++){let{h:r,l:a}=n(t[i],e);[o[i],s[i]]=[r,a]}return[o,s]}let i=(t,e)=>BigInt(t>>>0)<<o|BigInt(e>>>0);t.exports.toBig=i;let a=(t,e,r)=>t>>>r;t.exports.shrSH=a;let l=(t,e,r)=>t<<32-r|e>>>r;t.exports.shrSL=l;let u=(t,e,r)=>t>>>r|e<<32-r;t.exports.rotrSH=u;let f=(t,e,r)=>t<<32-r|e>>>r;t.exports.rotrSL=f;let h=(t,e,r)=>t<<64-r|e>>>r-32;t.exports.rotrBH=h;let d=(t,e,r)=>t>>>r-32|e<<64-r;t.exports.rotrBL=d;let c=(t,e)=>e;t.exports.rotr32H=c;let p=(t,e)=>t;t.exports.rotr32L=p;let x=(t,e,r)=>t<<r|e>>>32-r;t.exports.rotlSH=x;let y=(t,e,r)=>e<<r|t>>>32-r;t.exports.rotlSL=y;let g=(t,e,r)=>e<<r-32|t>>>64-r;t.exports.rotlBH=g;let b=(t,e,r)=>t<<r-32|e>>>64-r;function w(t,e,r,o){let n=(e>>>0)+(o>>>0);return{h:t+r+(n/4294967296|0)|0,l:0|n}}t.exports.rotlBL=b;let E=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0);t.exports.add3L=E;let m=(t,e,r,o)=>e+r+o+(t/4294967296|0)|0;t.exports.add3H=m;let B=(t,e,r,o)=>(t>>>0)+(e>>>0)+(r>>>0)+(o>>>0);t.exports.add4L=B;let A=(t,e,r,o,n)=>e+r+o+n+(t/4294967296|0)|0;t.exports.add4H=A;let S=(t,e,r,o,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(o>>>0)+(n>>>0);t.exports.add5L=S;let v=(t,e,r,o,n,s)=>e+r+o+n+s+(t/4294967296|0)|0;t.exports.add5H=v,t.exports.default={fromBig:n,split:s,toBig:i,shrSH:a,shrSL:l,rotrSH:u,rotrSL:f,rotrBH:h,rotrBL:d,rotr32H:c,rotr32L:p,rotlSH:x,rotlSL:y,rotlBH:g,rotlBL:b,add:w,add3L:E,add3H:m,add4L:B,add4H:A,add5H:v,add5L:S}}),n.register("dwcuq",function(t,e){var r=n("dZqUV");t.exports=function(t){function e(e){var r=e.slice(0,-4),o=e.slice(-4),n=t(r);if(!(o[0]^n[0]|o[1]^n[1]|o[2]^n[2]|o[3]^n[3]))return r}return{encode:function(e){var o=Uint8Array.from(e),n=t(o),s=o.length+4,i=new Uint8Array(s);return i.set(o,0),i.set(n.subarray(0,4),o.length),r.encode(i,s)},decode:function(o){var n=e(r.decode(o),t);if(!n)throw Error("Invalid checksum");return n},decodeUnsafe:function(t){var o=r.decodeUnsafe(t);if(o)return e(o)}}}}),n.register("dZqUV",function(t,e){var r=n("9BKDY");t.exports=r("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")}),n.register("9BKDY",function(t,e){t.exports=function(t){if(t.length>=255)throw TypeError("Alphabet too long");for(var e=new Uint8Array(256),r=0;r<e.length;r++)e[r]=255;for(var o=0;o<t.length;o++){var n=t.charAt(o),s=n.charCodeAt(0);if(255!==e[s])throw TypeError(n+" is ambiguous");e[s]=o}var i=t.length,a=t.charAt(0),l=Math.log(i)/Math.log(256),u=Math.log(256)/Math.log(i);function f(t){if("string"!=typeof t)throw TypeError("Expected String");if(0===t.length)return new Uint8Array;for(var r=0,o=0,n=0;t[r]===a;)o++,r++;for(var s=(t.length-r)*l+1>>>0,u=new Uint8Array(s);t[r];){var f=t.charCodeAt(r);if(f>255)return;var h=e[f];if(255===h)return;for(var d=0,c=s-1;(0!==h||d<n)&&-1!==c;c--,d++)h+=i*u[c]>>>0,u[c]=h%256>>>0,h=h/256>>>0;if(0!==h)throw Error("Non-zero carry");n=d,r++}for(var p=s-n;p!==s&&0===u[p];)p++;for(var x=new Uint8Array(o+(s-p)),y=o;p!==s;)x[y++]=u[p++];return x}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,o=0,n=0,s=e.length;n!==s&&0===e[n];)n++,r++;for(var l=(s-n)*u+1>>>0,f=new Uint8Array(l);n!==s;){for(var h=e[n],d=0,c=l-1;(0!==h||d<o)&&-1!==c;c--,d++)h+=256*f[c]>>>0,f[c]=h%i>>>0,h=h/i>>>0;if(0!==h)throw Error("Non-zero carry");o=d,n++}for(var p=l-o;p!==l&&0===f[p];)p++;for(var x=a.repeat(r);p<l;++p)x+=t.charAt(f[p]);return x},decodeUnsafe:f,decode:function(t){var e=f(t);if(e)return e;throw Error("Non-base"+i+" character")}}}}),n.register("dIUwn",function(e,r){t(e.exports,"default",()=>o);var o=(0,n("c8hvk").default)("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")}),n.register("c8hvk",function(e,r){t(e.exports,"default",()=>o);var o=function(t){if(t.length>=255)throw TypeError("Alphabet too long");let e=new Uint8Array(256);for(let t=0;t<e.length;t++)e[t]=255;for(let r=0;r<t.length;r++){let o=t.charAt(r),n=o.charCodeAt(0);if(255!==e[n])throw TypeError(o+" is ambiguous");e[n]=r}let r=t.length,o=t.charAt(0),n=Math.log(r)/Math.log(256),s=Math.log(256)/Math.log(r);function i(t){if("string"!=typeof t)throw TypeError("Expected String");if(0===t.length)return new Uint8Array;let s=0,i=0,a=0;for(;t[s]===o;)i++,s++;let l=(t.length-s)*n+1>>>0,u=new Uint8Array(l);for(;s<t.length;){let o=t.charCodeAt(s);if(o>255)return;let n=e[o];if(255===n)return;let i=0;for(let t=l-1;(0!==n||i<a)&&-1!==t;t--,i++)n+=r*u[t]>>>0,u[t]=n%256>>>0,n=n/256>>>0;if(0!==n)throw Error("Non-zero carry");a=i,s++}let f=l-a;for(;f!==l&&0===u[f];)f++;let h=new Uint8Array(i+(l-f)),d=i;for(;f!==l;)h[d++]=u[f++];return h}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===e.length)return"";let n=0,i=0,a=0,l=e.length;for(;a!==l&&0===e[a];)a++,n++;let u=(l-a)*s+1>>>0,f=new Uint8Array(u);for(;a!==l;){let t=e[a],o=0;for(let e=u-1;(0!==t||o<i)&&-1!==e;e--,o++)t+=256*f[e]>>>0,f[e]=t%r>>>0,t=t/r>>>0;if(0!==t)throw Error("Non-zero carry");i=o,a++}let h=u-i;for(;h!==u&&0===f[h];)h++;let d=o.repeat(n);for(;h<u;++h)d+=t.charAt(f[h]);return d},decodeUnsafe:i,decode:function(t){let e=i(t);if(e)return e;throw Error("Non-base"+r+" character")}}}}),n.register("8LaMc",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.hash_to_ristretto255=t.exports.hashToRistretto255=t.exports.RistrettoPoint=t.exports.encodeToCurve=t.exports.hashToCurve=t.exports.edwardsToMontgomeryPriv=t.exports.edwardsToMontgomery=t.exports.edwardsToMontgomeryPub=t.exports.x25519=t.exports.ed25519ph=t.exports.ed25519ctx=t.exports.ed25519=t.exports.ED25519_TORSION_SUBGROUP=void 0;var r=n("5w5SP"),o=n("51uCW"),s=n("eNl21"),i=n("bnqQU"),a=n("iWmSL"),l=n("iejs3"),u=n("3SsMY");let f=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),h=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),d=BigInt(0),c=BigInt(1),p=BigInt(2),x=BigInt(5),y=BigInt(10),g=BigInt(20),b=BigInt(40),w=BigInt(80);function E(t){let e=t*t%f,r=e*t%f,o=(0,a.pow2)(r,p,f)*r%f,n=(0,a.pow2)(o,c,f)*t%f,s=(0,a.pow2)(n,x,f)*n%f,i=(0,a.pow2)(s,y,f)*s%f,l=(0,a.pow2)(i,g,f)*i%f,u=(0,a.pow2)(l,b,f)*l%f,h=(0,a.pow2)(u,w,f)*u%f,d=(0,a.pow2)(h,w,f)*u%f,E=(0,a.pow2)(d,y,f)*s%f,m=(0,a.pow2)(E,p,f)*t%f;return{pow_p_5_8:m,b2:r}}function m(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function B(t,e){let r=(0,a.mod)(e*e*e,f),o=(0,a.mod)(r*r*e,f),n=E(t*o).pow_p_5_8,s=(0,a.mod)(t*r*n,f),i=(0,a.mod)(e*s*s,f),l=s,u=(0,a.mod)(s*h,f),d=i===t,c=i===(0,a.mod)(-t,f),p=i===(0,a.mod)(-t*h,f);return d&&(s=l),(c||p)&&(s=u),(0,a.isNegativeLE)(s,f)&&(s=(0,a.mod)(-s,f)),{isValid:d||c,value:s}}t.exports.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];let A=(0,a.Field)(f,void 0,!0),S={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:A,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:r.sha512,randomBytes:o.randomBytes,adjustScalarBytes:m,uvRatio:B};function v(t,e,r){if(e.length>255)throw Error("Context is too big");return(0,o.concatBytes)((0,o.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}function H(e){let{y:r}=t.exports.ed25519.ExtendedPoint.fromHex(e),o=BigInt(1);return A.toBytes(A.create((o+r)*A.inv(o-r)))}t.exports.ed25519=(0,s.twistedEdwards)(S),t.exports.ed25519ctx=(0,s.twistedEdwards)({...S,domain:v}),t.exports.ed25519ph=(0,s.twistedEdwards)({...S,domain:v,prehash:r.sha512}),t.exports.x25519=(0,i.montgomery)({P:f,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{let{pow_p_5_8:e,b2:r}=E(t);return(0,a.mod)((0,a.pow2)(e,BigInt(3),f)*r,f)},adjustScalarBytes:m,randomBytes:o.randomBytes}),t.exports.edwardsToMontgomeryPub=H,t.exports.edwardsToMontgomery=H,t.exports.edwardsToMontgomeryPriv=function(t){let e=S.hash(t.subarray(0,32));return S.adjustScalarBytes(e).subarray(0,32)};let L=(A.ORDER+BigInt(3))/BigInt(8),_=A.pow(p,L),I=A.sqrt(A.neg(A.ONE)),U=(A.ORDER-BigInt(5))/BigInt(8),T=BigInt(486662),O=(0,a.FpSqrtEven)(A,A.neg(BigInt(486664))),C=(0,u.createHasher)(t.exports.ed25519.ExtendedPoint,t=>(function(t){let e,r,o,n,s,i,a,l,u,f,h,d,x,y,g,b,w,E,m,B,S;let{xMn:v,xMd:H,yMn:L,yMd:C}=(e=A.sqr(t),e=A.mul(e,p),r=A.add(e,A.ONE),o=A.neg(T),n=A.sqr(r),s=A.mul(n,r),i=A.mul(e,T),i=A.mul(i,o),i=A.add(i,n),i=A.mul(i,o),a=A.sqr(s),n=A.sqr(a),a=A.mul(a,s),a=A.mul(a,i),n=A.mul(n,a),l=A.pow(n,U),l=A.mul(l,a),u=A.mul(l,I),n=A.sqr(l),n=A.mul(n,s),f=A.eql(n,i),h=A.cmov(u,l,f),d=A.mul(o,e),x=A.mul(l,t),x=A.mul(x,_),y=A.mul(x,I),g=A.mul(i,e),n=A.sqr(x),n=A.mul(n,s),b=A.eql(n,g),w=A.cmov(y,x,b),n=A.sqr(h),n=A.mul(n,s),E=A.eql(n,i),m=A.cmov(d,o,E),B=A.cmov(w,h,E),S=A.isOdd(B),{xMn:m,xMd:r,yMn:B=A.cmov(B,A.neg(B),E!==S),yMd:c}),R=A.mul(v,C);R=A.mul(R,O);let F=A.mul(H,L),D=A.sub(v,H),N=A.add(v,H),P=A.mul(F,N),V=A.eql(P,A.ZERO);R=A.cmov(R,A.ZERO,V),F=A.cmov(F,A.ONE,V),D=A.cmov(D,A.ONE,V),N=A.cmov(N,A.ONE,V);let k=A.invertBatch([F,N]);return{x:A.mul(R,k[0]),y:A.mul(D,k[1])}})(t[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:A.ORDER,m:1,k:128,expand:"xmd",hash:r.sha512});function R(t){if(!(t instanceof j))throw Error("RistrettoPoint expected")}t.exports.hashToCurve=C.hashToCurve,t.exports.encodeToCurve=C.encodeToCurve;let F=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),D=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),N=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),P=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),V=t=>B(c,t),k=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),q=e=>t.exports.ed25519.CURVE.Fp.create((0,l.bytesToNumberLE)(e)&k);function M(e){let{d:r}=t.exports.ed25519.CURVE,o=t.exports.ed25519.CURVE.Fp.ORDER,n=t.exports.ed25519.CURVE.Fp.create,s=n(h*e*e),i=n((s+c)*N),l=BigInt(-1),u=n((l-r*s)*n(s+r)),{isValid:f,value:d}=B(i,u),p=n(d*e);(0,a.isNegativeLE)(p,o)||(p=n(-p)),f||(d=p),f||(l=s);let x=n(l*(s-c)*P-u),y=d*d,g=n((d+d)*u),b=n(x*F),w=n(c-y),E=n(c+y);return new t.exports.ed25519.ExtendedPoint(n(g*E),n(w*b),n(b*E),n(g*w))}class j{constructor(t){this.ep=t}static fromAffine(e){return new j(t.exports.ed25519.ExtendedPoint.fromAffine(e))}static hashToCurve(t){t=(0,l.ensureBytes)("ristrettoHash",t,64);let e=q(t.slice(0,32)),r=M(e),o=q(t.slice(32,64)),n=M(o);return new j(r.add(n))}static fromHex(e){e=(0,l.ensureBytes)("ristrettoHex",e,32);let{a:r,d:o}=t.exports.ed25519.CURVE,n=t.exports.ed25519.CURVE.Fp.ORDER,s=t.exports.ed25519.CURVE.Fp.create,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",u=q(e);if(!(0,l.equalBytes)((0,l.numberToBytesLE)(u,32),e)||(0,a.isNegativeLE)(u,n))throw Error(i);let f=s(u*u),h=s(c+r*f),p=s(c-r*f),x=s(h*h),y=s(p*p),g=s(r*o*x-y),{isValid:b,value:w}=V(s(g*y)),E=s(w*p),m=s(w*E*g),B=s((u+u)*E);(0,a.isNegativeLE)(B,n)&&(B=s(-B));let A=s(h*m),S=s(B*A);if(!b||(0,a.isNegativeLE)(S,n)||A===d)throw Error(i);return new j(new t.exports.ed25519.ExtendedPoint(B,A,c,S))}toRawBytes(){let e,{ex:r,ey:o,ez:n,et:s}=this.ep,i=t.exports.ed25519.CURVE.Fp.ORDER,u=t.exports.ed25519.CURVE.Fp.create,f=u(u(n+o)*u(n-o)),d=u(r*o),c=u(d*d),{value:p}=V(u(f*c)),x=u(p*f),y=u(p*d),g=u(x*y*s);if((0,a.isNegativeLE)(s*g,i)){let t=u(o*h),n=u(r*h);r=t,o=n,e=u(x*D)}else e=y;(0,a.isNegativeLE)(r*g,i)&&(o=u(-o));let b=u((n-o)*e);return(0,a.isNegativeLE)(b,i)&&(b=u(-b)),(0,l.numberToBytesLE)(b,32)}toHex(){return(0,l.bytesToHex)(this.toRawBytes())}toString(){return this.toHex()}equals(e){R(e);let{ex:r,ey:o}=this.ep,{ex:n,ey:s}=e.ep,i=t.exports.ed25519.CURVE.Fp.create,a=i(r*s)===i(o*n),l=i(o*s)===i(r*n);return a||l}add(t){return R(t),new j(this.ep.add(t.ep))}subtract(t){return R(t),new j(this.ep.subtract(t.ep))}multiply(t){return new j(this.ep.multiply(t))}multiplyUnsafe(t){return new j(this.ep.multiplyUnsafe(t))}double(){return new j(this.ep.double())}negate(){return new j(this.ep.negate())}}t.exports.RistrettoPoint=(j.BASE||(j.BASE=new j(t.exports.ed25519.ExtendedPoint.BASE)),j.ZERO||(j.ZERO=new j(t.exports.ed25519.ExtendedPoint.ZERO)),j),t.exports.hashToRistretto255=(t,e)=>{let n=e.DST,s="string"==typeof n?(0,o.utf8ToBytes)(n):n,i=(0,u.expand_message_xmd)(t,s,64,r.sha512),a=j.hashToCurve(i);return a},t.exports.hash_to_ristretto255=t.exports.hashToRistretto255}),n.register("5w5SP",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.sha384=t.exports.sha512_256=t.exports.sha512_224=t.exports.sha512=t.exports.SHA512=void 0;var r=n("ia9rZ"),o=n("dOUio"),s=n("51uCW");let[i,a]=o.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),l=new Uint32Array(80),u=new Uint32Array(80);class f extends r.HashMD{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:e,Bh:r,Bl:o,Ch:n,Cl:s,Dh:i,Dl:a,Eh:l,El:u,Fh:f,Fl:h,Gh:d,Gl:c,Hh:p,Hl:x}=this;return[t,e,r,o,n,s,i,a,l,u,f,h,d,c,p,x]}set(t,e,r,o,n,s,i,a,l,u,f,h,d,c,p,x){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|o,this.Ch=0|n,this.Cl=0|s,this.Dh=0|i,this.Dl=0|a,this.Eh=0|l,this.El=0|u,this.Fh=0|f,this.Fl=0|h,this.Gh=0|d,this.Gl=0|c,this.Hh=0|p,this.Hl=0|x}process(t,e){for(let r=0;r<16;r++,e+=4)l[r]=t.getUint32(e),u[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){let e=0|l[t-15],r=0|u[t-15],n=o.default.rotrSH(e,r,1)^o.default.rotrSH(e,r,8)^o.default.shrSH(e,r,7),s=o.default.rotrSL(e,r,1)^o.default.rotrSL(e,r,8)^o.default.shrSL(e,r,7),i=0|l[t-2],a=0|u[t-2],f=o.default.rotrSH(i,a,19)^o.default.rotrBH(i,a,61)^o.default.shrSH(i,a,6),h=o.default.rotrSL(i,a,19)^o.default.rotrBL(i,a,61)^o.default.shrSL(i,a,6),d=o.default.add4L(s,h,u[t-7],u[t-16]),c=o.default.add4H(d,n,f,l[t-7],l[t-16]);l[t]=0|c,u[t]=0|d}let{Ah:r,Al:n,Bh:s,Bl:f,Ch:h,Cl:d,Dh:c,Dl:p,Eh:x,El:y,Fh:g,Fl:b,Gh:w,Gl:E,Hh:m,Hl:B}=this;for(let t=0;t<80;t++){let e=o.default.rotrSH(x,y,14)^o.default.rotrSH(x,y,18)^o.default.rotrBH(x,y,41),A=o.default.rotrSL(x,y,14)^o.default.rotrSL(x,y,18)^o.default.rotrBL(x,y,41),S=x&g^~x&w,v=y&b^~y&E,H=o.default.add5L(B,A,v,a[t],u[t]),L=o.default.add5H(H,m,e,S,i[t],l[t]),_=0|H,I=o.default.rotrSH(r,n,28)^o.default.rotrBH(r,n,34)^o.default.rotrBH(r,n,39),U=o.default.rotrSL(r,n,28)^o.default.rotrBL(r,n,34)^o.default.rotrBL(r,n,39),T=r&s^r&h^s&h,O=n&f^n&d^f&d;m=0|w,B=0|E,w=0|g,E=0|b,g=0|x,b=0|y,({h:x,l:y}=o.default.add(0|c,0|p,0|L,0|_)),c=0|h,p=0|d,h=0|s,d=0|f,s=0|r,f=0|n;let C=o.default.add3L(_,U,O);r=o.default.add3H(C,L,I,T),n=0|C}({h:r,l:n}=o.default.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:s,l:f}=o.default.add(0|this.Bh,0|this.Bl,0|s,0|f)),({h:h,l:d}=o.default.add(0|this.Ch,0|this.Cl,0|h,0|d)),({h:c,l:p}=o.default.add(0|this.Dh,0|this.Dl,0|c,0|p)),({h:x,l:y}=o.default.add(0|this.Eh,0|this.El,0|x,0|y)),({h:g,l:b}=o.default.add(0|this.Fh,0|this.Fl,0|g,0|b)),({h:w,l:E}=o.default.add(0|this.Gh,0|this.Gl,0|w,0|E)),({h:m,l:B}=o.default.add(0|this.Hh,0|this.Hl,0|m,0|B)),this.set(r,n,s,f,h,d,c,p,x,y,g,b,w,E,m,B)}roundClean(){l.fill(0),u.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}t.exports.SHA512=f;class h extends f{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class d extends f{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class c extends f{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}t.exports.sha512=(0,s.wrapConstructor)(()=>new f),t.exports.sha512_224=(0,s.wrapConstructor)(()=>new h),t.exports.sha512_256=(0,s.wrapConstructor)(()=>new d),t.exports.sha384=(0,s.wrapConstructor)(()=>new c)}),n.register("dOUio",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.add5L=t.exports.add5H=t.exports.add4H=t.exports.add4L=t.exports.add3H=t.exports.add3L=t.exports.add=t.exports.rotlBL=t.exports.rotlBH=t.exports.rotlSL=t.exports.rotlSH=t.exports.rotr32L=t.exports.rotr32H=t.exports.rotrBL=t.exports.rotrBH=t.exports.rotrSL=t.exports.rotrSH=t.exports.shrSL=t.exports.shrSH=t.exports.toBig=t.exports.split=t.exports.fromBig=void 0;let r=BigInt(4294967296-1),o=BigInt(32);function n(t,e=!1){return e?{h:Number(t&r),l:Number(t>>o&r)}:{h:0|Number(t>>o&r),l:0|Number(t&r)}}function s(t,e=!1){let r=new Uint32Array(t.length),o=new Uint32Array(t.length);for(let s=0;s<t.length;s++){let{h:i,l:a}=n(t[s],e);[r[s],o[s]]=[i,a]}return[r,o]}t.exports.fromBig=n,t.exports.split=s;let i=(t,e)=>BigInt(t>>>0)<<o|BigInt(e>>>0);t.exports.toBig=i;let a=(t,e,r)=>t>>>r;t.exports.shrSH=a;let l=(t,e,r)=>t<<32-r|e>>>r;t.exports.shrSL=l;let u=(t,e,r)=>t>>>r|e<<32-r;t.exports.rotrSH=u;let f=(t,e,r)=>t<<32-r|e>>>r;t.exports.rotrSL=f;let h=(t,e,r)=>t<<64-r|e>>>r-32;t.exports.rotrBH=h;let d=(t,e,r)=>t>>>r-32|e<<64-r;t.exports.rotrBL=d;let c=(t,e)=>e;t.exports.rotr32H=c;let p=(t,e)=>t;t.exports.rotr32L=p;let x=(t,e,r)=>t<<r|e>>>32-r;t.exports.rotlSH=x;let y=(t,e,r)=>e<<r|t>>>32-r;t.exports.rotlSL=y;let g=(t,e,r)=>e<<r-32|t>>>64-r;t.exports.rotlBH=g;let b=(t,e,r)=>t<<r-32|e>>>64-r;function w(t,e,r,o){let n=(e>>>0)+(o>>>0);return{h:t+r+(n/4294967296|0)|0,l:0|n}}t.exports.rotlBL=b,t.exports.add=w;let E=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0);t.exports.add3L=E;let m=(t,e,r,o)=>e+r+o+(t/4294967296|0)|0;t.exports.add3H=m;let B=(t,e,r,o)=>(t>>>0)+(e>>>0)+(r>>>0)+(o>>>0);t.exports.add4L=B;let A=(t,e,r,o,n)=>e+r+o+n+(t/4294967296|0)|0;t.exports.add4H=A;let S=(t,e,r,o,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(o>>>0)+(n>>>0);t.exports.add5L=S;let v=(t,e,r,o,n,s)=>e+r+o+n+s+(t/4294967296|0)|0;t.exports.add5H=v,t.exports.default={fromBig:n,split:s,toBig:i,shrSH:a,shrSL:l,rotrSH:u,rotrSL:f,rotrBH:h,rotrBL:d,rotr32H:c,rotr32L:p,rotlSH:x,rotlSL:y,rotlBH:g,rotlBL:b,add:w,add3L:E,add3H:m,add4L:B,add4H:A,add5H:v,add5L:S}}),n.register("eNl21",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.twistedEdwards=void 0;var r=n("iWmSL"),o=(n("iejs3"),n("iejs3")),s=n("5R9hw");let i=BigInt(0),a=BigInt(1),l=BigInt(2),u=BigInt(8),f={zip215:!0};t.exports.twistedEdwards=function(t){let e=function(t){let e=(0,s.validateBasic)(t);return o.validateObject(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:n,n:h,prehash:d,hash:c,randomBytes:p,nByteLength:x,h:y}=e,g=l<<BigInt(8*x)-a,b=n.create,w=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:n.sqrt(t*n.inv(e))}}catch(t){return{isValid:!1,value:i}}}),E=e.adjustScalarBytes||(t=>t),m=e.domain||((t,e,r)=>{if(e.length||r)throw Error("Contexts/pre-hash are not supported");return t}),B=t=>"bigint"==typeof t&&i<t,A=(t,e)=>B(t)&&B(e)&&t<e,S=t=>t===i||A(t,g);function v(t,e){if(A(t,e))return t;throw Error(`Expected valid scalar < ${e}, got ${typeof t} ${t}`)}function H(t){return t===i?t:v(t,h)}let L=new Map;function _(t){if(!(t instanceof I))throw Error("ExtendedPoint expected")}class I{constructor(t,e,r,o){if(this.ex=t,this.ey=e,this.ez=r,this.et=o,!S(t))throw Error("x required");if(!S(e))throw Error("y required");if(!S(r))throw Error("z required");if(!S(o))throw Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof I)throw Error("extended point not allowed");let{x:e,y:r}=t||{};if(!S(e)||!S(r))throw Error("invalid affine point");return new I(e,r,a,b(e*r))}static normalizeZ(t){let e=n.invertBatch(t.map(t=>t.ez));return t.map((t,r)=>t.toAffine(e[r])).map(I.fromAffine)}_setWindowSize(t){this._WINDOW_SIZE=t,L.delete(this)}assertValidity(){let{a:t,d:r}=e;if(this.is0())throw Error("bad point: ZERO");let{ex:o,ey:n,ez:s,et:i}=this,a=b(o*o),l=b(n*n),u=b(s*s),f=b(u*u),h=b(a*t),d=b(u*b(h+l)),c=b(f+b(r*b(a*l)));if(d!==c)throw Error("bad point: equation left != right (1)");let p=b(o*n),x=b(s*i);if(p!==x)throw Error("bad point: equation left != right (2)")}equals(t){_(t);let{ex:e,ey:r,ez:o}=this,{ex:n,ey:s,ez:i}=t,a=b(e*i),l=b(n*o),u=b(r*i),f=b(s*o);return a===l&&u===f}is0(){return this.equals(I.ZERO)}negate(){return new I(b(-this.ex),this.ey,this.ez,b(-this.et))}double(){let{a:t}=e,{ex:r,ey:o,ez:n}=this,s=b(r*r),i=b(o*o),a=b(l*b(n*n)),u=b(t*s),f=r+o,h=b(b(f*f)-s-i),d=u+i,c=d-a,p=u-i,x=b(h*c),y=b(d*p),g=b(h*p),w=b(c*d);return new I(x,y,w,g)}add(t){_(t);let{a:r,d:o}=e,{ex:n,ey:s,ez:a,et:u}=this,{ex:f,ey:h,ez:d,et:c}=t;if(r===BigInt(-1)){let t=b((s-n)*(h+f)),e=b((s+n)*(h-f)),r=b(e-t);if(r===i)return this.double();let o=b(a*l*c),p=b(u*l*d),x=p+o,y=e+t,g=p-o,w=b(x*r),E=b(y*g),m=b(x*g),B=b(r*y);return new I(w,E,B,m)}let p=b(n*f),x=b(s*h),y=b(u*o*c),g=b(a*d),w=b((n+s)*(f+h)-p-x),E=g-y,m=g+y,B=b(x-r*p),A=b(w*E),S=b(m*B),v=b(w*B),H=b(E*m);return new I(A,S,H,v)}subtract(t){return this.add(t.negate())}wNAF(t){return O.wNAFCached(this,L,t,I.normalizeZ)}multiply(t){let{p:e,f:r}=this.wNAF(v(t,h));return I.normalizeZ([e,r])[0]}multiplyUnsafe(t){let e=H(t);return e===i?T:this.equals(T)||e===a?this:this.equals(U)?this.wNAF(e).p:O.unsafeLadder(this,e)}isSmallOrder(){return this.multiplyUnsafe(y).is0()}isTorsionFree(){return O.unsafeLadder(this,h).is0()}toAffine(t){let{ex:e,ey:r,ez:o}=this,s=this.is0();null==t&&(t=s?u:n.inv(o));let l=b(e*t),f=b(r*t),h=b(o*t);if(s)return{x:i,y:a};if(h!==a)throw Error("invZ was invalid");return{x:l,y:f}}clearCofactor(){let{h:t}=e;return t===a?this:this.multiplyUnsafe(t)}static fromHex(t,r=!1){let{d:s,a:l}=e,u=n.BYTES;t=(0,o.ensureBytes)("pointHex",t,u);let f=t.slice(),h=t[u-1];f[u-1]=-129&h;let d=o.bytesToNumberLE(f);d===i||(r?v(d,g):v(d,n.ORDER));let c=b(d*d),p=b(c-a),x=b(s*c-l),{isValid:y,value:E}=w(p,x);if(!y)throw Error("Point.fromHex: invalid y coordinate");let m=(E&a)===a,B=(128&h)!=0;if(!r&&E===i&&B)throw Error("Point.fromHex: x=0 and x_0=1");return B!==m&&(E=b(-E)),I.fromAffine({x:E,y:d})}static fromPrivateKey(t){return F(t).point}toRawBytes(){let{x:t,y:e}=this.toAffine(),r=o.numberToBytesLE(e,n.BYTES);return r[r.length-1]|=t&a?128:0,r}toHex(){return o.bytesToHex(this.toRawBytes())}}I.BASE=new I(e.Gx,e.Gy,a,b(e.Gx*e.Gy)),I.ZERO=new I(i,a,a,i);let{BASE:U,ZERO:T}=I,O=(0,s.wNAF)(I,8*x);function C(t){return(0,r.mod)(t,h)}function R(t){return C(o.bytesToNumberLE(t))}function F(t){t=(0,o.ensureBytes)("private key",t,x);let e=(0,o.ensureBytes)("hashed private key",c(t),2*x),r=E(e.slice(0,x)),n=e.slice(x,2*x),s=R(r),i=U.multiply(s),a=i.toRawBytes();return{head:r,prefix:n,scalar:s,point:i,pointBytes:a}}function D(t=new Uint8Array,...e){let r=o.concatBytes(...e);return R(c(m(r,(0,o.ensureBytes)("context",t),!!d)))}return U._setWindowSize(8),{CURVE:e,getPublicKey:function(t){return F(t).pointBytes},sign:function(t,e,r={}){t=(0,o.ensureBytes)("message",t),d&&(t=d(t));let{prefix:s,scalar:i,pointBytes:a}=F(e),l=D(r.context,s,t),u=U.multiply(l).toRawBytes(),f=D(r.context,u,a,t),h=C(l+f*i);H(h);let c=o.concatBytes(u,o.numberToBytesLE(h,n.BYTES));return(0,o.ensureBytes)("result",c,2*x)},verify:function(t,e,r,s=f){let i,a,l;let{context:u,zip215:h}=s,c=n.BYTES;t=(0,o.ensureBytes)("signature",t,2*c),e=(0,o.ensureBytes)("message",e),d&&(e=d(e));let p=o.bytesToNumberLE(t.slice(c,2*c));try{i=I.fromHex(r,h),a=I.fromHex(t.slice(0,c),h),l=U.multiplyUnsafe(p)}catch(t){return!1}if(!h&&i.isSmallOrder())return!1;let x=D(u,a.toRawBytes(),i.toRawBytes(),e),y=a.add(i.multiplyUnsafe(x));return y.subtract(l).clearCofactor().equals(I.ZERO)},ExtendedPoint:I,utils:{getExtendedPublicKey:F,randomPrivateKey:()=>p(n.BYTES),precompute:(t=8,e=I.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}}),n.register("bnqQU",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.montgomery=void 0;var r=n("iWmSL"),o=n("iejs3");let s=BigInt(0),i=BigInt(1);t.exports.montgomery=function(t){let e=((0,o.validateObject)(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})),{P:n}=e,a=t=>(0,r.mod)(t,n),l=e.montgomeryBits,u=Math.ceil(l/8),f=e.nByteLength,h=e.adjustScalarBytes||(t=>t),d=e.powPminus2||(t=>(0,r.pow)(t,n-BigInt(2),n));function c(t,e,r){let o=a(t*(e-r));return[e=a(e-o),r=a(r+o)]}function p(t){if("bigint"==typeof t&&s<=t&&t<n)return t;throw Error("Expected valid scalar 0 < scalar < CURVE.P")}let x=(e.a-BigInt(2))/BigInt(4);function y(t){return(0,o.numberToBytesLE)(a(t),u)}function g(t,e){let r=function(t){let e=(0,o.ensureBytes)("u coordinate",t,u);return 32===f&&(e[31]&=127),(0,o.bytesToNumberLE)(e)}(e),n=function(t){let e=(0,o.ensureBytes)("scalar",t),r=e.length;if(r!==u&&r!==f)throw Error(`Expected ${u} or ${f} bytes, got ${r}`);return(0,o.bytesToNumberLE)(h(e))}(t),g=function(t,e){let r;let o=p(t),n=p(e),u=i,f=s,h=o,y=i,g=s;for(let t=BigInt(l-1);t>=s;t--){let e=n>>t&i;g^=e,u=(r=c(g,u,h))[0],h=r[1],f=(r=c(g,f,y))[0],y=r[1],g=e;let s=u+f,l=a(s*s),d=u-f,p=a(d*d),b=l-p,w=h+y,E=h-y,m=a(E*s),B=a(w*d),A=m+B,S=m-B;h=a(A*A),y=a(o*a(S*S)),u=a(l*p),f=a(b*(l+a(x*b)))}u=(r=c(g,u,h))[0],h=r[1],f=(r=c(g,f,y))[0],y=r[1];let b=d(f);return a(u*b)}(r,n);if(g===s)throw Error("Invalid private or public key received");return y(g)}let b=y(e.Gu);function w(t){return g(t,b)}return{scalarMult:g,scalarMultBase:w,getSharedSecret:(t,e)=>g(t,e),getPublicKey:t=>w(t),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:b}}}),n("8BaBP")})(),globalThis.define=e;